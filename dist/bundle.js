!function(c){var n={};function l(g){if(n[g])return n[g].exports;var t=n[g]={i:g,l:!1,exports:{}};return c[g].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.m=c,l.c=n,l.d=function(c,n,g){l.o(c,n)||Object.defineProperty(c,n,{enumerable:!0,get:g})},l.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},l.t=function(c,n){if(1&n&&(c=l(c)),8&n)return c;if(4&n&&"object"==typeof c&&c&&c.__esModule)return c;var g=Object.create(null);if(l.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:c}),2&n&&"string"!=typeof c)for(var t in c)l.d(g,t,function(n){return c[n]}.bind(null,t));return g},l.n=function(c){var n=c&&c.__esModule?function(){return c.default}:function(){return c};return l.d(n,"a",n),n},l.o=function(c,n){return Object.prototype.hasOwnProperty.call(c,n)},l.p="",l(l.s=1)}([function(module){eval('module.exports = JSON.parse("{\\"debug\\":true,\\"textures\\":[{\\"img\\":\\"res/3.png\\",\\"frames\\":[{\\"name\\":\\"building1\\",\\"area\\":{\\"width\\":151,\\"height\\":167}}]}],\\"def\\":{\\"0\\":{},\\"1\\":{\\"display\\":{\\"isometric\\":true,\\"frame\\":\\"building1\\"}},\\"2\\":{\\"display\\":{\\"isometric\\":true,\\"frame\\":\\"building2\\"}},\\"3\\":{\\"display\\":{\\"isometric\\":true,\\"frame\\":\\"building3\\"}}},\\"datas\\":[{\\"name\\":\\"tile1\\",\\"tilemap\\":{\\"data\\":[1,1,1,1,0,1,1,1,1],\\"columns\\":3,\\"grid-width\\":64,\\"grid-height\\":64}}]}");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./src/data.json\nvar src_data = __webpack_require__(0);\n\n// CONCATENATED MODULE: ./src/framework/director/resource.js\n/**\r\n * 全局单例资源\r\n */\r\n\r\n\r\n /**\r\n * 获取精灵帧\r\n * TODO \r\n * 可能会改成id形式\r\n * 引入默认资源机制，找不到帧时的默认空帧，可以是一张红叉图片，\r\n */\r\nvar spriteFrameMap = new Map();\r\nfunction GetSpriteFrame(name = "", defaultValue = true){\r\n    let f = spriteFrameMap.get(name);\r\n    if(f){\r\n        return f;\r\n    }\r\n    if(defaultValue){\r\n        return spriteFrameMap.get("defalut");\r\n    }\r\n    return null;\r\n    // return f ? f : \r\n    //     defaultValue ? spriteFrameMap.get("defalut") : null;\r\n}\r\nfunction SetSpriteFrame(name = "", spriteFrame = null, check = true){\r\n    let f = spriteFrameMap.get(name);\r\n    if(f && check){\r\n        console.error("frame: %s exists.", name);\r\n        return;\r\n    }\r\n    spriteFrameMap.set(name, spriteFrame);\r\n}\r\n\r\n/**\r\n * 自定义数据定义\r\n */\r\nvar defMap = new Map();\r\nfunction GetDef(key = 0){\r\n    return defMap.get(key);\r\n}\r\nfunction SetDef(key = 0, data = null){\r\n    defMap.set(key, data);\r\n}\r\n\r\n/**\r\n * 自定义数据\r\n */\r\nvar dataMap = new Map();\r\nfunction GetData(name = ""){\r\n    return dataMap.get(name);\r\n}\r\nfunction SetData(name = "", data = null, check = true){\r\n    let d = dataMap.get(name);\r\n    if(d && check){\r\n        console.error("data: %s exists.", name);\r\n        return;\r\n    }\r\n    dataMap.set(name, data);\r\n}\r\n\r\n\r\n/**\r\n * 摄像机\r\n */\r\nvar defaultCamera = null;\r\nfunction SetDefaultCamera(camera = null){\r\n    defaultCamera = camera;\r\n}\r\nfunction GetDefaultCamera(){\r\n    return defaultCamera;\r\n}\r\n\r\nvar cameras = [];\r\nfunction AddCamera(camera = null){\r\n    cameras.push(camera);\r\n}\r\nfunction GetCameras(){\r\n    return cameras;\r\n}\r\n\r\n\r\n/**\r\n * 外部引擎\r\n */\r\nvar currEngine = null;\r\nfunction SetEngine(engineObj = null){\r\n    currEngine = engineObj;\r\n}\r\nfunction GetEngine(){\r\n    return currEngine;\r\n}\r\n\r\n/**\r\n * 当前场景\r\n */\r\nvar currScene = null;\r\nfunction SetScene(scene = null){\r\n    currScene = scene;\r\n}\r\nfunction GetScene(){\r\n    return currScene;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/engine/base.js\n\r\n/**\r\n * 外部引擎抽象类\r\n * x, y 都是屏幕坐标，注意\r\n */\r\nclass AbstractEngine {\r\n    constructor(fps = 60){\r\n        this.fps = fps;\r\n        this.tick = 1000 / fps;\r\n    }\r\n\r\n    //清除画布\r\n    clear(){}\r\n\r\n    //画帧\r\n    drawFrame(centerPos = null, spriteFrame = null){}\r\n\r\n    //画矩形\r\n    drawRect(centerPos = null, rect = null){}\r\n\r\n    //画线段\r\n    drawLine(centerPos = null, endPos = null){}\r\n\r\n    //画圆\r\n    drawCircle(centerPos = null, radius = 0){}\r\n\r\n    //imgSrc是图像地址\r\n    loadResource(imgSrc = "", onLoadCallback = null){}\r\n\r\n    onKeyCallback(keyDownCallback = null, keyUpCallback = null){}\r\n    onTouchCallback(touchOnCallback = null, touchOverCallback = null){}\r\n    start(onEnterFrameCallback = null){}\r\n}\r\n\r\nfunction EngineClear(engine = null){\r\n    engine.clear();\r\n}\r\n\r\nfunction EngineDrawFrame(engine = null, centerPos = null, spriteFrame = null){\r\n    engine.drawFrame(centerPos, spriteFrame);\r\n}\r\n\r\nfunction EngineDrawRect(engine = null, centerPos = null, rect = null){\r\n    engine.drawRect(centerPos, rect);\r\n}\r\n\r\nfunction EngineDrawLine(engine = null, startPos = null, endPos = null){\r\n    engine.drawLine(startPos, endPos);\r\n}\r\n\r\nfunction EngineDrawCircle(engine = null, centerPos = null, radius = 0){\r\n    engine.drawCircle(centerPos, radius);\r\n}\r\n\r\nfunction base_EngineLoadResource(engine = null, imgSrc = "", onLoadCallback = null){\r\n    engine.loadResource(imgSrc, onLoadCallback);\r\n}\r\n\r\nfunction EngineOnKeyCallback(engine = null, keyDownCallback = null, keyUpCallback = null){\r\n    engine.onKeyCallback(keyDownCallback, keyUpCallback);\r\n}\r\n\r\nfunction EngineOnTouchCallback(engine = null, touchOnCallback = null, touchOverCallback = null){\r\n    engine.onTouchCallback(touchOnCallback, touchOverCallback);\r\n}\r\n\r\nfunction EngineStart(engine = null, onEnterFrameCallback = null){\r\n    engine.start(onEnterFrameCallback);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/structure/geometric.js\n/**\r\n * 基础2D坐标\r\n */\r\nclass Pos {\r\n    constructor(x = 0, y = 0){\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\n\r\nfunction NewPos(x = 0, y = 0){\r\n    return new Pos(x, y);\r\n}\r\n\r\nfunction UpdatePos(pos = null, x = 0, y = 0){\r\n    pos.x = x;\r\n    pos.y = y;\r\n}\r\n\r\n/**\r\n * 计算相对坐标\r\n * 以targetPos为准，计算referPos于targetPos的相对坐标\r\n * 举例：\r\n *      摄像机位于(50, 50)处，referPos\r\n *      单位A位于(120, 30)处，targetPos\r\n *      那么，单位A在摄像机的(120-50, 30-50)处\r\n */\r\nfunction ToLocatePos(targetPos = null, referPos = null){\r\n    return NewPos(\r\n        targetPos.x - referPos.x,\r\n        targetPos.y - referPos.y);\r\n}\r\n\r\n/**\r\n * 基础向量\r\n * distance: 距离系数，注意不是实际距离，只用于比较距离大小\r\n */\r\nclass Vec {\r\n    constructor(x = 0, y = 0){\r\n        this.x = x;\r\n        this.y = y;\r\n        //this.distance = x * x + y * y;\r\n    }\r\n}\r\n\r\nfunction NewVec(x = 0, y = 0){\r\n    return new Vec(x, y);\r\n}\r\n\r\nfunction NewVecWithPos(posStart = null, posEnd = null){\r\n    return new NewVec(posEnd.x - posStart.x, posEnd.y - posStart.y);\r\n}\r\n\r\nfunction UpdateVec(vec = null, x = 0, y = 0){\r\n    vec.x = x;\r\n    vec.y = y;\r\n    //vec.distance = x * x + y * y;\r\n}\r\n\r\n/**\r\n * 距离系数\r\n * 注意，并非实际距离值，因为开根号计算消耗大\r\n * 若只用于对比大小，此系数即可\r\n */\r\nfunction GetVecDistance(vec = null){\r\n    //return vec.distance;\r\n    return vec.x * vec.x + vec.y * vec.y;\r\n}\r\n\r\n\r\n/**\r\n * 2D基础矩形，只有宽高\r\n * width, height : 宽高\r\n */\r\nclass Rectangle {\r\n    constructor(width = 0, height = 0) {\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n}\r\n\r\n/**\r\n * 矩形默认居中于owner\r\n * 此方法一般由collider调用\r\n */\r\nfunction geometric_NewRect(width = 0, height = 0){\r\n    if(width == 0 || height == 0){\r\n        console.error("rect param error. width:%d, height:%d", width, height);\r\n        return null;\r\n    }\r\n    return new Rectangle(width, height);\r\n}\r\n\r\nfunction UpdateRectSize(rect = null, width = 0, height = 0){\r\n    rect.width = width;\r\n    rect.height = height;\r\n}\r\n\r\n\r\nfunction GetRectWidth(rect = null){\r\n    return rect.width;\r\n}\r\nfunction GetRectHeight(rect = null){\r\n    return rect.height;\r\n}\r\nfunction GetRectHalfWidth(rect = null){\r\n    return rect.width * 0.5;\r\n}\r\nfunction GetRectHalfHeight(rect = null){\r\n    return rect.height * 0.5;\r\n}\r\n\r\n//求面积\r\nfunction GetRectArea(rect = null){\r\n    return rect.width * rect.height;\r\n}\r\n\r\n/**\r\n * 圆形\r\n */\r\nclass Circle {\r\n    constructor(radius = 0) {\r\n        this.radius = radius;\r\n    }\r\n}\r\n\r\nfunction NewCircle(radius = 0){\r\n    if(radius == 0){\r\n        console.error("circle param error. radius:%d", radius);\r\n        return null;\r\n    }\r\n    return new Circle(radius);\r\n}\r\n\r\nfunction GetCircleRadius(circle = null){\r\n    return circle.radius;\r\n}\r\n\r\nfunction UpdateCircle(circle = null, radius = 0){\r\n    circle.radius = radius;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/offset/base.js\n\r\n\r\n/**\r\n * TODO\r\n * 先写，再慢慢规范\r\n * 这里不能有posCom，因为这是基础层\r\n * box-collider用到IsRectsCrossWithVec来检测碰撞，需要重新考虑\r\n * 要么就做成lib\r\n */\r\nclass PosOffsetRelation {\r\n    constructor(pos = null, offset = null){\r\n        this.pos = pos;\r\n        this.offset = offset;       //通常是指显示时的偏移量，和worldPos无关\r\n    }\r\n}\r\n\r\nfunction NewPosOffsetRelation(pos = null, offset = null){\r\n    offset = offset ? offset : NewVec();\r\n    return new PosOffsetRelation(pos, offset);\r\n}\r\n\r\nfunction base_GetPos(posOffsetRel = null){\r\n    return posOffsetRel.pos;\r\n}\r\n\r\nfunction GetOffset(posOffsetRel = null){\r\n    return posOffsetRel.offset;\r\n}\r\n\r\nfunction GetRealPos(posOffsetRel = null){\r\n    return NewPos(\r\n        posOffsetRel.pos.x + posOffsetRel.offset.x,\r\n        posOffsetRel.pos.y + posOffsetRel.offset.y);\r\n}\r\n\r\nfunction UpdateOffset(posOffsetRel = null, xOffset = 0, yOffset = 0){\r\n    posOffsetRel.offset.x = xOffset;\r\n    posOffsetRel.offset.y = yOffset;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/structure/math.js\nconst MAX_INT = 2147483647   //  2^31 - 1 = 2147483647\r\nfunction GetMaxInt(){\r\n    return MAX_INT;\r\n}\r\n\r\nfunction Abs(val = 0){\r\n    return val >= 0 ? val : -val;\r\n}\r\n\r\nfunction Max(val1 = 0, val2 = 0){\r\n    return val1 > val2 ? val1 : val2;\r\n}\r\n\r\nfunction Min(val1 = 0, val2 = 0){\r\n    return val1 < val2 ? val1 : val2;\r\n}\r\n\r\n/**\r\n * 之前：x < 0 ? Math.ceil(x) : Math.floor(x)\r\n * 现在：Math.trunc(x)\r\n * @param {*} num \r\n */\r\nfunction GetInt(num = 0){\r\n    return Math.trunc(num);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/offset/rect.js\n\r\n\r\n\r\n\r\n/**\r\n * 矩形与位置的关系元件\r\n */\r\nclass rect_RectPosRelation extends PosOffsetRelation {\r\n    constructor(pos = null, offset = null, rect = null){\r\n        super(pos, offset);\r\n        this.rect = rect;\r\n    }\r\n}\r\n\r\nfunction NewRectPosRelation(pos = null, offset = null, rect = null){\r\n    offset = offset ? offset : NewVec();\r\n    return new rect_RectPosRelation(pos, offset, rect);\r\n}\r\n\r\nfunction GetRect(rectPosTuple = null){\r\n    return rectPosTuple.rect;\r\n}\r\n\r\nfunction GetRectPosCenter(rectPosTuple = null){\r\n    return GetRealPos(rectPosTuple);\r\n}\r\n\r\nfunction GetRectPosStart(rectPosTuple = null){\r\n    let pos = GetRectPosCenter(rectPosTuple);\r\n    return NewPos(\r\n        pos.x - GetRectHalfWidth(rectPosTuple.rect),\r\n        pos.y - GetRectHalfHeight(rectPosTuple.rect)\r\n    );\r\n}\r\n\r\nfunction GetRectPosEnd(rectPosTuple = null){\r\n    let pos = GetRectPosCenter(rectPosTuple);\r\n    return NewPos(\r\n        pos.x + GetRectHalfWidth(rectPosTuple.rect),\r\n        pos.y + GetRectHalfHeight(rectPosTuple.rect)\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * 目前的机制，可以使用矩形中心点之间的距离判断是否相交\r\n */\r\nfunction IsRectsCross(rectPosTuple1 = null, rectPosTuple2 = null){\r\n    let pos1 = GetRectPosCenter(rectPosTuple1);\r\n    let pos2 = GetRectPosCenter(rectPosTuple2);\r\n    let w = Abs(pos1.x - pos2.x);\r\n    if(w > GetRectHalfWidth(rectPosTuple1.rect) + GetRectHalfWidth(rectPosTuple2.rect)){\r\n        return false;\r\n    }\r\n    let h = Abs(pos1.y - pos2.y);\r\n    if(h > GetRectHalfHeight(rectPosTuple1.rect) + GetRectHalfHeight(rectPosTuple2.rect)){\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n/**\r\n * TODO 需重新设计\r\n * @param {*} rectPosTuple1 \r\n * @param {*} rectPosTuple2 \r\n */\r\nfunction IsRectsCrossWithVec(rectPosTuple1 = null, rectPosTuple2 = null) {\r\n    let rp1 = GetRectPosCenter(rectPosTuple1);\r\n    let pos1 = NewPos(\r\n        rp1.x + rectPosTuple1.unitVec.x,\r\n        rp1.y + rectPosTuple1.unitVec.y\r\n    );\r\n    let rp2 = GetRectPosCenter(rectPosTuple2);\r\n    let pos2 = NewPos(\r\n        rp2.x + rectPosTuple2.unitVec.x,\r\n        rp2.y + rectPosTuple2.unitVec.y\r\n    );\r\n    let w = Abs(pos1.x - pos2.x);\r\n    if(w > GetRectHalfWidth(rectPosTuple1.rect) + GetRectHalfWidth(rectPosTuple2.rect)){\r\n        return false;\r\n    }\r\n    let h = Abs(pos1.y - pos2.y);\r\n    if(h > GetRectHalfHeight(rectPosTuple1.rect) + GetRectHalfHeight(rectPosTuple2.rect)){\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n/**\r\n * TODO 有待优化\r\n * 两个矩形是否相交，基础碰撞检测（需要先更新坐标）\r\n * 原理：\r\n *  左x，取两者最大值\r\n *  右x，取两者最小值\r\n *  如果右x大于左x，则x轴相交\r\n * Y同理：\r\n *  上y，取两者最大值\r\n *  下y，取两者最小值\r\n *  如果下y大于上y，则y轴相交\r\n *  目前，即使两边重叠，也不算相交，这样能避免很多问题\r\n */\r\nfunction NewInnerRect(rectPosTuple1 = null, rectPosTuple2 = null){\r\n    if(!IsRectsCross(rectPosTuple1, rectPosTuple2)){\r\n        return null;\r\n    }\r\n\r\n    let start1 = GetRectPosStart(rectPosTuple1);\r\n    let start2 = GetRectPosStart(rectPosTuple2);\r\n    let end1 = GetRectPosEnd(rectPosTuple1);\r\n    let end2 = GetRectPosEnd(rectPosTuple2);\r\n\r\n    let r1x1 = start1.x;\r\n    let r2x1 = start2.x;\r\n    let maxX1 = r1x1 > r2x1 ? r1x1 : r2x1;\r\n\r\n    let r1x2 = end1.x;\r\n    let r2x2 = end2.x;\r\n    let minX2 = r1x2 < r2x2 ? r1x2 : r2x2;\r\n\r\n    let r1y1 = start1.y;\r\n    let r2y1 = start2.y;\r\n    let maxY1 = r1y1 > r2y1 ? r1y1 : r2y1;\r\n\r\n    let r1y2 = end1.y;\r\n    let r2y2 = end2.y;\r\n    let minY2 = r1y2 < r2y2 ? r1y2 : r2y2;\r\n\r\n    let width = minX2 - maxX1;\r\n    let height = minY2 - maxY1;\r\n    let rect = NewRect(0, 0, width, height);\r\n    if(!rect){\r\n        return null;\r\n    }\r\n\r\n    return NewRectPosTuple(0, 0, \r\n        NewPos(\r\n            maxX1 + GetRectHalfWidth(rect),\r\n            maxY1 + GetRectHalfHeight(rect)\r\n        ), NewVec(), rect);\r\n}\r\n\r\n/**\r\n * 修复位置，根据rect的中心位置修复unit.pos\r\n */\r\nfunction FixUnitPos(rectPosTuple = null, rectX = 0, rectY = 0){\r\n    rectPosTuple.unitPos.x = rectX - rectPosTuple.offset.x;\r\n    rectPosTuple.unitPos.y = rectY - rectPosTuple.offset.y;\r\n}\r\n\r\nfunction FixUnitVec(rectPosTuple = null, rectX = 0, rectY = 0) {\r\n    rectPosTuple.unitVec.x = rectX - rectPosTuple.unitPos.x;\r\n    rectPosTuple.unitVec.y = rectY - rectPosTuple.unitPos.y;    \r\n}\r\n\r\n/**\r\n * 根据unit位置更新rect位置（一般场景调用）\r\n */\r\nfunction FixRectPos(rectPosTuple = null, unitPosX = 0, unitPosY = 0){\r\n    rectPosTuple.center.x = unitPosX + rectPosTuple.offset.x;\r\n    rectPosTuple.center.y = unitPosY + rectPosTuple.offset.y;\r\n}\r\n\r\n/**\r\n * inner.rect不准越出outter.rect，修正innrer.pos位置\r\n * inner和outter都是RectPosTuple\r\n */\r\nfunction FixInRect(outter = null, inner = null){\r\n    let centerPos = GetRectPosCenter(inner);\r\n    let innerStartPos = GetRectPosStart(inner);\r\n    let innerEndPos = GetRectPosEnd(inner);\r\n    let outterStartPos = GetRectPosStart(outter);\r\n    let outterEndPos = GetRectPosEnd(outter);\r\n\r\n    let x = centerPos.x;\r\n    if(innerStartPos.x < outterStartPos.x){\r\n        x = outterStartPos.x + GetRectHalfWidth(inner);\r\n    }else if(innerEndPos.x > outterEndPos.x){\r\n        x = outterEndPos.x - GetRectHalfWidth(inner);\r\n    }\r\n\r\n    let y = centerPos.y;\r\n    if(innerStartPos.y < outterStartPos.y){\r\n        y = outterStartPos.y + GetRectHalfHeight(inner);\r\n    }else if(innerEndPos.y > outterEndPos.y){\r\n        y = outterStartPos.y - GetRectHalfHeight(inner);\r\n    }\r\n\r\n    FixUnitPos(inner, x, y);\r\n}\r\n\r\n\r\n/**\r\n * 当前位置是否在矩形中（同样需要先更新rect位置）\r\n * 包含踩线情况\r\n */\r\nfunction IsPosInRect(pos = null, rectPosTuple = null){\r\n    let startPos = GetRectPosCenter(rectPosTuple);\r\n    let endPos = GetRectPosEnd(rectPosTuple);\r\n    return pos.x >= startPos.x && pos.x <= endPos.x\r\n        && pos.y >= startPos.y && pos.y <= endPos.y;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n//----------------- 以下待定\r\n\r\n/**\r\n * 根据线段作矩形\r\n */\r\nfunction NewOutterRect(x1 = 0, y1 = 0, x2 = 0, y2 = 0){\r\n    let width = x2 - x1;\r\n    let height = y2 - y1;\r\n    if(width <= 0 || height <= 0){\r\n        return null;\r\n    }\r\n    let centerX = x1 + (x2 - x1) * 0.5;\r\n    let centerY = y1 + (y2 - y1) * 0.5;\r\n    let rect = NewRectDefault(width, height);\r\n    UpdateRectPos(rect, centerX, centerY);\r\n    return rect;\r\n}\r\n\r\n/**\r\n * 两个矩形间的外接矩形\r\n */\r\nfunction NewOutterRectByRects(rect1 = null, rect2 = null){\r\n    let r1x1 = GetRectX1(rect1);\r\n    let r2x1 = GetRectX1(rect2);\r\n    let x1 = r1x1 < r2x1 ? r1x1 : r2x1;\r\n    let r1x2 = GetRectX2(rect1);\r\n    let r2x2 = GetRectX2(rect2);\r\n    let x2 = r1x2 > r2x2 ? r1x2 : r2x2;\r\n\r\n    let r1y1 = GetRectY1(rect1);\r\n    let r2y1 = GetRectY1(rect2);\r\n    let y1 = r1y1 < r2y1 ? r1y1 : r2y1;\r\n    let r1y2 = GetRectY2(rect1);\r\n    let r2y2 = GetRectY2(rect2);\r\n    let y2 = r1y2 > r2y2 ? r1y2 : r2y2;\r\n\r\n    return NewOutterRect(x1, y1, x2, y2);\r\n}\r\n\r\n\r\n/**\r\n * 矩形排斥，targetRect会被blockRect弹出去\r\n * TODO，以后完善注释\r\n */\r\nfunction FixExcludeRect(blockRect = null, targetRect = null){\r\n    let pos1 = blockRect.pos;\r\n    let pos2 = targetRect.pos;\r\n    //计算关系，上下左右\r\n    let vx = pos1.x - pos2.x;\r\n    let vy = pos1.y - pos2.y;\r\n    let x = vx < 0 ? vx*-1 : vx;\r\n    let y = vy < 0 ? vy*-1 : vy;\r\n    if(x > y){\r\n        //左右\r\n        if(vx > 0){\r\n            //rect2在左\r\n            pos2.x = blockRect.posStart.x - targetRect.width - targetRect.xOffset;\r\n        }else{\r\n            //rect2在右\r\n            pos2.x = blockRect.posEnd.x - targetRect.xOffset;\r\n        }\r\n    }else{\r\n        //上下\r\n        if(vy > 0){\r\n            //rect2在上\r\n            pos2.y = blockRect.posStart.y - targetRect.height - targetRect.yOffset;\r\n        }\r\n        else{\r\n            //rect2在下\r\n            pos2.y = blockRect.posEnd.y - targetRect.yOffset;\r\n        }\r\n    }\r\n    UpdateRect(targetRect);\r\n}\n// CONCATENATED MODULE: ./src/framework/lib/camera/base.js\n\r\n\r\n\r\n/**\r\n * 摄像机抽象类\r\n * 目前，Camera即是RectPosTuple，只是其offset=0而已\r\n * 后续可能会增加新属性，先用个类来做\r\n */\r\nclass BaseCamera {\r\n    constructor(rectPosRel = null, screenOffset = null){\r\n        this.rectPosRel = rectPosRel;\r\n        this.screenOffset = screenOffset;   //屏幕左上角偏移量\r\n    }\r\n}\r\n\r\nfunction NewCamera(x = 0, y = 0, width = 0, height = 0){\r\n    let pos = NewPos(x, y);\r\n    let rp = NewRectPosRelation(pos, null, geometric_NewRect(width, height));\r\n    return new BaseCamera(rp);\r\n}\r\n\r\nfunction GetCameraStartPos(camera = null){\r\n    return GetRectPosStart(camera.rectPosRel);\r\n}\r\n\r\nfunction GetCameraWidth(camera = null){\r\n    return GetRectWidth(\r\n        GetRect(camera.rectPosRel));\r\n}\r\n\r\nfunction GetCameraHeight(camera = null){\r\n    return GetRectHeight(\r\n        GetRect(camera.rectPosRel));\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/camera/utils.js\n\r\n\r\n\r\n/**\r\n * options = {\r\n *      style : 0,\r\n *      datas : [\r\n *          {\r\n *              x : 0, y : 0,  \r\n *              //扩展：offset-x : 0, offset-y : 0, width : 0, height : 0\r\n *          }\r\n *      ]\r\n * }\r\n */\r\nfunction CreateCameraWithData(options = null, width = 0, height = 0){\r\n    //默认值\r\n    options = options ? options : {\r\n        style : 0,\r\n        datas : [{x : 0, y : 0}]\r\n    };\r\n    //TODO\r\n    let c = options.datas[0];\r\n    return NewCamera(c[\'x\'], c[\'y\'], width, height);\r\n}\r\n\r\nfunction ToCameraStartPos(camera = null, pos = null){\r\n    return ToLocatePos(\r\n        pos, GetCameraStartPos(camera));\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/director/render.js\n\r\n\r\n\r\n\r\n/**\r\n * 清除画布\r\n */\r\nfunction Clear(){\r\n    EngineClear(GetEngine());\r\n}\r\n\r\n/**\r\n * TODO 可能会改成spriteFrameId参数\r\n */\r\nfunction DrawFrame(pos = null, spriteFrame = null){\r\n    DrawFrameInCamera(\r\n        GetDefaultCamera(), pos, spriteFrame);\r\n}\r\n\r\nfunction DrawFrameInCamera(camera = null, pos = null, spriteFrame = null){\r\n    let cPos = ToCameraStartPos(camera, pos);\r\n    EngineDrawFrame(GetEngine(),\r\n        cPos.x, cPos.y, spriteFrame);\r\n}\r\n\r\nfunction DrawRect(pos = null, rect = null){\r\n    DrawRectInCamera(\r\n        GetDefaultCamera(), pos, rect);\r\n}\r\n\r\nfunction DrawRectInCamera(camera = null, pos = null, rect = null){\r\n    let cPos = ToCameraStartPos(camera, pos);\r\n    EngineDrawRect(GetEngine(), cPos, rect);\r\n}\r\n\r\nfunction DrawLine(posStart = null, posEnd = null){\r\n    DrawLineInCamera(\r\n        GetDefaultCamera(), posStart, posEnd);\r\n}\r\n\r\nfunction DrawLineInCamera(camera = null, posStart = null, posEnd = null){\r\n    let cPos1 = ToCameraStartPos(camera, posStart);\r\n    let cPos2 = ToCameraStartPos(camera, posEnd);\r\n    EngineDrawLine(GetEngine(), cPos1, cPos2);\r\n}\r\n\r\nfunction DrawCircle(pos = null, radius = 0){\r\n    DrawCircleInCamera(\r\n        GetDefaultCamera(), pos, radius);\r\n}\r\n\r\nfunction DrawCircleInCamera(camera = null, pos = null, radius = 0){\r\n    let cPos = ToCameraStartPos(camera, pos);\r\n    EngineDrawCircle(GetEngine(), cPos, radius);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/container/list.js\n/**\r\n * 抽象列表操作\r\n */\r\nclass AbstractList {\r\n    constructor(){}\r\n    get(id = 0){}          //根据id获得\r\n    firsr(){}\r\n    last(){}\r\n    size(){}                //返回长度\r\n    add(data = null){}      //尾部追加\r\n    push(data = null){}     //头部追加\r\n    insert(data = null, order = 0){}    //插入到指定顺序，相同order间的先后顺序看具体实现逻辑\r\n    pop(){}               //移除头部元素\r\n    pull(){}              //移除尾部元素\r\n    remove(id = 0){}      //根据id移除\r\n    iterator(callback = null){}\r\n    iteratorReverse(callback = null){}\r\n    iteratorCompare(callback = null){}\r\n}\r\n\r\nfunction GetListData(list = null, id = 0, required = false){\r\n    let data = list.get(id);\r\n    if(!data && required){\r\n        console.error("can\'t find keyId: ", id);\r\n    }\r\n    return data;\r\n}\r\n\r\nfunction GetListFirst(list = null){\r\n    return list.first();\r\n}\r\n\r\nfunction GetListLast(list = null){\r\n    return list.last();\r\n}\r\n\r\nfunction GetListSize(list = null){\r\n    return list.size();\r\n}\r\n\r\nfunction checkAdd(list = null, data = null){\r\n    if(!list || !data || !data.id){\r\n        console.error("error param.");\r\n        return false;\r\n    }\r\n    //不能重复添加\r\n    let d = GetListData(list, id);\r\n    if(d){\r\n        console.error("error id:%d is exist", id);\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n/**\r\n * 尾部追加\r\n * @param {*} list \r\n * @param {*} data \r\n */\r\nfunction AddToList(list = null, data = null){\r\n    if(checkAdd(list, data)){\r\n        list.add(data);\r\n    }\r\n}\r\n\r\n/**\r\n * 头部追加\r\n * @param {*} list \r\n * @param {*} data \r\n */\r\nfunction PushToList(list = null, data = null){\r\n    if(checkAdd(list, data)){\r\n        list.push(data);\r\n    }\r\n}\r\n\r\n/**\r\n * 根据顺序号插入\r\n * @param {*} list \r\n * @param {*} data \r\n * @param {*} order \r\n */\r\nfunction InsertToList(list = null, data = null, order = 0){\r\n    if(checkAdd(list, data)){\r\n        list.insert(data, order);\r\n    }\r\n}\r\n\r\n/**\r\n * 头部移除\r\n * @param {*} list \r\n */\r\nfunction PopFromList(list = null){\r\n    list.pop();\r\n}\r\n\r\n/**\r\n * 尾部移除\r\n * @param {*} list \r\n */\r\nfunction PullFromList(list = null){\r\n    list.pull();\r\n}\r\n\r\n/**\r\n * 根据id移除\r\n * @param {*} list \r\n * @param {*} id \r\n */\r\nfunction RemoveFromList(list = null, id = 0){\r\n    list.remove(id);\r\n}\r\n\r\n/**\r\n * 正向遍历\r\n * @param {*} list \r\n * @param {*} callback func(data){ return bool} 若bool=true，则终止遍历\r\n */\r\nfunction ListIterator(list = null, callback = null){\r\n    if(!list || !callback) {\r\n        //log here\r\n        return\r\n    }\r\n    list.iterator(callback);\r\n}\r\n\r\n/**\r\n * 反向遍历\r\n * @param {*} list \r\n * @param {*} callback \r\n */\r\nfunction ListIteratorReverse(list = null, callback = null){\r\n    if(!list || !callback) {\r\n        //log here\r\n        return\r\n    }\r\n    list.iteratorReverse(callback);\r\n}\r\n\r\n/**\r\n * 内部依次对比\r\n * @param {*} list \r\n * @param {*} callback func(data1, data2) return bool 若bool=true，则终止遍历\r\n */\r\nfunction ListIteratorCompare(list = null, callback = null){\r\n    if(!link || !callback) {\r\n        //log here\r\n        return\r\n    }\r\n    list.iteratorCompare(callback);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/list/linklist.js\n\r\n\r\nclass LinkNode {\r\n\tconstructor(data = null, prep = null, next = null, order = 0) {\r\n\t\tthis.data = data;\r\n\t\tthis.prep = prep;\r\n        this.next = next;\r\n        this.order = order;\r\n\t}\r\n}\r\n\r\nclass linklist_LinkList extends AbstractList {\r\n\tconstructor() {\r\n        super();\r\n\t\tthis.head = new LinkNode();\t\t//empty data node\r\n\t\tthis.tail = new LinkNode();\r\n\t\tthis.head.next = this.tail;\r\n\t\tthis.tail.prep = this.head;\r\n\t\tthis._map = new Map();\r\n\t\tthis._size = 0;\r\n        this._delList = [];\r\n        this._curr = this.head;\r\n        this._lock = false;\r\n    }\r\n    \r\n    get(id = 0){\r\n        let node = this._map.get(id);\r\n        return node ? node.data : null;\r\n    }\r\n\r\n    first(){\r\n        let node = this.head.next;\r\n        return node == this.tail ? null : node.data;\r\n    }\r\n\r\n    last(){\r\n        let node = this.tail.prep;\r\n        return node == this.head ? null : node.data;\r\n    }\r\n\r\n    size(){\r\n        return this._size;\r\n    }\r\n\r\n    add(data = null){\r\n        addToLink(this, data, this.tail);\r\n    }\r\n\r\n    push(data = null){\r\n        addToLink(this, data, this.head.next);\r\n    }\r\n\r\n    insert(data = null, order = 0){\r\n        let node = this.head.next;\r\n        while(node != this.tail){\r\n            if(order < node.order){\r\n                break;\r\n            }\r\n            node = node.next;\r\n        }\r\n        addToLink(this, data, node, order);\r\n    }\r\n\r\n    pop(){\r\n        removeWithCheck(this, this.head.next);\r\n    }\r\n\r\n    pull(){\r\n        removeWithCheck(this, this.tail.prep);\r\n    }\r\n\r\n    remove(id = 0){\r\n        removeWithCheck(this, this._map.get(id));\r\n    }\r\n\r\n    iterator(callback = null){\r\n        this._lock = true;\r\n        let node = this.head.next;\r\n        while(node != this.tail){\r\n            if(callback(node.data)){\r\n                break;\r\n            }\r\n            node = node.next;\r\n        }\r\n        this._lock = false;\r\n        while(this._delList.length > 0){\r\n            removeNode(this, this._delList.pop());\r\n        }\r\n    }\r\n\r\n    iteratorReverse(callback = null){\r\n        this._lock = true;\r\n        let node = this.tail.prep;\r\n        while(node != this.head){\r\n            if(callback(node.data)){\r\n                break;\r\n            }\r\n            node = node.prep;\r\n        }\r\n        this._lock = false;\r\n        while(this._delList.length > 0){\r\n            removeNode(this, this._delList.pop());\r\n        }\r\n    }\r\n\r\n    iteratorCompare(callback = null){\r\n        this._lock = true;\r\n        let outNode = this.head.next;\r\n        while(outNode != this.tail){\r\n            let inNode = outNode.next;\r\n            while(inNode != this.tail){\r\n                if(callback(outNode.data, inNode.data)){\r\n                    break;\r\n                }\r\n                inNode = inNode.next;\r\n            }\r\n            outNode = outNode.next;\r\n        }\r\n        this._lock = false;\r\n        while(this._delList.length > 0){\r\n            removeNode(this, this._delList.pop());\r\n        }\r\n    }\r\n}\r\n\r\nfunction addToLink(link = null, data = null, next = null, order = 0){\r\n    //新节点连接\r\n    let prep = next.prep;\r\n    let node = new LinkNode(data, prep, next, order);\r\n    prep.next = node;\r\n    next.prep = node;\r\n\r\n    link._map.set(data.id, node);\r\n    link._size++;\r\n}\r\n\r\nfunction removeWithCheck(link = null, targetNode = null){\r\n    if(!link || !targetNode || link._size <= 0){\r\n        return;\r\n    }\r\n    if(link._lock){\r\n        link._delList.push(targetNode);\r\n        return;\r\n    }\r\n    removeNode(link, targetNode);\r\n}\r\n\r\nfunction removeNode(link = null, node = null){\r\n    link._map.delete(keyId);\r\n    let p = node.prep;\r\n    let n = node.next;\r\n    p.next = n;\r\n    n.prep = p;\r\n    link._size--;\r\n}\r\n\r\nfunction linklist_NewLink(){\r\n    return new linklist_LinkList();\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/component/ecs.js\n\r\n/**\r\n * 每一种新类对应一个ID，便于回收\r\n */\r\nvar clzId = 1;\r\nfunction NextClassId(){\r\n\treturn clzId++;\r\n}\r\n\r\n/**\r\n * 每个实体拥有一个独立ID\r\n */\r\nvar ecs_entityId = 1;\r\nfunction NewEntityId(){\r\n\treturn ecs_entityId++;\r\n}\r\n\r\n/**\r\n * 暂定这个名\r\n */\r\nclass DFClass {\r\n\tconstructor(clzId = 0) {\r\n\t\tthis.clzId = clzId;\r\n\t}\r\n}\r\n\r\n/**\r\n * 拥有id属性的都继承此类，即ECS中的Entity\r\n */\r\nclass GameObject {\r\n\tconstructor() {\r\n\t\tthis.id = NewEntityId();\r\n\t}\r\n}\r\n\r\n/**\r\n*\tThe base Component\r\n*\t每个entity对每种组件只能持有一个\r\n*/\r\nclass ecs_Component {\r\n\tconstructor(entityId = 0) {\r\n\t\tthis.entityId = entityId;\r\n\t\tthis.id = entityId;\t\t\t//给link使用\r\n\t}\r\n}\r\n\r\n/**\r\n*\tThe base System\r\n*/\r\nclass System {\r\n\tconstructor(){\r\n\t\tthis.id = NewEntityId();\r\n\t}\r\n    onStart(){}\r\n    onUpdate(dt = 0){}\r\n    onEnd(){}\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/view/component/layer.js\n\r\n\r\n\r\n/**\r\n * 显示图层\r\n *  order越低，越先渲染，后渲染的会遮住前面渲染的\r\n */\r\nclass layer_Layer {\r\n    constructor(order = 0){\r\n        this.id = order;\r\n        this.order = order;\r\n        this.list = linklist_NewLink();\r\n    }\r\n}\r\n\r\nvar layerList = linklist_NewLink();\r\nfunction addLayer(order = 0){\r\n    let layer = new layer_Layer(order);\r\n    InsertToList(layerList, layer);\r\n    return layer;\r\n}\r\n\r\nfunction GetLayer(order = 0){\r\n    let layer = GetListData(layerList, order);\r\n    if(!layer){\r\n        layer = addLayer(order);\r\n    }\r\n    return layer;\r\n}\r\n\r\nfunction IteratorLayers(callback = null){\r\n    ListIterator(layerList, layer => {\r\n        ListIterator(layer.list, displayTuple => {\r\n            callback(displayTuple);\r\n        });\r\n    })\r\n}\r\n\r\nfunction AddToLayer(displayTuple = null){\r\n    let layer = GetLayer(displayTuple.layerOrder);\r\n    InsertToList(layer.list, displayTuple, displayTuple.order);\r\n}\r\n\r\nfunction RemoveFromLayer(displayTuple = null){\r\n    let layer = GetLayer(displayTuple.order);\r\n    RemoveFromList(layer.list, displayTuple.id);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/structure/frame.js\n/**\r\n * data就是图片文件\r\n * width, height可选，最好有\r\n */\r\nclass Bitmap {\r\n    constructor(data = null, width = 0, height = 0) {\r\n        this.data = data;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n}\r\n\r\nfunction CreateBitmap(bitmapData = null, width = 0, height = 0){\r\n    return new Bitmap(bitmapData, width, height);\r\n}\r\n\r\n/**\r\n * 用于表示bitmap的一个区域，并非rect\r\n */\r\nclass Seg {\r\n    constructor(x = 0, y = 0, width = 0, height = 0){\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n}\r\n\r\n/**\r\n * 一张图中的一个区域，纹理帧或精灵帧，单例，和引擎有关\r\n * 精灵帧用于标出一张纹理图的指定取材区域，以及相对的显示位置\r\n */\r\nclass SpriteFrame {\r\n    constructor(name = "", seg = null, bitmap = null) {\r\n        this.name = name;\r\n        this.seg = seg;\r\n        this.bitmap = bitmap;\r\n    }\r\n}\r\n\r\nfunction frame_CreateSpriteFrame(name = "", bitmap = null, x = 0, y = 0, width = 0, height = 0){\r\n    let seg = new Seg(x, y, width, height);\r\n    let f = new SpriteFrame(name, seg, bitmap);\r\n    return f;\r\n}\r\n\r\n/**\r\n * spriteFrame开始绘制的坐标，左上角开始，与pos无关\r\n * @param {*} spriteFrame \r\n */\r\nfunction GetSpriteFrameStartX(spriteFrame = null){\r\n    return spriteFrame.seg.x;\r\n}\r\nfunction GetSpriteFrameStartY(spriteFrame = null){\r\n    return spriteFrame.seg.y;\r\n}\r\n\r\nfunction GetSpriteFrameWidth(spriteFrame = null){\r\n    return spriteFrame.seg.width;\r\n}\r\n\r\nfunction GetSpriteFrameHalfWidth(spriteFrame = null){\r\n    return spriteFrame.seg.width * 0.5;\r\n}\r\n\r\nfunction GetSpriteFrameHeight(spriteFrame = null){\r\n    return spriteFrame.seg.height;\r\n}\r\n\r\nfunction GetSpriteFrameHalfHeight(spriteFrame = null){\r\n    return spriteFrame.seg.height * 0.5;\r\n}\r\n\r\nfunction GetSpriteFrameBitmapData(spriteFrame = null){\r\n    return spriteFrame.bitmap.data;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/pos/component.js\n\r\n\r\n\r\n/**\r\n * 位置组件\r\n */\r\nclass component_PosComponent extends Component {\r\n    constructor(entityId = 0, pos = null){\r\n        super(entityId);\r\n        this.pos = pos;\r\n        this.vec = NewVec();\r\n    }\r\n}\r\n\r\nvar posComs = NewLink();\r\nfunction createPosComponent(entityId = 0) {\r\n    let com = new component_PosComponent(entityId, NewPos());\r\n    AddToList(posComs, com);\r\n    return com;\r\n}\r\n\r\nfunction GetPosComponent(entityId = 0) {\r\n    let com = GetListData(posComs, entityId);\r\n    return com ? com : createPosComponent(entityId);\r\n}\r\n\r\nfunction RemovePosComponent(entityId = 0){\r\n    RemoveFromList(posComs, entityId);\r\n}\r\n\r\nfunction GetUnitPos(entityId = 0){\r\n    return GetPosComponent(entityId).pos;\r\n}\r\n\r\nfunction SetUnitPos(entityId = 0, x = 0, y = 0){\r\n    UpdatePos(GetUnitPos(entityId), x, y);\r\n}\r\n\r\nfunction GetUnitVec(entityId = 0){\r\n    return GetPosComponent(entityId).vec;\r\n}\r\n\r\nfunction SetUnitVec(entityId = 0, x = 0, y = 0){\r\n    UpdateVec(GetUnitVec(entityId), x, y);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/view/component/render.js\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 显示组件，包含一些显示参数\r\n */\r\nclass render_RenderComponent extends ecs_Component {\r\n\tconstructor(entityId = 0, isometrics = false, angle = 0, scale = 1) {\r\n        super(entityId);\r\n        this.isometrics = isometrics;\r\n        this.angle = angle;\r\n        this.scale = scale;\r\n\t}\r\n}\r\n\r\nvar renderComs = linklist_NewLink();\r\nfunction createRenderComponent(entityId = 0, options = null) {\r\n    //默认值\r\n    options = options ? options : {};\r\n    let com = new render_RenderComponent(entityId, options.isometrics, options.angle, options.scale);\r\n    AddToList(renderComs, com);\r\n    return com;\r\n}\r\n\r\n/**\r\n * 查找渲染显示组件，暂时这样搞\r\n * options : {\r\n *      isometric : false,\r\n *      angle : 180,\r\n *      scale : 0.5\r\n * }\r\n */\r\nfunction GetRenderComponent(entityId = 0, options = null) {\r\n    let com = GetListData(renderComs, entityId);\r\n    return com ? com : createRenderComponent(entityId, options);\r\n}\r\n\r\n/**\r\n * 显示元件\r\n *  和entity关系不大，一个entity可以拥有大于一个DisplayTuple\r\n *  需要设计机制避免滥用问题\r\n */\r\nclass render_DisplayTuple extends GameObject {\r\n    constructor(spriteFrame = null, renderCom = null, rectPosRel = null, order = 0, layerOrder = 0){\r\n        super();\r\n        this.spriteFrame = spriteFrame;\r\n        this.renderCom = renderCom;\r\n        this.rectPosRel = rectPosRel;\r\n        this.order = order;\r\n        this.layerOrder = layerOrder;\r\n        this.isoPos = NewPos();\r\n    }\r\n}\r\n\r\nfunction NewDisplayer(entityId = 0, spriteFrame = null, offset = null, order = 0, layerOrder = 0){\r\n    let renderCom = GetRenderComponent(entityId);\r\n    let posCom = GetPosComponent(entityId);\r\n    let rp = NewRectPosRelation(posCom.pos, offset, geometric_NewRect(\r\n            GetSpriteFrameWidth(spriteFrame), GetSpriteFrameHeight(spriteFrame)));\r\n    let ds = new render_DisplayTuple(spriteFrame, renderCom, rp, order, layerOrder);\r\n    return ds;\r\n}\r\n\r\nfunction render_IsDisplayISOmetrics(displayer = null){\r\n    return displayer.renderCom.isometrics;\r\n}\r\n\r\nfunction GetDisplaySpriteFrame(displayer = null){\r\n    return displayer.spriteFrame;\r\n}\r\n\r\nfunction GetDisplayCenterPos(displayer = null){\r\n    return GetRealPos(displayer.rectPosRel);\r\n}\r\n\r\nfunction GetDisplayIsoPos(displayer = null){\r\n    return displayer.isoPos;\r\n}\r\n\r\nfunction UpdateIsoPos(displayer = null){\r\n    let pos = base_GetPos(displayTuple.rectPosRel);\r\n    let offset = GetOffset(displayTuple.rectPosRel);\r\n    UpdatePos(displayer.isoPos,\r\n        (pos.x - pos.y) * 0.5 + offset.x,\r\n        (pos.x + pos.y) * 0.5 + offset.y);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/view/system.js\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 渲染系统，逻辑步骤：\r\n * 1.   清除画布\r\n * 2.   重定位摄像机\r\n * 3.   计算单位显示矩形是否在摄像机矩形内\r\n * 4.   转换为画布坐标\r\n * 5.   画出图像\r\n */\r\nclass system_RenderUpdateSystem extends System {\r\n    onUpdate(dt = 0){\r\n        Clear();\r\n        LinkIterator(GetDisplayList(), displayTuple => {\r\n            let pos = GetPos(displayTuple.entityId);\r\n            UpdateRectPosByUnit(displayTuple.displayArea, pos.x, pos.y);\r\n            DrawFrame(displayTuple.spriteFrame, displayTuple.pos);\r\n        });\r\n    }\r\n}\r\n\r\nclass system_LayerRenderUpdateSystem extends System {\r\n    onUpdate(dt = 0){\r\n        Clear();\r\n        IteratorLayers(displayTuple => {\r\n            if(IsDisplayISOmetrics(displayTuple)){\r\n                drawIso(camera, displayTuple);\r\n            }else{\r\n                draw(camera, displayTuple);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction drawIso(displayTuple = null){\r\n    UpdateIsoPos(displayTuple);\r\n    DrawFrame(\r\n        GetDisplayIsoPos(displayTuple),\r\n        GetDisplaySpriteFrame(displayTuple));\r\n}\r\n\r\nfunction draw(displayTuple = null){\r\n    DrawFrame(\r\n        GetDisplayCenterPos(displayTuple),\r\n        GetDisplaySpriteFrame(displayTuple));\r\n}\r\n\r\nvar renderSys = null;\r\nfunction GetRenderUpdateSystem(){\r\n    if(!renderSys){\r\n        renderSys = new system_LayerRenderUpdateSystem();\r\n    }\r\n    return renderSys;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/director/service/system.js\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 主系统列表\r\n */\r\nvar logicSystems = linklist_NewLink();\r\nvar renderSystem = null;\r\nfunction initSystems(debug = false){\r\n    //InsertToLink(logicSystems, GetActionSystem());\r\n    //InsertToLink(logicSystems, GetPosUpdateSystem());\r\n    renderSystem = GetRenderUpdateSystem();\r\n}\r\n\r\nvar logicTick = 16;     //60fps\r\nvar renderTick = 41;    //24fps\r\nvar _t1 = 0;\r\nvar _t2 = 0;\r\nfunction runWithScene(scene = null){\r\n    ListIterator(logicSystems, system => {\r\n        system.onStart();\r\n    });\r\n    renderSystem.onStart();\r\n    scene.onStart();\r\n\r\n    //main loop\r\n    EngineStart(GetEngine(), dt => {\r\n        _t1 += dt;\r\n        if(_t1 >= logicTick){\r\n            _t1 -= logicTick;\r\n            scene.onUpdate(dt);\r\n            ListIterator(logicSystems, system => {\r\n                system.onUpdate(dt);\r\n            });\r\n        }\r\n\r\n        _t2 += dt;\r\n        if(_t2 >= renderTick){\r\n            _t2 -= renderTick;\r\n            renderSystem.onUpdate(dt);\r\n        }\r\n    });\r\n}\r\n\r\nfunction addSystem(system = null){\r\n    if(!system){\r\n        return;\r\n    }\r\n    InsertToLink(logicSystems, system);\r\n}\r\n\r\nfunction stopSystem(){\r\n    ListIterator(logicSystems, system => {\r\n        system.onEnd();\r\n    });\r\n    renderSystem.onEnd();\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/foundation/container/gridmap.js\n\r\n /**\r\n  * gridmap的网格单元\r\n  */\r\n class BaseGrid {\r\n    constructor(width = 0, height = 0, data = null){\r\n        this.width = width;\r\n        this.height = height;\r\n        this.data = data;       //存储的对象\r\n    }\r\n}\r\n\r\n/**\r\n * 网格表是个基础二元容器，应归类为元数据\r\n * rows = 行数\r\n * columns = 列数\r\n * gridWidth, gridHeight = 每个网格的宽高范围，建议1:1\r\n * \r\n */\r\nclass AbstractGridMap {\r\n    getData(pos = null){}\r\n    setData(pos = null, data = null){}\r\n    getGrid(pos = null){}\r\n    getGridMapWidth(){}\r\n    getGridMapHeight(){}\r\n    iterator(callback = null){}\r\n}\r\n\r\nfunction GetGridData(gridmap = null, pos = null){\r\n    return gridmap.getData(pos);\r\n}\r\nfunction SetGridData(gridmap = null, pos = null, data = null){\r\n    return gridmap.setData(pos, data);\r\n}\r\nfunction GetGrid(gridmap = null, pos = null){\r\n    return gridmap.getGrid(pos);\r\n}\r\n\r\n\r\n/**\r\n * 基础属性：宽度\r\n */\r\nfunction GetGridWidth(grid = null){\r\n    return grid.width;\r\n}\r\nfunction GetHalfGridWidth(grid = null){\r\n    return GetGridWidth(grid) * 0.5;\r\n}\r\nfunction GetGridMapWidth(gridmap = null){\r\n    return gridmap.getGridMapWidth();\r\n}\r\nfunction GetHalfGridMapWidth(gridmap = null){\r\n    return GetGridMapWidth(gridmap) * 0.5;\r\n}\r\n\r\n/**\r\n * 基础属性：高度\r\n */\r\nfunction GetGridHeight(grid = null){\r\n    return grid.height;\r\n}\r\nfunction GetHalfGridHeight(grid = null){\r\n    return GetGridHeight(grid) * 0.5;\r\n}\r\nfunction GetGridMapHeight(gridmap = null){\r\n    return gridmap.getGridMapHeight();\r\n}\r\nfunction GetHalfGridMapHeight(gridmap = null){\r\n    return GetGridMapHeight(gridmap) * 0.5;\r\n}\r\n\r\n/**\r\n * 遍历\r\n * @param {*} gridmap \r\n * @param {*} callback \r\n */\r\nfunction GridMapIterator(gridmap = null, callback = null){\r\n    gridmap.iterator(callback);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/grid/tilemap/base.js\n\r\n\r\n\r\n\r\n/**\r\n  * gridmap的网格单元\r\n  */\r\n class base_TileGrid extends BaseGrid {\r\n    constructor(width = 0, height = 0, rowIndex = 0, colIndex = 0, data = null){\r\n        super(width, height, data);\r\n        this.rowIndex = rowIndex;\r\n        this.colIndex = colIndex;\r\n    }\r\n}\r\n\r\n/**\r\n * 2d瓷砖地图，由GridMap扩展\r\n * sample:\r\n * [\r\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \r\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \r\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, \r\n\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,\r\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \r\n\t1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \r\n]\r\n */\r\nclass base_TileMap extends AbstractGridMap {\r\n    constructor(pos = null, rows = 0, columns = 0, gridWidth = 0, gridHeight = 0, grids = null){\r\n        super();\r\n        this.pos = pos;\r\n        this.rows = rows;\r\n        this.columns = columns;\r\n        this.gridWidth = gridWidth;\r\n        this.gridHeight = gridHeight;\r\n        this.grids = grids;\r\n    }\r\n\r\n    getData(pos = null){\r\n        let grid = getGridWithPos(pos, this);\r\n        return grid ? grid.data : null;\r\n    }\r\n    setData(pos = null, data = null){\r\n        let grid = getGridWithPos(pos, this);\r\n        if(grid){\r\n            grid.data = data;\r\n        }\r\n    }\r\n    getGrid(pos = null){\r\n        return getGridWithPos(pos, this);\r\n    }\r\n    getGridMapWidth(){\r\n        return this.columns * this.gridWidth;\r\n    }\r\n    getGridMapHeight(){\r\n        return this.rows * this.gridHeight;\r\n    }\r\n    iterator(callback = null){\r\n        this.grids.forEach(grid => {\r\n            callback(grid);\r\n        });\r\n    }\r\n}\r\n\r\nfunction NewTileMap(rows = 0, columns = 0, gridWidth = 0, gridHeight = 0, pos = null){\r\n    let grids = [];\r\n    for (let rowIndex = 0; rowIndex < rows; rowIndex++) {\r\n        for (let colIndex = 0; colIndex < columns; colIndex++) {\r\n            grids.push(new base_TileGrid(gridWidth, gridHeight, rowIndex, colIndex));\r\n        }\r\n    }\r\n    pos = pos ? pos : NewPos();\r\n    return new base_TileMap(pos, rows, columns, gridWidth, gridHeight, grids);\r\n}\r\n\r\nfunction checkIn(x = 0, y = 0, tilemap = null){\r\n    return x > 0 && x < tilemap.getGridMapWidth() && y > 0 && y < tilemap.getGridMapHeight();\r\n}\r\n\r\nfunction getGridWithPos(pos = null, tilemap = null){\r\n    let tPos = ToLocatePos(pos, tilemap.pos);\r\n    if(!checkIn(tPos.x, tPos.y, tilemap)){\r\n        return null;\r\n    }\r\n    let column = GetInt(tPos.x / gridmap.gridWidth);\r\n    let row = GetInt(tPos.y / gridmap.gridHeight);\r\n    return gridmap.grids[row * gridmap.columns + column];\r\n}\r\n\r\n\r\n/**\r\n * 基础坐标\r\n * @param {*} tilemap \r\n */\r\nfunction GetTilemapStart(tilemap = null){\r\n    return NewPos(\r\n        tilemap.pos.x - GetHalfGridMapWidth(tilemap),\r\n        tilemap.pos.y - GetHalfGridMapHeight(tilemap)\r\n    );\r\n}\r\nfunction GetTilemapEnd(tilemap = null){\r\n    return NewPos(\r\n        tilemap.pos.x + GetHalfGridMapWidth(tilemap),\r\n        tilemap.pos.y + GetHalfGridMapHeight(tilemap)\r\n    );\r\n}\r\nfunction GetTilemapCenter(tilemap = null){\r\n    return NewPos(tilemap.pos.x, tilemap.pos.y);\r\n}\r\n\r\nfunction GetTileGridStart(tilemap = null, grid = null){\r\n    let start = GetTilemapStart(tilemap);\r\n    return NewPos(\r\n        start.x + GetGridWidth(tilemap.gridmap) * grid.colIndex,\r\n        start.y + GetGridHeight(tilemap.gridmap) * grid.rowIndex\r\n    );\r\n}\r\nfunction GetTileGridEnd(tilemap = null, grid = null){\r\n    let start = GetTilemapStart(tilemap);\r\n    return NewPos(\r\n        start.x + tilemap.gridWidth * (grid.colIndex + 1),\r\n        start.y + tilemap.gridHeight * (grid.rowIndex + 1)\r\n    );\r\n}\r\nfunction GetTileGridCenter(tilemap = null, grid = null){\r\n    let start = GetTilemapStart(tilemap);\r\n    return NewPos(\r\n        start.x + tilemap.gridWidth * (grid.colIndex + 0.5),\r\n        start.y + tilemap.gridHeight * (grid.rowIndex + 0.5)\r\n    );\r\n}\r\n\r\n\r\n\r\n/**\r\n * 找出与rect相交的所有grid\r\n * TODO 未定，可能不需要这种做法\r\n */\r\nfunction GetGridsByRect(tileMap = null, rect = null){\r\n    //是否在tilemap中\r\n    if(!IsRectCross(tileMap.rect, rect)){\r\n        return null;\r\n    }\r\n    let grids = [];\r\n    let posStart = rect.posStart;\r\n    let columnStart = parseInt(posStart.x / tileMap.gridWidth);\r\n    let rowStart = parseInt(posStart.y / tileMap.gridHeight);\r\n    columnStart = columnStart < 0 ? 0 : columnStart;\r\n    rowStart = rowStart < 0 ? 0 : rowStart;\r\n\r\n    let posEnd = rect.posEnd;\r\n    let columnEnd = parseInt(posEnd.x / tileMap.gridWidth);\r\n    let rowEnd = parseInt(posEnd.y / tileMap.gridHeight);\r\n    columnEnd = columnEnd > tileMap.columns - 1 ? tileMap.columns - 1 : columnEnd;\r\n    rowEnd = rowEnd > tileMap.rows - 1 ? tileMap.rows - 1 : rowEnd;\r\n\r\n    for(let row=rowStart; row<=rowEnd; row++){\r\n        for(let column=columnStart; column<=columnEnd; column++){\r\n            grids.push(tileMap.grids[row][column]);\r\n        }\r\n    }\r\n    return grids;\r\n}\n// CONCATENATED MODULE: ./src/framework/lib/grid/utils.js\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * tilemap = gridmap + pos\r\n * gridmap的相对坐标是(0, 0)，即左上角\r\n * tilemap.pos和其他对象一样，从中间开始\r\n * gridPos是grid矩形中间\r\n * 例如：tilemap.pos.x = 20, gridWidth = 50, column = 5;\r\n * 那么grid[0]的pos.x= 20 + 0*50 + 50/2 = 45, posStart.x = 45 - 50/2 = 20\r\n * 同理grid[4]的pos.x= 20 + 4*50 + 50/2 = 245, posStart.x = 245 - 50/2 = 220\r\n * \r\n * options:{\r\n *      data : [                一维数组\r\n *          1, 1, 1, 0, 0, 1,\r\n *          2, 1, 0, 0, 1, 2,\r\n *          2, 2, 1, 1, 1, 1\r\n *          ]\r\n *      columns : 6     列数\r\n *      grid-width : 32\r\n *      gridiheight : 32     每个格子的宽高\r\n *      x : 0\r\n *      y : 0           初始位置，默认为stage中心，即(0, 0)\r\n *      onCreate : func\r\n * }\r\n */\r\nfunction CreateTileMapWithData(options = null, onCreate = null){\r\n    //默认值\r\n    defaultTileMapData(options);\r\n    \r\n    //验证tilemap数据完整性\r\n    let columns = options.columns;\r\n    let rows = GetInt(options.data.length / columns);\r\n    if(rows * columns != options.data.length){\r\n        console.error("error param: len(grids): %d, columns: %d", options.data.length, columns);\r\n        return null;\r\n    }\r\n    let tilemap = NewTileMap(\r\n        rows, columns, options.gridWidth, options.gridHeight, NewPos(options.x, options.y));\r\n    if(onCreate){\r\n        GridMapIterator(tilemap, grid => {\r\n            let data = GetDef(options.data[grid.rowIndex * columns + grid.colIndex])\r\n            onCreate(data, tilemap, grid);\r\n        });\r\n    }\r\n    return tilemap;\r\n}\r\n\r\nfunction defaultTileMapData(options = null){\r\n    options = Object.assign({\r\n        columns : 1,\r\n        gridWidth : 32,\r\n        gridHeight : 32,\r\n        x : 0,\r\n        y : 0,\r\n        data : [0]\r\n    }, options);\r\n    options.gridWidth = options.gridWidth > 0 ? options.gridWidth : 32;\r\n    options.gridHeight = options.gridHeight > 0 ? options.gridHeight : 32;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/engine/web/processor.js\n\r\nvar _callback;\r\nvar _frameNo = 0;\r\nvar _dt = 0;\r\nvar _last = 0;\r\nvar _isEnd = false;\r\nfunction runTick(timestamp) {\r\n    _dt = timestamp - _last;\r\n    _last = timestamp;\r\n    _callback(_dt);\r\n    if(!_isEnd){\r\n        _frameNo = window.requestAnimationFrame(tick);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * debug\r\n */\r\nvar processor_start = null;\r\nvar last = new Date().getTime();\r\nfunction runTick2(fps = 0, onUpdateCallback = null) {\r\n    _isEnd = false;\r\n    onUpdateCallback;\r\n    let tick = 1000 / fps;\r\n    setInterval(() => {\r\n        processor_start = new Date().getTime();\r\n        if(!_isEnd){\r\n            onUpdateCallback(processor_start - last);\r\n        }\r\n        last = new Date().getTime();\r\n    }, tick);\r\n}\r\n\r\nfunction stop(){\r\n    _isEnd = true;\r\n}\r\n\r\n\r\n//因为按住键的话，会不断触发onKeydown，所以做个map判断\r\nvar _keyDownMap = new Map();\r\nfunction canvasOnKeyCallback(keyDownCallback = null, keyUpCallback = null){\r\n    window.addEventListener("keydown", e => {\r\n        let code = e.keyCode;\r\n        if(_keyDownMap.get(code)){\r\n            return;\r\n        }\r\n        _keyDownMap.set(code, 1);\r\n        keyDownCallback(e.keyCode);\r\n    });\r\n    window.addEventListener("keyup", e => {\r\n        let code = e.keyCode;\r\n        _keyDownMap.delete(code);\r\n        keyUpCallback(e.keyCode);\r\n    });\r\n}\r\n\r\n/**\r\n * https://blog.csdn.net/qq_17616169/article/details/72833044\r\n */\r\nfunction canvasOnMouseCallback(engine = null, mousedownCallback = null, mouseupCallback = null){\r\n    engine.canvas.addEventListener("mousedown", event => {\r\n        let rect = canvas.getBoundingClientRect();\r\n        let x = event.clientX - rect.left * (canvas.width / rect.width);\r\n        let y = event.clientY - rect.top * (canvas.height / rect.height);\r\n        mousedownCallback(x, y);\r\n    });\r\n    engine.canvas.addEventListener("mouseup", event => {\r\n        let rect = canvas.getBoundingClientRect();\r\n        let x = event.clientX - rect.left * (canvas.width / rect.width);\r\n        let y = event.clientY - rect.top * (canvas.height / rect.height);\r\n        mouseupCallback(x, y);\r\n    });\r\n    // engine.canvas.addEventListener("click", event => {\r\n    //     console.log(event.x, event.y);\r\n    // });\r\n    //engine.canvas.addEventListener("mousemove",doMouseMove,false);\r\n    //engine.canvas.addEventListener("mouseout",doMouseOut,false);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/engine/web/model.js\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 浏览器的key-code\r\n */\r\nconst KEY_RIGHT = 39;\r\nconst KEY_LEFT = 37;\r\nconst KEY_UP = 38;\r\nconst KEY_DOWN = 40;\r\n\r\nconst KEY_SPACE = 32;\r\n\r\nconst KEY_W = 87;\r\nconst KEY_A = 65;\r\nconst KEY_S = 83;\r\nconst KEY_D = 68;\r\n\r\nclass model_H5Engine extends AbstractEngine {\r\n    constructor(fps = 60, canvas = null, ctx = null){\r\n        super(fps);\r\n        this.canvas = canvas;\r\n        this.ctx = ctx;\r\n    }\r\n\r\n    clear(){\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    drawFrame(centerPos = null, spriteFrame = null){\r\n        //参考：context.drawImage(img,sx,sy,swidth,sheight,x,y,width,height);\r\n        this.ctx.drawImage(\r\n            GetSpriteFrameBitmapData(spriteFrame),\r\n            GetSpriteFrameStartX(spriteFrame), GetSpriteFrameStartY(spriteFrame), GetSpriteFrameWidth(spriteFrame), GetSpriteFrameHeight(spriteFrame),\r\n            centerPos.x - GetSpriteFrameHalfWidth(spriteFrame), centerPos.y - GetSpriteFrameHalfHeight(spriteFrame), GetSpriteFrameWidth(spriteFrame), GetSpriteFrameHeight(spriteFrame));\r\n    }\r\n\r\n    drawRect(centerPos = null, rect = null){\r\n        this.ctx.strokeRect(\r\n            centerPos.x - GetRectHalfWidth(rect), centerPos.y - GetRectHalfHeight(rect),\r\n            GetRectWidth(rect), GetRectHeight(rect));\r\n    }\r\n\r\n    drawLine(startPos = null, endPos = null){\r\n        let ctx = this.ctx;\r\n        ctx.beginPath();\r\n        ctx.moveTo(startPos.x, startPos.y);\r\n        ctx.lineTo(endPos.x, endPos.y);\r\n        ctx.stroke();\r\n    }\r\n\r\n    drawCircle(centerPos = null, radius = 0){\r\n        let ctx = this.ctx;\r\n        ctx.beginPath();\r\n        ctx.arc(centerPos.x, centerPos.y, radius, 0, 2 * Math.PI);\r\n        ctx.stroke();\r\n    }\r\n\r\n    loadResource(imgSrc = "", onLoadCallback = null){\r\n        let img = new Image();\r\n        img.src = imgSrc;\r\n        img.onload = function () {\r\n            onLoadCallback(img);\r\n        }\r\n    }\r\n\r\n    onKeyCallback(keyDownCallback = null, keyUpCallback = null){\r\n        canvasOnKeyCallback(keyDownCallback, keyUpCallback);\r\n    }\r\n\r\n    onTouchCallback(touchOnCallback = null, touchOverCallback = null){\r\n        canvasOnMouseCallback(this, touchOnCallback, touchOverCallback);\r\n    }\r\n\r\n    start(onEnterFrameCallback = null){\r\n        runTick2(this.fps, onEnterFrameCallback);\r\n    }\r\n}\r\n\r\n\r\nfunction NewH5Engine(width = 0, height = 0, fps = 0){\r\n    let canvas = document.getElementById("canvas");\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    let ctx = canvas.getContext("2d");\r\n    ctx.strokeStyle="#0000ff";          //画矩形框用的\r\n    return new model_H5Engine(fps, canvas, ctx);\r\n}\r\n\r\n\r\n\r\n\r\nconst Radius = Math.PI/180;\r\nfunction DrawImageWithAngle(angle = 0, imgData, sx = 0, sy = 0, swidth = 0, sheight = 0, x = 0, y = 0, width = 0, height = 0) {\r\n    let ctx = _engine.ctx;\r\n    ctx.save();\r\n    ctx.translate(x + width/2, y + height/2);\r\n    ctx.rotate(angle * Radius);\r\n    DrawImage(imgData, sx, sy, swidth, sheight, -width/2, -height/2, width, height);\r\n    ctx.restore();\r\n\r\n    // ctx.translate(100, 100);\r\n\t// ctx.rotate(90 * Math.PI/180);\t//以上面的偏移点为准，进行旋转\r\n\t// ctx.drawImage(i, 187, 0, 186, 130, -0, -0, 100, 100);\r\n}\n// CONCATENATED MODULE: ./src/framework/lib/engine/utils.js\n\r\n\r\nconst EngineWeb = 0;\r\n\r\n/**\r\n * @param {*} options\r\n * {\r\n *      type : 0,\r\n *      width : 400,\r\n *      height : 400,\r\n *      fps : 60,\r\n *      keyDownHandler : func,\r\n *      keyUpHanler : func,\r\n *      mousedownHandler : func,\r\n *      mouseupHandler : func\r\n * }\r\n */\r\nfunction CreateEngineWithData(options = null, width = 0, height = 0, keyDownHandler = null, keyUpHanler = null, touchOnCallback = null, touchOverCallback = null){\r\n    //默认值\r\n    options = options ? options : {};\r\n    // let width = options[\'width\'];\r\n    // width = width ? width : 400;\r\n    // let height = options[\'height\'];\r\n    // height = height ? height : 400;\r\n    let fps = options[\'fps\'];\r\n    fps = fps ? fps : 60;\r\n    let type = options[\'type\'];\r\n    type = type ? type : EngineWeb;\r\n\r\n    let engine = null;\r\n    switch(type){\r\n        case EngineWeb:\r\n            engine = NewH5Engine(width, height, fps);\r\n            break;\r\n        default:\r\n            //error log\r\n            return null;\r\n    }\r\n\r\n    //注册按键回调\r\n    if(keyDownHandler && keyUpHanler){\r\n        engine.onKeyCallback(keyDownHandler, keyUpHanler);\r\n    }\r\n    if(touchOnCallback && touchOverCallback){\r\n        engine.onTouchCallback(touchOnCallback, touchOverCallback);\r\n    }\r\n    return engine;\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/director/service/init.js\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 通过参数配置初始化系统资源\r\n * options {\r\n *      debug : false,\r\n *      fps : 60,\r\n *      textures : []格式见LoadResource()内\r\n *      screen-width : 800,\r\n *      screen-height : 800,\r\n *      camera : {},\r\n *      engine : {},\r\n *      layers : [\r\n *          {\r\n *              type : 1 格式参考tilemap一节\r\n *          }\r\n *      ]\r\n *      collide : {}\r\n * }\r\n */\r\nfunction initGame(options = null) {\r\n    //默认值\r\n    let screenWidth = options[\'screen-width\'];\r\n    screenWidth = screenWidth && screenWidth > 0 ? screenWidth : 800;\r\n    let screenHeight = options[\'screen-height\'];\r\n    screenHeight = screenHeight && screenHeight > 0 ? screenHeight : 800;\r\n\r\n    //摄像机\r\n    SetDefaultCamera(\r\n        CreateCameraWithData(options[\'camera\'], screenWidth, screenHeight));\r\n\r\n    //引擎\r\n    SetEngine(\r\n        CreateEngineWithData(options[\'engine\'], screenWidth, screenHeight, options.keyDownHandler, options.keyUpHanler, options.touchOnCallback, options.touchOverCallback));\r\n    \r\n    //系统\r\n    initSystems(options[\'debug\']);\r\n\r\n    //开启碰撞系统\r\n    if(options.collide){\r\n        OpenCollider(options.collide);\r\n\r\n        // if(options.useTileCombine){\r\n        //     let resultNodes = CreateCombineNodes(tilemap, collide.boxHandler);\r\n        //     resultNodes.forEach(result => {\r\n        //         collide.loadCallback(result.value, result.rect);\r\n        //     });\r\n        // }\r\n    }\r\n\r\n    //自定义数据等\r\n    initDef(options[\'def\']);\r\n    initDatas(options[\'datas\']);\r\n}\r\n\r\nfunction initDef(options = null){\r\n    for(let key in options){\r\n        SetDef(key, options[key]);\r\n    }\r\n}\r\n\r\n/**\r\n * TODO 临时方法，以后优化\r\n * @param {*} options \r\n */\r\nfunction initDatas(datas = null){\r\n    if(!datas || datas.length == 0){\r\n        return;\r\n    }\r\n    datas.forEach(data => {\r\n        initDataObj(data);\r\n    });\r\n}\r\nfunction initDataObj(options = null){\r\n    let dataObj = null;\r\n    if(options[\'tilemap\']){\r\n        dataObj = CreateTileMapWithData(options[\'tilemap\'], options[\'tilemap\'].onCeate);\r\n    }\r\n    let name = options[\'name\'];\r\n    if(name){\r\n        SetData(name, dataObj);\r\n    }\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/director/boot.js\n\r\n\r\n\r\n\r\n\r\n/**\r\n * options {\r\n *      textures : 格式见LoadResource()内\r\n *      screen : {\r\n *          width : 800,\r\n *          height : 800\r\n *      },\r\n *      fps : 60,\r\n *      debug : false,\r\n *      camera : {\r\n *          x : 0,\r\n *          y : 0\r\n *      },\r\n *      tilemap : 格式参考tilemap一节\r\n *      keyHandler : function(type, keyCode)   type=1 = down, type=2 = up\r\n *      collide : {\r\n *          useBox : false,\r\n *          useGroup : false,\r\n *          pairs : [\r\n *              {\r\n *                  team1 : 1,\r\n *                  team2 : 2\r\n *              }\r\n *          ],\r\n *          handler : function(dt, collider1, collider2)\r\n *      }\r\n * }\r\n * TODO scene可以是一个action?\r\n */\r\nfunction Start(options = null, scene = null){\r\n    options = options ? options : {};\r\n    if(options[\'textures\']){\r\n        loadResource(options[\'textures\'], null, () => {\r\n            initGame(options);\r\n            runWithScene(scene);\r\n        });\r\n    }else{\r\n        initGame(options);\r\n        runWithScene(scene);\r\n    }\r\n}\r\n\r\nfunction Stop(){\r\n    GetScene().onEnd();\r\n    //stopSystems();\r\n    stopSystem();\r\n    StopEngine(getEngine());\r\n}\r\n\r\n\r\n/**\r\n * 加载资源，创建精灵帧\r\n * textures : [\r\n *          {\r\n *              img : "res/a.png",\r\n *              frames : [\r\n *                  {\r\n *                      name : "walk1"\r\n *                      textureArea : {\r\n *                          x : 0,\r\n *                          y : 0,\r\n *                          width : 0,\r\n *                          height : 0\r\n *                      }\r\n *                  }\r\n *              ]\r\n *          }\r\n *      ],\r\n */\r\nfunction loadResource(texturesData = null, OnloadCallback = null, OnCompleteCallback = null){\r\n    //加载图像并创建显示帧\r\n    if(!texturesData || texturesData.length == 0){\r\n        return;\r\n    }\r\n    let _count = 0;\r\n    texturesData.forEach(t =>{\r\n        EngineLoadResource(GetEngine(), t.img, bitmapData => {\r\n            let bitmap = CreateBitmap(bitmapData, bitmapData.width, bitmapData.height);\r\n            t.frames.forEach(frameData => {\r\n                createSpriteFrameWithData(frameData.name, bitmap, frameData.textureArea);\r\n            });\r\n            _count++;\r\n            if(OnloadCallback){\r\n                OnloadCallback(_count);\r\n            }\r\n            if(texturesData.length == _count && OnCompleteCallback){\r\n                OnCompleteCallback();\r\n            }\r\n        })\r\n    });\r\n}\r\n\r\nfunction createSpriteFrameWithData(name = "", bitmap = null, textureAreaData = null){\r\n    if(name == "" || !bitmap || !textureAreaData){\r\n        console.err("error param.");\r\n        return null;\r\n    }\r\n    let x = textureAreaData[\'x\'];\r\n    let y = textureAreaData[\'y\'];\r\n    let width = textureAreaData[\'width\'];\r\n    let height = textureAreaData[\'height\'];\r\n    if(!width || !height){\r\n        return null;\r\n    }\r\n    let f = CreateSpriteFrame(name, bitmap, x, y, width, height);\r\n    SetSpriteFrame(name, f);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/framework/lib/view/utils.js\n\r\n\r\n\r\n\r\n/**\r\n * 加入渲染队列\r\n * layerOrder = 图层顺序，数值从低到高顺序渲染\r\n * order = 自己所在图层内的顺序\r\n * TODO 需要判断重复性，如一个entityId多次用了同样的sprite，相互覆盖，造成浪费\r\n */\r\nfunction AddDisplayer(spriteFrame = null, entityId = 0, layerOrder = 0, order = 0, offset = null) {\r\n    let ds = NewDisplayer(entityId, spriteFrame, offset, order, layerOrder);\r\n    AddToLayer(ds);\r\n    return ds;\r\n}\r\n\r\nfunction RemoveDisplayer(displayer = null) {\r\n    RemoveFromLayer(displayer);\r\n}\r\n\r\n\n// CONCATENATED MODULE: ./src/main.js\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//谨记数据驱动，分清业务配置和框架逻辑配置\r\nvar main_options = Object.assign(src_data, {\r\n    touchOnCallback : main_touchOnCallback,\r\n    touchOverCallback : main_touchOverCallback,\r\n});\r\nmain_options.tilemap.onCreate = function(data = null, tilemap = null, grid = null){\r\n    console.log(data);\r\n    initDisplay(data, tilemap, grid);\r\n}\r\n\r\nfunction main_touchOnCallback(x = 0, y = 0){\r\n    console.log(x, y);\r\n}\r\nfunction main_touchOverCallback(x = 0, y = 0){\r\n\r\n}\r\n\r\nclass MyScene {\r\n    onStart(){\r\n        //draw();\r\n    }\r\n    onUpdate(dt = 0){\r\n        main_draw();\r\n    }\r\n}\r\n\r\nfunction main_draw(){\r\n    drawTile();\r\n    drawCenter();\r\n}\r\n\r\nfunction drawCenter(){\r\n    DrawCircle(NewPos(), 3);\r\n    DrawRect(NewPos(), geometric_NewRect(\r\n        GetCameraWidth(\r\n            GetDefaultCamera()),\r\n        GetCameraHeight(\r\n            GetDefaultCamera())));\r\n}\r\n\r\nfunction drawTile(){\r\n    let tilemap = GetData("tile1");\r\n    GridMapIterator(tilemap, grid => {\r\n        let pos = GetTileGridCenter(tilemap, grid);\r\n        let halfWidth = GetHalfGridWidth(grid);\r\n        let width = GetGridWidth(grid);\r\n        console.log("g[%d, %d]: (%d, %d), %d %d", grid.rowIndex, grid.colIndex, pos.x, pos.y, halfWidth, width);\r\n        //DrawRect(pos, NewRect(width, width));\r\n        testIso(pos, halfWidth);\r\n    });\r\n}\r\n\r\nfunction testIso(pos = null, halfWidth = 0){\r\n    let pos1 = NewPos(pos.x - halfWidth, pos.y - halfWidth);\r\n    let pos1iso = getIso(pos1);\r\n    let pos2 = NewPos(pos.x + halfWidth, pos.y - halfWidth);\r\n    let pos2iso = getIso(pos2);\r\n    let pos3 = NewPos(pos.x - halfWidth, pos.y + halfWidth);\r\n    let pos3iso = getIso(pos3);\r\n    let pos4 = NewPos(pos.x + halfWidth, pos.y + halfWidth);\r\n    let pos4iso = getIso(pos4);\r\n    console.log("p1:(%d, %d), iso:(%d, %d)", pos1.x ,pos1.y, pos1iso.x, pos1iso.y);\r\n    console.log("p2:(%d, %d), iso:(%d, %d)", pos2.x ,pos2.y, pos2iso.x, pos2iso.y);\r\n    console.log("p3:(%d, %d), iso:(%d, %d)", pos3.x ,pos3.y, pos3iso.x, pos3iso.y);\r\n    console.log("p4:(%d, %d), iso:(%d, %d)", pos4.x ,pos4.y, pos4iso.x, pos4iso.y);\r\n    // DrawLine(pos1iso, pos2iso);\r\n    // DrawLine(pos2iso, pos3iso);\r\n    // DrawLine(pos3iso, pos4iso);\r\n    // DrawLine(pos4iso, pos1iso);\r\n    DrawLine(pos1iso, pos2iso);\r\n    DrawLine(pos2iso, pos4iso);\r\n    DrawLine(pos4iso, pos3iso);\r\n    DrawLine(pos3iso, pos1iso);\r\n}\r\n\r\nfunction getIso(pos = null){\r\n    return NewPos(\r\n        (pos.x - pos.y),\r\n        (pos.x + pos.y) * 0.5\r\n    );\r\n}\r\n\r\n/**\r\n * "1" : {\r\n\t\t\t"display" : {\r\n\t\t\t\t"isometric" : true,\r\n\t\t\t\t"frame" : "building1"\r\n\t\t\t}\r\n\t\t},\r\n */\r\nfunction initDisplay(data = null, tilemap = null, grid = null){\r\n    let d = data[\'displayer\'];\r\n    let id = NewEntityId();\r\n    GetRenderComponent(id, {isometrics:true});\r\n    let pos = GetTileGridCenter(tilemap, grid);\r\n    SetUnitPos(id, pos.x, pos.y);\r\n    AddDisplayer(\r\n        GetSpriteFrame(d[\'frame\']), id);\r\n}\r\n\r\n\r\n\r\n(function (){\r\n    console.log(main_options);\r\n    Start(main_options, new MyScene());\r\n})()//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvZGlyZWN0b3IvcmVzb3VyY2UuanM/MzQxZSIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi9lbmdpbmUvYmFzZS5qcz8zOWYzIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZ2VvbWV0cmljLmpzP2E2Y2EiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9mb3VuZGF0aW9uL29mZnNldC9iYXNlLmpzPzYyNWMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9mb3VuZGF0aW9uL3N0cnVjdHVyZS9tYXRoLmpzP2Q5OTAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9mb3VuZGF0aW9uL29mZnNldC9yZWN0LmpzP2Q4Y2UiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9saWIvY2FtZXJhL2Jhc2UuanM/NDcxMiIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi9jYW1lcmEvdXRpbHMuanM/NGZlZiIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2RpcmVjdG9yL3JlbmRlci5qcz9mMDBlIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvZm91bmRhdGlvbi9jb250YWluZXIvbGlzdC5qcz82NDgzIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL2xpc3QvbGlua2xpc3QuanM/OGRiYiIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2ZvdW5kYXRpb24vY29tcG9uZW50L2Vjcy5qcz9mYTBiIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL3ZpZXcvY29tcG9uZW50L2xheWVyLmpzPzBhZTEiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9mb3VuZGF0aW9uL3N0cnVjdHVyZS9mcmFtZS5qcz85NzU0Iiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL3Bvcy9jb21wb25lbnQuanM/Y2M5NyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi92aWV3L2NvbXBvbmVudC9yZW5kZXIuanM/NWM0YSIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi92aWV3L3N5c3RlbS5qcz81ZjA0Iiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvZGlyZWN0b3Ivc2VydmljZS9zeXN0ZW0uanM/N2Q1OCIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2ZvdW5kYXRpb24vY29udGFpbmVyL2dyaWRtYXAuanM/ZmNiMSIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi9ncmlkL3RpbGVtYXAvYmFzZS5qcz9iZTMwIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL2dyaWQvdXRpbHMuanM/NTc4NSIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi9lbmdpbmUvd2ViL3Byb2Nlc3Nvci5qcz84MmE5Iiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL2VuZ2luZS93ZWIvbW9kZWwuanM/NWE3ZiIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi9lbmdpbmUvdXRpbHMuanM/ZTA0ZiIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2RpcmVjdG9yL3NlcnZpY2UvaW5pdC5qcz8yMWQyIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvZGlyZWN0b3IvYm9vdC5qcz85ZWRlIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL3ZpZXcvdXRpbHMuanM/M2VmMiIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi5qcz81NmQ3Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDlhajlsYDljZXkvovotYTmupBcclxuICovXHJcblxyXG5cclxuIC8qKlxyXG4gKiDojrflj5bnsr7ngbXluKdcclxuICogVE9ETyBcclxuICog5Y+v6IO95Lya5pS55oiQaWTlvaLlvI9cclxuICog5byV5YWl6buY6K6k6LWE5rqQ5py65Yi277yM5om+5LiN5Yiw5bin5pe255qE6buY6K6k56m65bin77yM5Y+v5Lul5piv5LiA5byg57qi5Y+J5Zu+54mH77yMXHJcbiAqL1xyXG52YXIgc3ByaXRlRnJhbWVNYXAgPSBuZXcgTWFwKCk7XHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lKG5hbWUgPSBcIlwiLCBkZWZhdWx0VmFsdWUgPSB0cnVlKXtcclxuICAgIGxldCBmID0gc3ByaXRlRnJhbWVNYXAuZ2V0KG5hbWUpO1xyXG4gICAgaWYoZil7XHJcbiAgICAgICAgcmV0dXJuIGY7XHJcbiAgICB9XHJcbiAgICBpZihkZWZhdWx0VmFsdWUpe1xyXG4gICAgICAgIHJldHVybiBzcHJpdGVGcmFtZU1hcC5nZXQoXCJkZWZhbHV0XCIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgICAvLyByZXR1cm4gZiA/IGYgOiBcclxuICAgIC8vICAgICBkZWZhdWx0VmFsdWUgPyBzcHJpdGVGcmFtZU1hcC5nZXQoXCJkZWZhbHV0XCIpIDogbnVsbDtcclxufVxyXG5mdW5jdGlvbiBTZXRTcHJpdGVGcmFtZShuYW1lID0gXCJcIiwgc3ByaXRlRnJhbWUgPSBudWxsLCBjaGVjayA9IHRydWUpe1xyXG4gICAgbGV0IGYgPSBzcHJpdGVGcmFtZU1hcC5nZXQobmFtZSk7XHJcbiAgICBpZihmICYmIGNoZWNrKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiZnJhbWU6ICVzIGV4aXN0cy5cIiwgbmFtZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgc3ByaXRlRnJhbWVNYXAuc2V0KG5hbWUsIHNwcml0ZUZyYW1lKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiHquWumuS5ieaVsOaNruWumuS5iVxyXG4gKi9cclxudmFyIGRlZk1hcCA9IG5ldyBNYXAoKTtcclxuZnVuY3Rpb24gR2V0RGVmKGtleSA9IDApe1xyXG4gICAgcmV0dXJuIGRlZk1hcC5nZXQoa2V5KTtcclxufVxyXG5mdW5jdGlvbiBTZXREZWYoa2V5ID0gMCwgZGF0YSA9IG51bGwpe1xyXG4gICAgZGVmTWFwLnNldChrZXksIGRhdGEpO1xyXG59XHJcblxyXG4vKipcclxuICog6Ieq5a6a5LmJ5pWw5o2uXHJcbiAqL1xyXG52YXIgZGF0YU1hcCA9IG5ldyBNYXAoKTtcclxuZnVuY3Rpb24gR2V0RGF0YShuYW1lID0gXCJcIil7XHJcbiAgICByZXR1cm4gZGF0YU1hcC5nZXQobmFtZSk7XHJcbn1cclxuZnVuY3Rpb24gU2V0RGF0YShuYW1lID0gXCJcIiwgZGF0YSA9IG51bGwsIGNoZWNrID0gdHJ1ZSl7XHJcbiAgICBsZXQgZCA9IGRhdGFNYXAuZ2V0KG5hbWUpO1xyXG4gICAgaWYoZCAmJiBjaGVjayl7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcImRhdGE6ICVzIGV4aXN0cy5cIiwgbmFtZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgZGF0YU1hcC5zZXQobmFtZSwgZGF0YSk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICog5pGE5YOP5py6XHJcbiAqL1xyXG52YXIgZGVmYXVsdENhbWVyYSA9IG51bGw7XHJcbmZ1bmN0aW9uIFNldERlZmF1bHRDYW1lcmEoY2FtZXJhID0gbnVsbCl7XHJcbiAgICBkZWZhdWx0Q2FtZXJhID0gY2FtZXJhO1xyXG59XHJcbmZ1bmN0aW9uIEdldERlZmF1bHRDYW1lcmEoKXtcclxuICAgIHJldHVybiBkZWZhdWx0Q2FtZXJhO1xyXG59XHJcblxyXG52YXIgY2FtZXJhcyA9IFtdO1xyXG5mdW5jdGlvbiBBZGRDYW1lcmEoY2FtZXJhID0gbnVsbCl7XHJcbiAgICBjYW1lcmFzLnB1c2goY2FtZXJhKTtcclxufVxyXG5mdW5jdGlvbiBHZXRDYW1lcmFzKCl7XHJcbiAgICByZXR1cm4gY2FtZXJhcztcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiDlpJbpg6jlvJXmk45cclxuICovXHJcbnZhciBjdXJyRW5naW5lID0gbnVsbDtcclxuZnVuY3Rpb24gU2V0RW5naW5lKGVuZ2luZU9iaiA9IG51bGwpe1xyXG4gICAgY3VyckVuZ2luZSA9IGVuZ2luZU9iajtcclxufVxyXG5mdW5jdGlvbiBHZXRFbmdpbmUoKXtcclxuICAgIHJldHVybiBjdXJyRW5naW5lO1xyXG59XHJcblxyXG4vKipcclxuICog5b2T5YmN5Zy65pmvXHJcbiAqL1xyXG52YXIgY3VyclNjZW5lID0gbnVsbDtcclxuZnVuY3Rpb24gU2V0U2NlbmUoc2NlbmUgPSBudWxsKXtcclxuICAgIGN1cnJTY2VuZSA9IHNjZW5lO1xyXG59XHJcbmZ1bmN0aW9uIEdldFNjZW5lKCl7XHJcbiAgICByZXR1cm4gY3VyclNjZW5lO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgR2V0U3ByaXRlRnJhbWUsIFNldFNwcml0ZUZyYW1lLCBcclxuICAgIEdldERlZiwgU2V0RGVmLCBHZXREYXRhLCBTZXREYXRhLCBcclxuICAgIFNldERlZmF1bHRDYW1lcmEsIEdldERlZmF1bHRDYW1lcmEsIEFkZENhbWVyYSwgR2V0Q2FtZXJhcyxcclxuICAgIFNldEVuZ2luZSwgR2V0RW5naW5lLCBTZXRTY2VuZSwgR2V0U2NlbmVcclxufSIsIlxyXG4vKipcclxuICog5aSW6YOo5byV5pOO5oq96LGh57G7XHJcbiAqIHgsIHkg6YO95piv5bGP5bmV5Z2Q5qCH77yM5rOo5oSPXHJcbiAqL1xyXG5jbGFzcyBBYnN0cmFjdEVuZ2luZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihmcHMgPSA2MCl7XHJcbiAgICAgICAgdGhpcy5mcHMgPSBmcHM7XHJcbiAgICAgICAgdGhpcy50aWNrID0gMTAwMCAvIGZwcztcclxuICAgIH1cclxuXHJcbiAgICAvL+a4hemZpOeUu+W4g1xyXG4gICAgY2xlYXIoKXt9XHJcblxyXG4gICAgLy/nlLvluKdcclxuICAgIGRyYXdGcmFtZShjZW50ZXJQb3MgPSBudWxsLCBzcHJpdGVGcmFtZSA9IG51bGwpe31cclxuXHJcbiAgICAvL+eUu+efqeW9olxyXG4gICAgZHJhd1JlY3QoY2VudGVyUG9zID0gbnVsbCwgcmVjdCA9IG51bGwpe31cclxuXHJcbiAgICAvL+eUu+e6v+autVxyXG4gICAgZHJhd0xpbmUoY2VudGVyUG9zID0gbnVsbCwgZW5kUG9zID0gbnVsbCl7fVxyXG5cclxuICAgIC8v55S75ZyGXHJcbiAgICBkcmF3Q2lyY2xlKGNlbnRlclBvcyA9IG51bGwsIHJhZGl1cyA9IDApe31cclxuXHJcbiAgICAvL2ltZ1NyY+aYr+WbvuWDj+WcsOWdgFxyXG4gICAgbG9hZFJlc291cmNlKGltZ1NyYyA9IFwiXCIsIG9uTG9hZENhbGxiYWNrID0gbnVsbCl7fVxyXG5cclxuICAgIG9uS2V5Q2FsbGJhY2soa2V5RG93bkNhbGxiYWNrID0gbnVsbCwga2V5VXBDYWxsYmFjayA9IG51bGwpe31cclxuICAgIG9uVG91Y2hDYWxsYmFjayh0b3VjaE9uQ2FsbGJhY2sgPSBudWxsLCB0b3VjaE92ZXJDYWxsYmFjayA9IG51bGwpe31cclxuICAgIHN0YXJ0KG9uRW50ZXJGcmFtZUNhbGxiYWNrID0gbnVsbCl7fVxyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVDbGVhcihlbmdpbmUgPSBudWxsKXtcclxuICAgIGVuZ2luZS5jbGVhcigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVEcmF3RnJhbWUoZW5naW5lID0gbnVsbCwgY2VudGVyUG9zID0gbnVsbCwgc3ByaXRlRnJhbWUgPSBudWxsKXtcclxuICAgIGVuZ2luZS5kcmF3RnJhbWUoY2VudGVyUG9zLCBzcHJpdGVGcmFtZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEVuZ2luZURyYXdSZWN0KGVuZ2luZSA9IG51bGwsIGNlbnRlclBvcyA9IG51bGwsIHJlY3QgPSBudWxsKXtcclxuICAgIGVuZ2luZS5kcmF3UmVjdChjZW50ZXJQb3MsIHJlY3QpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVEcmF3TGluZShlbmdpbmUgPSBudWxsLCBzdGFydFBvcyA9IG51bGwsIGVuZFBvcyA9IG51bGwpe1xyXG4gICAgZW5naW5lLmRyYXdMaW5lKHN0YXJ0UG9zLCBlbmRQb3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVEcmF3Q2lyY2xlKGVuZ2luZSA9IG51bGwsIGNlbnRlclBvcyA9IG51bGwsIHJhZGl1cyA9IDApe1xyXG4gICAgZW5naW5lLmRyYXdDaXJjbGUoY2VudGVyUG9zLCByYWRpdXMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVMb2FkUmVzb3VyY2UoZW5naW5lID0gbnVsbCwgaW1nU3JjID0gXCJcIiwgb25Mb2FkQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgIGVuZ2luZS5sb2FkUmVzb3VyY2UoaW1nU3JjLCBvbkxvYWRDYWxsYmFjayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEVuZ2luZU9uS2V5Q2FsbGJhY2soZW5naW5lID0gbnVsbCwga2V5RG93bkNhbGxiYWNrID0gbnVsbCwga2V5VXBDYWxsYmFjayA9IG51bGwpe1xyXG4gICAgZW5naW5lLm9uS2V5Q2FsbGJhY2soa2V5RG93bkNhbGxiYWNrLCBrZXlVcENhbGxiYWNrKTtcclxufVxyXG5cclxuZnVuY3Rpb24gRW5naW5lT25Ub3VjaENhbGxiYWNrKGVuZ2luZSA9IG51bGwsIHRvdWNoT25DYWxsYmFjayA9IG51bGwsIHRvdWNoT3ZlckNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICBlbmdpbmUub25Ub3VjaENhbGxiYWNrKHRvdWNoT25DYWxsYmFjaywgdG91Y2hPdmVyQ2FsbGJhY2spO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVTdGFydChlbmdpbmUgPSBudWxsLCBvbkVudGVyRnJhbWVDYWxsYmFjayA9IG51bGwpe1xyXG4gICAgZW5naW5lLnN0YXJ0KG9uRW50ZXJGcmFtZUNhbGxiYWNrKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIEFic3RyYWN0RW5naW5lLCBFbmdpbmVDbGVhciwgXHJcbiAgICBFbmdpbmVEcmF3RnJhbWUsIEVuZ2luZURyYXdSZWN0LCBFbmdpbmVEcmF3TGluZSwgRW5naW5lRHJhd0NpcmNsZSxcclxuICAgIEVuZ2luZUxvYWRSZXNvdXJjZSwgRW5naW5lT25LZXlDYWxsYmFjaywgRW5naW5lT25Ub3VjaENhbGxiYWNrLCBFbmdpbmVTdGFydFxyXG59IiwiLyoqXHJcbiAqIOWfuuehgDJE5Z2Q5qCHXHJcbiAqL1xyXG5jbGFzcyBQb3Mge1xyXG4gICAgY29uc3RydWN0b3IoeCA9IDAsIHkgPSAwKXtcclxuICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld1Bvcyh4ID0gMCwgeSA9IDApe1xyXG4gICAgcmV0dXJuIG5ldyBQb3MoeCwgeSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFVwZGF0ZVBvcyhwb3MgPSBudWxsLCB4ID0gMCwgeSA9IDApe1xyXG4gICAgcG9zLnggPSB4O1xyXG4gICAgcG9zLnkgPSB5O1xyXG59XHJcblxyXG4vKipcclxuICog6K6h566X55u45a+55Z2Q5qCHXHJcbiAqIOS7pXRhcmdldFBvc+S4uuWHhu+8jOiuoeeul3JlZmVyUG9z5LqOdGFyZ2V0UG9z55qE55u45a+55Z2Q5qCHXHJcbiAqIOS4vuS+i++8mlxyXG4gKiAgICAgIOaRhOWDj+acuuS9jeS6jig1MCwgNTAp5aSE77yMcmVmZXJQb3NcclxuICogICAgICDljZXkvY1B5L2N5LqOKDEyMCwgMzAp5aSE77yMdGFyZ2V0UG9zXHJcbiAqICAgICAg6YKj5LmI77yM5Y2V5L2NQeWcqOaRhOWDj+acuueahCgxMjAtNTAsIDMwLTUwKeWkhFxyXG4gKi9cclxuZnVuY3Rpb24gVG9Mb2NhdGVQb3ModGFyZ2V0UG9zID0gbnVsbCwgcmVmZXJQb3MgPSBudWxsKXtcclxuICAgIHJldHVybiBOZXdQb3MoXHJcbiAgICAgICAgdGFyZ2V0UG9zLnggLSByZWZlclBvcy54LFxyXG4gICAgICAgIHRhcmdldFBvcy55IC0gcmVmZXJQb3MueSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rnoYDlkJHph49cclxuICogZGlzdGFuY2U6IOi3neemu+ezu+aVsO+8jOazqOaEj+S4jeaYr+WunumZhei3neemu++8jOWPqueUqOS6juavlOi+g+i3neemu+Wkp+Wwj1xyXG4gKi9cclxuY2xhc3MgVmVjIHtcclxuICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCl7XHJcbiAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgIC8vdGhpcy5kaXN0YW5jZSA9IHggKiB4ICsgeSAqIHk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld1ZlYyh4ID0gMCwgeSA9IDApe1xyXG4gICAgcmV0dXJuIG5ldyBWZWMoeCwgeSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld1ZlY1dpdGhQb3MocG9zU3RhcnQgPSBudWxsLCBwb3NFbmQgPSBudWxsKXtcclxuICAgIHJldHVybiBuZXcgTmV3VmVjKHBvc0VuZC54IC0gcG9zU3RhcnQueCwgcG9zRW5kLnkgLSBwb3NTdGFydC55KTtcclxufVxyXG5cclxuZnVuY3Rpb24gVXBkYXRlVmVjKHZlYyA9IG51bGwsIHggPSAwLCB5ID0gMCl7XHJcbiAgICB2ZWMueCA9IHg7XHJcbiAgICB2ZWMueSA9IHk7XHJcbiAgICAvL3ZlYy5kaXN0YW5jZSA9IHggKiB4ICsgeSAqIHk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDot53nprvns7vmlbBcclxuICog5rOo5oSP77yM5bm26Z2e5a6e6ZmF6Led56a75YC877yM5Zug5Li65byA5qC55Y+36K6h566X5raI6ICX5aSnXHJcbiAqIOiLpeWPqueUqOS6juWvueavlOWkp+Wwj++8jOatpOezu+aVsOWNs+WPr1xyXG4gKi9cclxuZnVuY3Rpb24gR2V0VmVjRGlzdGFuY2UodmVjID0gbnVsbCl7XHJcbiAgICAvL3JldHVybiB2ZWMuZGlzdGFuY2U7XHJcbiAgICByZXR1cm4gdmVjLnggKiB2ZWMueCArIHZlYy55ICogdmVjLnk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogMkTln7rnoYDnn6nlvaLvvIzlj6rmnInlrr3pq5hcclxuICogd2lkdGgsIGhlaWdodCA6IOWuvemrmFxyXG4gKi9cclxuY2xhc3MgUmVjdGFuZ2xlIHtcclxuICAgIGNvbnN0cnVjdG9yKHdpZHRoID0gMCwgaGVpZ2h0ID0gMCkge1xyXG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOefqeW9oum7mOiupOWxheS4reS6jm93bmVyXHJcbiAqIOatpOaWueazleS4gOiIrOeUsWNvbGxpZGVy6LCD55SoXHJcbiAqL1xyXG5mdW5jdGlvbiBOZXdSZWN0KHdpZHRoID0gMCwgaGVpZ2h0ID0gMCl7XHJcbiAgICBpZih3aWR0aCA9PSAwIHx8IGhlaWdodCA9PSAwKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwicmVjdCBwYXJhbSBlcnJvci4gd2lkdGg6JWQsIGhlaWdodDolZFwiLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUmVjdGFuZ2xlKHdpZHRoLCBoZWlnaHQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBVcGRhdGVSZWN0U2l6ZShyZWN0ID0gbnVsbCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwKXtcclxuICAgIHJlY3Qud2lkdGggPSB3aWR0aDtcclxuICAgIHJlY3QuaGVpZ2h0ID0gaGVpZ2h0O1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gR2V0UmVjdFdpZHRoKHJlY3QgPSBudWxsKXtcclxuICAgIHJldHVybiByZWN0LndpZHRoO1xyXG59XHJcbmZ1bmN0aW9uIEdldFJlY3RIZWlnaHQocmVjdCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHJlY3QuaGVpZ2h0O1xyXG59XHJcbmZ1bmN0aW9uIEdldFJlY3RIYWxmV2lkdGgocmVjdCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHJlY3Qud2lkdGggKiAwLjU7XHJcbn1cclxuZnVuY3Rpb24gR2V0UmVjdEhhbGZIZWlnaHQocmVjdCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHJlY3QuaGVpZ2h0ICogMC41O1xyXG59XHJcblxyXG4vL+axgumdouenr1xyXG5mdW5jdGlvbiBHZXRSZWN0QXJlYShyZWN0ID0gbnVsbCl7XHJcbiAgICByZXR1cm4gcmVjdC53aWR0aCAqIHJlY3QuaGVpZ2h0O1xyXG59XHJcblxyXG4vKipcclxuICog5ZyG5b2iXHJcbiAqL1xyXG5jbGFzcyBDaXJjbGUge1xyXG4gICAgY29uc3RydWN0b3IocmFkaXVzID0gMCkge1xyXG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBOZXdDaXJjbGUocmFkaXVzID0gMCl7XHJcbiAgICBpZihyYWRpdXMgPT0gMCl7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcImNpcmNsZSBwYXJhbSBlcnJvci4gcmFkaXVzOiVkXCIsIHJhZGl1cyk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IENpcmNsZShyYWRpdXMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRDaXJjbGVSYWRpdXMoY2lyY2xlID0gbnVsbCl7XHJcbiAgICByZXR1cm4gY2lyY2xlLnJhZGl1cztcclxufVxyXG5cclxuZnVuY3Rpb24gVXBkYXRlQ2lyY2xlKGNpcmNsZSA9IG51bGwsIHJhZGl1cyA9IDApe1xyXG4gICAgY2lyY2xlLnJhZGl1cyA9IHJhZGl1cztcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIE5ld1BvcywgVXBkYXRlUG9zLCBUb0xvY2F0ZVBvcywgXHJcbiAgICBOZXdWZWMsIE5ld1ZlY1dpdGhQb3MsIFVwZGF0ZVZlYywgR2V0VmVjRGlzdGFuY2UsXHJcbiAgICBOZXdSZWN0LCBVcGRhdGVSZWN0U2l6ZSwgR2V0UmVjdFdpZHRoLCBHZXRSZWN0SGFsZldpZHRoLCBHZXRSZWN0SGVpZ2h0LCBHZXRSZWN0SGFsZkhlaWdodCwgR2V0UmVjdEFyZWEsXHJcbiAgICBOZXdDaXJjbGUsIEdldENpcmNsZVJhZGl1cywgVXBkYXRlQ2lyY2xlXHJcbn0iLCJpbXBvcnQgeyBOZXdQb3MsIE5ld1ZlYyB9IGZyb20gXCIuLi9zdHJ1Y3R1cmUvZ2VvbWV0cmljXCI7XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKiDlhYjlhpnvvIzlho3mhaLmhaLop4TojINcclxuICog6L+Z6YeM5LiN6IO95pyJcG9zQ29t77yM5Zug5Li66L+Z5piv5Z+656GA5bGCXHJcbiAqIGJveC1jb2xsaWRlcueUqOWIsElzUmVjdHNDcm9zc1dpdGhWZWPmnaXmo4DmtYvnorDmkp7vvIzpnIDopoHph43mlrDogIPomZFcclxuICog6KaB5LmI5bCx5YGa5oiQbGliXHJcbiAqL1xyXG5jbGFzcyBQb3NPZmZzZXRSZWxhdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3MgPSBudWxsLCBvZmZzZXQgPSBudWxsKXtcclxuICAgICAgICB0aGlzLnBvcyA9IHBvcztcclxuICAgICAgICB0aGlzLm9mZnNldCA9IG9mZnNldDsgICAgICAgLy/pgJrluLjmmK/mjIfmmL7npLrml7bnmoTlgY/np7vph4/vvIzlkox3b3JsZFBvc+aXoOWFs1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBOZXdQb3NPZmZzZXRSZWxhdGlvbihwb3MgPSBudWxsLCBvZmZzZXQgPSBudWxsKXtcclxuICAgIG9mZnNldCA9IG9mZnNldCA/IG9mZnNldCA6IE5ld1ZlYygpO1xyXG4gICAgcmV0dXJuIG5ldyBQb3NPZmZzZXRSZWxhdGlvbihwb3MsIG9mZnNldCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFBvcyhwb3NPZmZzZXRSZWwgPSBudWxsKXtcclxuICAgIHJldHVybiBwb3NPZmZzZXRSZWwucG9zO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRPZmZzZXQocG9zT2Zmc2V0UmVsID0gbnVsbCl7XHJcbiAgICByZXR1cm4gcG9zT2Zmc2V0UmVsLm9mZnNldDtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0UmVhbFBvcyhwb3NPZmZzZXRSZWwgPSBudWxsKXtcclxuICAgIHJldHVybiBOZXdQb3MoXHJcbiAgICAgICAgcG9zT2Zmc2V0UmVsLnBvcy54ICsgcG9zT2Zmc2V0UmVsLm9mZnNldC54LFxyXG4gICAgICAgIHBvc09mZnNldFJlbC5wb3MueSArIHBvc09mZnNldFJlbC5vZmZzZXQueSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFVwZGF0ZU9mZnNldChwb3NPZmZzZXRSZWwgPSBudWxsLCB4T2Zmc2V0ID0gMCwgeU9mZnNldCA9IDApe1xyXG4gICAgcG9zT2Zmc2V0UmVsLm9mZnNldC54ID0geE9mZnNldDtcclxuICAgIHBvc09mZnNldFJlbC5vZmZzZXQueSA9IHlPZmZzZXQ7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBQb3NPZmZzZXRSZWxhdGlvbiwgTmV3UG9zT2Zmc2V0UmVsYXRpb24sIEdldFBvcywgR2V0T2Zmc2V0LFxyXG4gICAgR2V0UmVhbFBvcywgVXBkYXRlT2Zmc2V0XHJcbn0iLCJjb25zdCBNQVhfSU5UID0gMjE0NzQ4MzY0NyAgIC8vICAyXjMxIC0gMSA9IDIxNDc0ODM2NDdcclxuZnVuY3Rpb24gR2V0TWF4SW50KCl7XHJcbiAgICByZXR1cm4gTUFYX0lOVDtcclxufVxyXG5cclxuZnVuY3Rpb24gQWJzKHZhbCA9IDApe1xyXG4gICAgcmV0dXJuIHZhbCA+PSAwID8gdmFsIDogLXZhbDtcclxufVxyXG5cclxuZnVuY3Rpb24gTWF4KHZhbDEgPSAwLCB2YWwyID0gMCl7XHJcbiAgICByZXR1cm4gdmFsMSA+IHZhbDIgPyB2YWwxIDogdmFsMjtcclxufVxyXG5cclxuZnVuY3Rpb24gTWluKHZhbDEgPSAwLCB2YWwyID0gMCl7XHJcbiAgICByZXR1cm4gdmFsMSA8IHZhbDIgPyB2YWwxIDogdmFsMjtcclxufVxyXG5cclxuLyoqXHJcbiAqIOS5i+WJje+8mnggPCAwID8gTWF0aC5jZWlsKHgpIDogTWF0aC5mbG9vcih4KVxyXG4gKiDnjrDlnKjvvJpNYXRoLnRydW5jKHgpXHJcbiAqIEBwYXJhbSB7Kn0gbnVtIFxyXG4gKi9cclxuZnVuY3Rpb24gR2V0SW50KG51bSA9IDApe1xyXG4gICAgcmV0dXJuIE1hdGgudHJ1bmMobnVtKTtcclxufVxyXG5cclxuZXhwb3J0e1xyXG4gICAgR2V0TWF4SW50LCBBYnMsIE1heCwgTWluLCBHZXRJbnRcclxufSIsImltcG9ydCB7IE5ld1ZlYywgTmV3UG9zLCBHZXRSZWN0SGFsZldpZHRoLCBHZXRSZWN0SGFsZkhlaWdodCB9IGZyb20gXCIuLi9zdHJ1Y3R1cmUvZ2VvbWV0cmljXCI7XHJcbmltcG9ydCB7IEdldFJlYWxQb3MsIFBvc09mZnNldFJlbGF0aW9uIH0gZnJvbSBcIi4vYmFzZVwiO1xyXG5pbXBvcnQgeyBBYnMgfSBmcm9tIFwiLi4vc3RydWN0dXJlL21hdGhcIjtcclxuXHJcbi8qKlxyXG4gKiDnn6nlvaLkuI7kvY3nva7nmoTlhbPns7vlhYPku7ZcclxuICovXHJcbmNsYXNzIFJlY3RQb3NSZWxhdGlvbiBleHRlbmRzIFBvc09mZnNldFJlbGF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcyA9IG51bGwsIG9mZnNldCA9IG51bGwsIHJlY3QgPSBudWxsKXtcclxuICAgICAgICBzdXBlcihwb3MsIG9mZnNldCk7XHJcbiAgICAgICAgdGhpcy5yZWN0ID0gcmVjdDtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gTmV3UmVjdFBvc1JlbGF0aW9uKHBvcyA9IG51bGwsIG9mZnNldCA9IG51bGwsIHJlY3QgPSBudWxsKXtcclxuICAgIG9mZnNldCA9IG9mZnNldCA/IG9mZnNldCA6IE5ld1ZlYygpO1xyXG4gICAgcmV0dXJuIG5ldyBSZWN0UG9zUmVsYXRpb24ocG9zLCBvZmZzZXQsIHJlY3QpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRSZWN0KHJlY3RQb3NUdXBsZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHJlY3RQb3NUdXBsZS5yZWN0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRSZWN0UG9zQ2VudGVyKHJlY3RQb3NUdXBsZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIEdldFJlYWxQb3MocmVjdFBvc1R1cGxlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0UmVjdFBvc1N0YXJ0KHJlY3RQb3NUdXBsZSA9IG51bGwpe1xyXG4gICAgbGV0IHBvcyA9IEdldFJlY3RQb3NDZW50ZXIocmVjdFBvc1R1cGxlKTtcclxuICAgIHJldHVybiBOZXdQb3MoXHJcbiAgICAgICAgcG9zLnggLSBHZXRSZWN0SGFsZldpZHRoKHJlY3RQb3NUdXBsZS5yZWN0KSxcclxuICAgICAgICBwb3MueSAtIEdldFJlY3RIYWxmSGVpZ2h0KHJlY3RQb3NUdXBsZS5yZWN0KVxyXG4gICAgKTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0UmVjdFBvc0VuZChyZWN0UG9zVHVwbGUgPSBudWxsKXtcclxuICAgIGxldCBwb3MgPSBHZXRSZWN0UG9zQ2VudGVyKHJlY3RQb3NUdXBsZSk7XHJcbiAgICByZXR1cm4gTmV3UG9zKFxyXG4gICAgICAgIHBvcy54ICsgR2V0UmVjdEhhbGZXaWR0aChyZWN0UG9zVHVwbGUucmVjdCksXHJcbiAgICAgICAgcG9zLnkgKyBHZXRSZWN0SGFsZkhlaWdodChyZWN0UG9zVHVwbGUucmVjdClcclxuICAgICk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICog55uu5YmN55qE5py65Yi277yM5Y+v5Lul5L2/55So55+p5b2i5Lit5b+D54K55LmL6Ze055qE6Led56a75Yik5pat5piv5ZCm55u45LqkXHJcbiAqL1xyXG5mdW5jdGlvbiBJc1JlY3RzQ3Jvc3MocmVjdFBvc1R1cGxlMSA9IG51bGwsIHJlY3RQb3NUdXBsZTIgPSBudWxsKXtcclxuICAgIGxldCBwb3MxID0gR2V0UmVjdFBvc0NlbnRlcihyZWN0UG9zVHVwbGUxKTtcclxuICAgIGxldCBwb3MyID0gR2V0UmVjdFBvc0NlbnRlcihyZWN0UG9zVHVwbGUyKTtcclxuICAgIGxldCB3ID0gQWJzKHBvczEueCAtIHBvczIueCk7XHJcbiAgICBpZih3ID4gR2V0UmVjdEhhbGZXaWR0aChyZWN0UG9zVHVwbGUxLnJlY3QpICsgR2V0UmVjdEhhbGZXaWR0aChyZWN0UG9zVHVwbGUyLnJlY3QpKXtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBsZXQgaCA9IEFicyhwb3MxLnkgLSBwb3MyLnkpO1xyXG4gICAgaWYoaCA+IEdldFJlY3RIYWxmSGVpZ2h0KHJlY3RQb3NUdXBsZTEucmVjdCkgKyBHZXRSZWN0SGFsZkhlaWdodChyZWN0UG9zVHVwbGUyLnJlY3QpKXtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE8g6ZyA6YeN5paw6K6+6K6hXHJcbiAqIEBwYXJhbSB7Kn0gcmVjdFBvc1R1cGxlMSBcclxuICogQHBhcmFtIHsqfSByZWN0UG9zVHVwbGUyIFxyXG4gKi9cclxuZnVuY3Rpb24gSXNSZWN0c0Nyb3NzV2l0aFZlYyhyZWN0UG9zVHVwbGUxID0gbnVsbCwgcmVjdFBvc1R1cGxlMiA9IG51bGwpIHtcclxuICAgIGxldCBycDEgPSBHZXRSZWN0UG9zQ2VudGVyKHJlY3RQb3NUdXBsZTEpO1xyXG4gICAgbGV0IHBvczEgPSBOZXdQb3MoXHJcbiAgICAgICAgcnAxLnggKyByZWN0UG9zVHVwbGUxLnVuaXRWZWMueCxcclxuICAgICAgICBycDEueSArIHJlY3RQb3NUdXBsZTEudW5pdFZlYy55XHJcbiAgICApO1xyXG4gICAgbGV0IHJwMiA9IEdldFJlY3RQb3NDZW50ZXIocmVjdFBvc1R1cGxlMik7XHJcbiAgICBsZXQgcG9zMiA9IE5ld1BvcyhcclxuICAgICAgICBycDIueCArIHJlY3RQb3NUdXBsZTIudW5pdFZlYy54LFxyXG4gICAgICAgIHJwMi55ICsgcmVjdFBvc1R1cGxlMi51bml0VmVjLnlcclxuICAgICk7XHJcbiAgICBsZXQgdyA9IEFicyhwb3MxLnggLSBwb3MyLngpO1xyXG4gICAgaWYodyA+IEdldFJlY3RIYWxmV2lkdGgocmVjdFBvc1R1cGxlMS5yZWN0KSArIEdldFJlY3RIYWxmV2lkdGgocmVjdFBvc1R1cGxlMi5yZWN0KSl7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgbGV0IGggPSBBYnMocG9zMS55IC0gcG9zMi55KTtcclxuICAgIGlmKGggPiBHZXRSZWN0SGFsZkhlaWdodChyZWN0UG9zVHVwbGUxLnJlY3QpICsgR2V0UmVjdEhhbGZIZWlnaHQocmVjdFBvc1R1cGxlMi5yZWN0KSl7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPIOacieW+heS8mOWMllxyXG4gKiDkuKTkuKrnn6nlvaLmmK/lkKbnm7jkuqTvvIzln7rnoYDnorDmkp7mo4DmtYvvvIjpnIDopoHlhYjmm7TmlrDlnZDmoIfvvIlcclxuICog5Y6f55CG77yaXHJcbiAqICDlt6Z477yM5Y+W5Lik6ICF5pyA5aSn5YC8XHJcbiAqICDlj7N477yM5Y+W5Lik6ICF5pyA5bCP5YC8XHJcbiAqICDlpoLmnpzlj7N45aSn5LqO5bemeO+8jOWImXjovbTnm7jkuqRcclxuICogWeWQjOeQhu+8mlxyXG4gKiAg5LiKee+8jOWPluS4pOiAheacgOWkp+WAvFxyXG4gKiAg5LiLee+8jOWPluS4pOiAheacgOWwj+WAvFxyXG4gKiAg5aaC5p6c5LiLeeWkp+S6juS4innvvIzliJl56L2055u45LqkXHJcbiAqICDnm67liY3vvIzljbPkvb/kuKTovrnph43lj6DvvIzkuZ/kuI3nrpfnm7jkuqTvvIzov5nmoLfog73pgb/lhY3lvojlpJrpl67pophcclxuICovXHJcbmZ1bmN0aW9uIE5ld0lubmVyUmVjdChyZWN0UG9zVHVwbGUxID0gbnVsbCwgcmVjdFBvc1R1cGxlMiA9IG51bGwpe1xyXG4gICAgaWYoIUlzUmVjdHNDcm9zcyhyZWN0UG9zVHVwbGUxLCByZWN0UG9zVHVwbGUyKSl7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHN0YXJ0MSA9IEdldFJlY3RQb3NTdGFydChyZWN0UG9zVHVwbGUxKTtcclxuICAgIGxldCBzdGFydDIgPSBHZXRSZWN0UG9zU3RhcnQocmVjdFBvc1R1cGxlMik7XHJcbiAgICBsZXQgZW5kMSA9IEdldFJlY3RQb3NFbmQocmVjdFBvc1R1cGxlMSk7XHJcbiAgICBsZXQgZW5kMiA9IEdldFJlY3RQb3NFbmQocmVjdFBvc1R1cGxlMik7XHJcblxyXG4gICAgbGV0IHIxeDEgPSBzdGFydDEueDtcclxuICAgIGxldCByMngxID0gc3RhcnQyLng7XHJcbiAgICBsZXQgbWF4WDEgPSByMXgxID4gcjJ4MSA/IHIxeDEgOiByMngxO1xyXG5cclxuICAgIGxldCByMXgyID0gZW5kMS54O1xyXG4gICAgbGV0IHIyeDIgPSBlbmQyLng7XHJcbiAgICBsZXQgbWluWDIgPSByMXgyIDwgcjJ4MiA/IHIxeDIgOiByMngyO1xyXG5cclxuICAgIGxldCByMXkxID0gc3RhcnQxLnk7XHJcbiAgICBsZXQgcjJ5MSA9IHN0YXJ0Mi55O1xyXG4gICAgbGV0IG1heFkxID0gcjF5MSA+IHIyeTEgPyByMXkxIDogcjJ5MTtcclxuXHJcbiAgICBsZXQgcjF5MiA9IGVuZDEueTtcclxuICAgIGxldCByMnkyID0gZW5kMi55O1xyXG4gICAgbGV0IG1pblkyID0gcjF5MiA8IHIyeTIgPyByMXkyIDogcjJ5MjtcclxuXHJcbiAgICBsZXQgd2lkdGggPSBtaW5YMiAtIG1heFgxO1xyXG4gICAgbGV0IGhlaWdodCA9IG1pblkyIC0gbWF4WTE7XHJcbiAgICBsZXQgcmVjdCA9IE5ld1JlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICBpZighcmVjdCl7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5ld1JlY3RQb3NUdXBsZSgwLCAwLCBcclxuICAgICAgICBOZXdQb3MoXHJcbiAgICAgICAgICAgIG1heFgxICsgR2V0UmVjdEhhbGZXaWR0aChyZWN0KSxcclxuICAgICAgICAgICAgbWF4WTEgKyBHZXRSZWN0SGFsZkhlaWdodChyZWN0KVxyXG4gICAgICAgICksIE5ld1ZlYygpLCByZWN0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOS/ruWkjeS9jee9ru+8jOagueaNrnJlY3TnmoTkuK3lv4PkvY3nva7kv67lpI11bml0LnBvc1xyXG4gKi9cclxuZnVuY3Rpb24gRml4VW5pdFBvcyhyZWN0UG9zVHVwbGUgPSBudWxsLCByZWN0WCA9IDAsIHJlY3RZID0gMCl7XHJcbiAgICByZWN0UG9zVHVwbGUudW5pdFBvcy54ID0gcmVjdFggLSByZWN0UG9zVHVwbGUub2Zmc2V0Lng7XHJcbiAgICByZWN0UG9zVHVwbGUudW5pdFBvcy55ID0gcmVjdFkgLSByZWN0UG9zVHVwbGUub2Zmc2V0Lnk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEZpeFVuaXRWZWMocmVjdFBvc1R1cGxlID0gbnVsbCwgcmVjdFggPSAwLCByZWN0WSA9IDApIHtcclxuICAgIHJlY3RQb3NUdXBsZS51bml0VmVjLnggPSByZWN0WCAtIHJlY3RQb3NUdXBsZS51bml0UG9zLng7XHJcbiAgICByZWN0UG9zVHVwbGUudW5pdFZlYy55ID0gcmVjdFkgLSByZWN0UG9zVHVwbGUudW5pdFBvcy55OyAgICBcclxufVxyXG5cclxuLyoqXHJcbiAqIOagueaNrnVuaXTkvY3nva7mm7TmlrByZWN05L2N572u77yI5LiA6Iis5Zy65pmv6LCD55So77yJXHJcbiAqL1xyXG5mdW5jdGlvbiBGaXhSZWN0UG9zKHJlY3RQb3NUdXBsZSA9IG51bGwsIHVuaXRQb3NYID0gMCwgdW5pdFBvc1kgPSAwKXtcclxuICAgIHJlY3RQb3NUdXBsZS5jZW50ZXIueCA9IHVuaXRQb3NYICsgcmVjdFBvc1R1cGxlLm9mZnNldC54O1xyXG4gICAgcmVjdFBvc1R1cGxlLmNlbnRlci55ID0gdW5pdFBvc1kgKyByZWN0UG9zVHVwbGUub2Zmc2V0Lnk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBpbm5lci5yZWN05LiN5YeG6LaK5Ye6b3V0dGVyLnJlY3TvvIzkv67mraNpbm5yZXIucG9z5L2N572uXHJcbiAqIGlubmVy5ZKMb3V0dGVy6YO95pivUmVjdFBvc1R1cGxlXHJcbiAqL1xyXG5mdW5jdGlvbiBGaXhJblJlY3Qob3V0dGVyID0gbnVsbCwgaW5uZXIgPSBudWxsKXtcclxuICAgIGxldCBjZW50ZXJQb3MgPSBHZXRSZWN0UG9zQ2VudGVyKGlubmVyKTtcclxuICAgIGxldCBpbm5lclN0YXJ0UG9zID0gR2V0UmVjdFBvc1N0YXJ0KGlubmVyKTtcclxuICAgIGxldCBpbm5lckVuZFBvcyA9IEdldFJlY3RQb3NFbmQoaW5uZXIpO1xyXG4gICAgbGV0IG91dHRlclN0YXJ0UG9zID0gR2V0UmVjdFBvc1N0YXJ0KG91dHRlcik7XHJcbiAgICBsZXQgb3V0dGVyRW5kUG9zID0gR2V0UmVjdFBvc0VuZChvdXR0ZXIpO1xyXG5cclxuICAgIGxldCB4ID0gY2VudGVyUG9zLng7XHJcbiAgICBpZihpbm5lclN0YXJ0UG9zLnggPCBvdXR0ZXJTdGFydFBvcy54KXtcclxuICAgICAgICB4ID0gb3V0dGVyU3RhcnRQb3MueCArIEdldFJlY3RIYWxmV2lkdGgoaW5uZXIpO1xyXG4gICAgfWVsc2UgaWYoaW5uZXJFbmRQb3MueCA+IG91dHRlckVuZFBvcy54KXtcclxuICAgICAgICB4ID0gb3V0dGVyRW5kUG9zLnggLSBHZXRSZWN0SGFsZldpZHRoKGlubmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgeSA9IGNlbnRlclBvcy55O1xyXG4gICAgaWYoaW5uZXJTdGFydFBvcy55IDwgb3V0dGVyU3RhcnRQb3MueSl7XHJcbiAgICAgICAgeSA9IG91dHRlclN0YXJ0UG9zLnkgKyBHZXRSZWN0SGFsZkhlaWdodChpbm5lcik7XHJcbiAgICB9ZWxzZSBpZihpbm5lckVuZFBvcy55ID4gb3V0dGVyRW5kUG9zLnkpe1xyXG4gICAgICAgIHkgPSBvdXR0ZXJTdGFydFBvcy55IC0gR2V0UmVjdEhhbGZIZWlnaHQoaW5uZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIEZpeFVuaXRQb3MoaW5uZXIsIHgsIHkpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIOW9k+WJjeS9jee9ruaYr+WQpuWcqOefqeW9ouS4re+8iOWQjOagt+mcgOimgeWFiOabtOaWsHJlY3TkvY3nva7vvIlcclxuICog5YyF5ZCr6Lip57q/5oOF5Ya1XHJcbiAqL1xyXG5mdW5jdGlvbiBJc1Bvc0luUmVjdChwb3MgPSBudWxsLCByZWN0UG9zVHVwbGUgPSBudWxsKXtcclxuICAgIGxldCBzdGFydFBvcyA9IEdldFJlY3RQb3NDZW50ZXIocmVjdFBvc1R1cGxlKTtcclxuICAgIGxldCBlbmRQb3MgPSBHZXRSZWN0UG9zRW5kKHJlY3RQb3NUdXBsZSk7XHJcbiAgICByZXR1cm4gcG9zLnggPj0gc3RhcnRQb3MueCAmJiBwb3MueCA8PSBlbmRQb3MueFxyXG4gICAgICAgICYmIHBvcy55ID49IHN0YXJ0UG9zLnkgJiYgcG9zLnkgPD0gZW5kUG9zLnk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBOZXdSZWN0UG9zUmVsYXRpb24sIEdldFJlY3QsIEdldFJlY3RQb3NDZW50ZXIsIEdldFJlY3RQb3NTdGFydCwgR2V0UmVjdFBvc0VuZCxcclxuICAgIElzUmVjdHNDcm9zcywgSXNQb3NJblJlY3RcclxufVxyXG5cclxuXHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tIOS7peS4i+W+heWumlxyXG5cclxuLyoqXHJcbiAqIOagueaNrue6v+auteS9nOefqeW9olxyXG4gKi9cclxuZnVuY3Rpb24gTmV3T3V0dGVyUmVjdCh4MSA9IDAsIHkxID0gMCwgeDIgPSAwLCB5MiA9IDApe1xyXG4gICAgbGV0IHdpZHRoID0geDIgLSB4MTtcclxuICAgIGxldCBoZWlnaHQgPSB5MiAtIHkxO1xyXG4gICAgaWYod2lkdGggPD0gMCB8fCBoZWlnaHQgPD0gMCl7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBsZXQgY2VudGVyWCA9IHgxICsgKHgyIC0geDEpICogMC41O1xyXG4gICAgbGV0IGNlbnRlclkgPSB5MSArICh5MiAtIHkxKSAqIDAuNTtcclxuICAgIGxldCByZWN0ID0gTmV3UmVjdERlZmF1bHQod2lkdGgsIGhlaWdodCk7XHJcbiAgICBVcGRhdGVSZWN0UG9zKHJlY3QsIGNlbnRlclgsIGNlbnRlclkpO1xyXG4gICAgcmV0dXJuIHJlY3Q7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDkuKTkuKrnn6nlvaLpl7TnmoTlpJbmjqXnn6nlvaJcclxuICovXHJcbmZ1bmN0aW9uIE5ld091dHRlclJlY3RCeVJlY3RzKHJlY3QxID0gbnVsbCwgcmVjdDIgPSBudWxsKXtcclxuICAgIGxldCByMXgxID0gR2V0UmVjdFgxKHJlY3QxKTtcclxuICAgIGxldCByMngxID0gR2V0UmVjdFgxKHJlY3QyKTtcclxuICAgIGxldCB4MSA9IHIxeDEgPCByMngxID8gcjF4MSA6IHIyeDE7XHJcbiAgICBsZXQgcjF4MiA9IEdldFJlY3RYMihyZWN0MSk7XHJcbiAgICBsZXQgcjJ4MiA9IEdldFJlY3RYMihyZWN0Mik7XHJcbiAgICBsZXQgeDIgPSByMXgyID4gcjJ4MiA/IHIxeDIgOiByMngyO1xyXG5cclxuICAgIGxldCByMXkxID0gR2V0UmVjdFkxKHJlY3QxKTtcclxuICAgIGxldCByMnkxID0gR2V0UmVjdFkxKHJlY3QyKTtcclxuICAgIGxldCB5MSA9IHIxeTEgPCByMnkxID8gcjF5MSA6IHIyeTE7XHJcbiAgICBsZXQgcjF5MiA9IEdldFJlY3RZMihyZWN0MSk7XHJcbiAgICBsZXQgcjJ5MiA9IEdldFJlY3RZMihyZWN0Mik7XHJcbiAgICBsZXQgeTIgPSByMXkyID4gcjJ5MiA/IHIxeTIgOiByMnkyO1xyXG5cclxuICAgIHJldHVybiBOZXdPdXR0ZXJSZWN0KHgxLCB5MSwgeDIsIHkyKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiDnn6nlvaLmjpLmlqXvvIx0YXJnZXRSZWN05Lya6KKrYmxvY2tSZWN05by55Ye65Y67XHJcbiAqIFRPRE/vvIzku6XlkI7lrozlloTms6jph4pcclxuICovXHJcbmZ1bmN0aW9uIEZpeEV4Y2x1ZGVSZWN0KGJsb2NrUmVjdCA9IG51bGwsIHRhcmdldFJlY3QgPSBudWxsKXtcclxuICAgIGxldCBwb3MxID0gYmxvY2tSZWN0LnBvcztcclxuICAgIGxldCBwb3MyID0gdGFyZ2V0UmVjdC5wb3M7XHJcbiAgICAvL+iuoeeul+WFs+ezu++8jOS4iuS4i+W3puWPs1xyXG4gICAgbGV0IHZ4ID0gcG9zMS54IC0gcG9zMi54O1xyXG4gICAgbGV0IHZ5ID0gcG9zMS55IC0gcG9zMi55O1xyXG4gICAgbGV0IHggPSB2eCA8IDAgPyB2eCotMSA6IHZ4O1xyXG4gICAgbGV0IHkgPSB2eSA8IDAgPyB2eSotMSA6IHZ5O1xyXG4gICAgaWYoeCA+IHkpe1xyXG4gICAgICAgIC8v5bem5Y+zXHJcbiAgICAgICAgaWYodnggPiAwKXtcclxuICAgICAgICAgICAgLy9yZWN0MuWcqOW3plxyXG4gICAgICAgICAgICBwb3MyLnggPSBibG9ja1JlY3QucG9zU3RhcnQueCAtIHRhcmdldFJlY3Qud2lkdGggLSB0YXJnZXRSZWN0LnhPZmZzZXQ7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8vcmVjdDLlnKjlj7NcclxuICAgICAgICAgICAgcG9zMi54ID0gYmxvY2tSZWN0LnBvc0VuZC54IC0gdGFyZ2V0UmVjdC54T2Zmc2V0O1xyXG4gICAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICAgIC8v5LiK5LiLXHJcbiAgICAgICAgaWYodnkgPiAwKXtcclxuICAgICAgICAgICAgLy9yZWN0MuWcqOS4ilxyXG4gICAgICAgICAgICBwb3MyLnkgPSBibG9ja1JlY3QucG9zU3RhcnQueSAtIHRhcmdldFJlY3QuaGVpZ2h0IC0gdGFyZ2V0UmVjdC55T2Zmc2V0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAvL3JlY3Qy5Zyo5LiLXHJcbiAgICAgICAgICAgIHBvczIueSA9IGJsb2NrUmVjdC5wb3NFbmQueSAtIHRhcmdldFJlY3QueU9mZnNldDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBVcGRhdGVSZWN0KHRhcmdldFJlY3QpO1xyXG59IiwiaW1wb3J0IHsgTmV3UmVjdFBvc1JlbGF0aW9uLCBHZXRSZWN0UG9zU3RhcnQsIEdldFJlY3QgfSBmcm9tIFwiLi4vLi4vZm91bmRhdGlvbi9vZmZzZXQvcmVjdFwiO1xyXG5pbXBvcnQgeyBOZXdQb3MsIE5ld1JlY3QsIEdldFJlY3RXaWR0aCwgR2V0UmVjdEhlaWdodCB9IGZyb20gXCIuLi8uLi9mb3VuZGF0aW9uL3N0cnVjdHVyZS9nZW9tZXRyaWNcIjtcclxuXHJcbi8qKlxyXG4gKiDmkYTlg4/mnLrmir3osaHnsbtcclxuICog55uu5YmN77yMQ2FtZXJh5Y2z5pivUmVjdFBvc1R1cGxl77yM5Y+q5piv5YW2b2Zmc2V0PTDogIzlt7JcclxuICog5ZCO57ut5Y+v6IO95Lya5aKe5Yqg5paw5bGe5oCn77yM5YWI55So5Liq57G75p2l5YGaXHJcbiAqL1xyXG5jbGFzcyBCYXNlQ2FtZXJhIHtcclxuICAgIGNvbnN0cnVjdG9yKHJlY3RQb3NSZWwgPSBudWxsLCBzY3JlZW5PZmZzZXQgPSBudWxsKXtcclxuICAgICAgICB0aGlzLnJlY3RQb3NSZWwgPSByZWN0UG9zUmVsO1xyXG4gICAgICAgIHRoaXMuc2NyZWVuT2Zmc2V0ID0gc2NyZWVuT2Zmc2V0OyAgIC8v5bGP5bmV5bem5LiK6KeS5YGP56e76YePXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld0NhbWVyYSh4ID0gMCwgeSA9IDAsIHdpZHRoID0gMCwgaGVpZ2h0ID0gMCl7XHJcbiAgICBsZXQgcG9zID0gTmV3UG9zKHgsIHkpO1xyXG4gICAgbGV0IHJwID0gTmV3UmVjdFBvc1JlbGF0aW9uKHBvcywgbnVsbCwgTmV3UmVjdCh3aWR0aCwgaGVpZ2h0KSk7XHJcbiAgICByZXR1cm4gbmV3IEJhc2VDYW1lcmEocnApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRDYW1lcmFTdGFydFBvcyhjYW1lcmEgPSBudWxsKXtcclxuICAgIHJldHVybiBHZXRSZWN0UG9zU3RhcnQoY2FtZXJhLnJlY3RQb3NSZWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRDYW1lcmFXaWR0aChjYW1lcmEgPSBudWxsKXtcclxuICAgIHJldHVybiBHZXRSZWN0V2lkdGgoXHJcbiAgICAgICAgR2V0UmVjdChjYW1lcmEucmVjdFBvc1JlbCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRDYW1lcmFIZWlnaHQoY2FtZXJhID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0UmVjdEhlaWdodChcclxuICAgICAgICBHZXRSZWN0KGNhbWVyYS5yZWN0UG9zUmVsKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBOZXdDYW1lcmEsIEdldENhbWVyYVN0YXJ0UG9zLFxyXG4gICAgR2V0Q2FtZXJhV2lkdGgsIEdldENhbWVyYUhlaWdodFxyXG59IiwiaW1wb3J0IHsgTmV3Q2FtZXJhLCBHZXRDYW1lcmFTdGFydFBvcyB9IGZyb20gXCIuL2Jhc2VcIjtcclxuaW1wb3J0IHsgVG9Mb2NhdGVQb3MgfSBmcm9tIFwiLi4vLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZ2VvbWV0cmljXCI7XHJcblxyXG4vKipcclxuICogb3B0aW9ucyA9IHtcclxuICogICAgICBzdHlsZSA6IDAsXHJcbiAqICAgICAgZGF0YXMgOiBbXHJcbiAqICAgICAgICAgIHtcclxuICogICAgICAgICAgICAgIHggOiAwLCB5IDogMCwgIFxyXG4gKiAgICAgICAgICAgICAgLy/mianlsZXvvJpvZmZzZXQteCA6IDAsIG9mZnNldC15IDogMCwgd2lkdGggOiAwLCBoZWlnaHQgOiAwXHJcbiAqICAgICAgICAgIH1cclxuICogICAgICBdXHJcbiAqIH1cclxuICovXHJcbmZ1bmN0aW9uIENyZWF0ZUNhbWVyYVdpdGhEYXRhKG9wdGlvbnMgPSBudWxsLCB3aWR0aCA9IDAsIGhlaWdodCA9IDApe1xyXG4gICAgLy/pu5jorqTlgLxcclxuICAgIG9wdGlvbnMgPSBvcHRpb25zID8gb3B0aW9ucyA6IHtcclxuICAgICAgICBzdHlsZSA6IDAsXHJcbiAgICAgICAgZGF0YXMgOiBbe3ggOiAwLCB5IDogMH1dXHJcbiAgICB9O1xyXG4gICAgLy9UT0RPXHJcbiAgICBsZXQgYyA9IG9wdGlvbnMuZGF0YXNbMF07XHJcbiAgICByZXR1cm4gTmV3Q2FtZXJhKGNbJ3gnXSwgY1sneSddLCB3aWR0aCwgaGVpZ2h0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gVG9DYW1lcmFTdGFydFBvcyhjYW1lcmEgPSBudWxsLCBwb3MgPSBudWxsKXtcclxuICAgIHJldHVybiBUb0xvY2F0ZVBvcyhcclxuICAgICAgICBwb3MsIEdldENhbWVyYVN0YXJ0UG9zKGNhbWVyYSkpO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgQ3JlYXRlQ2FtZXJhV2l0aERhdGEsXHJcbiAgICBUb0NhbWVyYVN0YXJ0UG9zXHJcbn0iLCJpbXBvcnQgeyBHZXRFbmdpbmUsIEdldERlZmF1bHRDYW1lcmEgfSBmcm9tIFwiLi9yZXNvdXJjZVwiO1xyXG5pbXBvcnQgeyBFbmdpbmVEcmF3RnJhbWUsIEVuZ2luZURyYXdSZWN0LCBFbmdpbmVDbGVhciwgRW5naW5lRHJhd0xpbmUsIEVuZ2luZURyYXdDaXJjbGUgfSBmcm9tIFwiLi4vbGliL2VuZ2luZS9iYXNlXCI7XHJcbmltcG9ydCB7IFRvQ2FtZXJhU3RhcnRQb3MgfSBmcm9tIFwiLi4vbGliL2NhbWVyYS91dGlsc1wiO1xyXG5cclxuLyoqXHJcbiAqIOa4hemZpOeUu+W4g1xyXG4gKi9cclxuZnVuY3Rpb24gQ2xlYXIoKXtcclxuICAgIEVuZ2luZUNsZWFyKEdldEVuZ2luZSgpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE8g5Y+v6IO95Lya5pS55oiQc3ByaXRlRnJhbWVJZOWPguaVsFxyXG4gKi9cclxuZnVuY3Rpb24gRHJhd0ZyYW1lKHBvcyA9IG51bGwsIHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICBEcmF3RnJhbWVJbkNhbWVyYShcclxuICAgICAgICBHZXREZWZhdWx0Q2FtZXJhKCksIHBvcywgc3ByaXRlRnJhbWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3RnJhbWVJbkNhbWVyYShjYW1lcmEgPSBudWxsLCBwb3MgPSBudWxsLCBzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgbGV0IGNQb3MgPSBUb0NhbWVyYVN0YXJ0UG9zKGNhbWVyYSwgcG9zKTtcclxuICAgIEVuZ2luZURyYXdGcmFtZShHZXRFbmdpbmUoKSxcclxuICAgICAgICBjUG9zLngsIGNQb3MueSwgc3ByaXRlRnJhbWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3UmVjdChwb3MgPSBudWxsLCByZWN0ID0gbnVsbCl7XHJcbiAgICBEcmF3UmVjdEluQ2FtZXJhKFxyXG4gICAgICAgIEdldERlZmF1bHRDYW1lcmEoKSwgcG9zLCByZWN0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gRHJhd1JlY3RJbkNhbWVyYShjYW1lcmEgPSBudWxsLCBwb3MgPSBudWxsLCByZWN0ID0gbnVsbCl7XHJcbiAgICBsZXQgY1BvcyA9IFRvQ2FtZXJhU3RhcnRQb3MoY2FtZXJhLCBwb3MpO1xyXG4gICAgRW5naW5lRHJhd1JlY3QoR2V0RW5naW5lKCksIGNQb3MsIHJlY3QpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3TGluZShwb3NTdGFydCA9IG51bGwsIHBvc0VuZCA9IG51bGwpe1xyXG4gICAgRHJhd0xpbmVJbkNhbWVyYShcclxuICAgICAgICBHZXREZWZhdWx0Q2FtZXJhKCksIHBvc1N0YXJ0LCBwb3NFbmQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3TGluZUluQ2FtZXJhKGNhbWVyYSA9IG51bGwsIHBvc1N0YXJ0ID0gbnVsbCwgcG9zRW5kID0gbnVsbCl7XHJcbiAgICBsZXQgY1BvczEgPSBUb0NhbWVyYVN0YXJ0UG9zKGNhbWVyYSwgcG9zU3RhcnQpO1xyXG4gICAgbGV0IGNQb3MyID0gVG9DYW1lcmFTdGFydFBvcyhjYW1lcmEsIHBvc0VuZCk7XHJcbiAgICBFbmdpbmVEcmF3TGluZShHZXRFbmdpbmUoKSwgY1BvczEsIGNQb3MyKTtcclxufVxyXG5cclxuZnVuY3Rpb24gRHJhd0NpcmNsZShwb3MgPSBudWxsLCByYWRpdXMgPSAwKXtcclxuICAgIERyYXdDaXJjbGVJbkNhbWVyYShcclxuICAgICAgICBHZXREZWZhdWx0Q2FtZXJhKCksIHBvcywgcmFkaXVzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gRHJhd0NpcmNsZUluQ2FtZXJhKGNhbWVyYSA9IG51bGwsIHBvcyA9IG51bGwsIHJhZGl1cyA9IDApe1xyXG4gICAgbGV0IGNQb3MgPSBUb0NhbWVyYVN0YXJ0UG9zKGNhbWVyYSwgcG9zKTtcclxuICAgIEVuZ2luZURyYXdDaXJjbGUoR2V0RW5naW5lKCksIGNQb3MsIHJhZGl1cyk7XHJcbn1cclxuXHJcbmV4cG9ydHtcclxuICAgIENsZWFyLCBEcmF3RnJhbWUsIERyYXdGcmFtZUluQ2FtZXJhLFxyXG4gICAgRHJhd1JlY3QsIERyYXdSZWN0SW5DYW1lcmEsIFxyXG4gICAgRHJhd0xpbmUsIERyYXdMaW5lSW5DYW1lcmEsXHJcbiAgICBEcmF3Q2lyY2xlLCBEcmF3Q2lyY2xlSW5DYW1lcmFcclxufSIsIi8qKlxyXG4gKiDmir3osaHliJfooajmk43kvZxcclxuICovXHJcbmNsYXNzIEFic3RyYWN0TGlzdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcigpe31cclxuICAgIGdldChpZCA9IDApe30gICAgICAgICAgLy/moLnmja5pZOiOt+W+l1xyXG4gICAgZmlyc3IoKXt9XHJcbiAgICBsYXN0KCl7fVxyXG4gICAgc2l6ZSgpe30gICAgICAgICAgICAgICAgLy/ov5Tlm57plb/luqZcclxuICAgIGFkZChkYXRhID0gbnVsbCl7fSAgICAgIC8v5bC+6YOo6L+95YqgXHJcbiAgICBwdXNoKGRhdGEgPSBudWxsKXt9ICAgICAvL+WktOmDqOi/veWKoFxyXG4gICAgaW5zZXJ0KGRhdGEgPSBudWxsLCBvcmRlciA9IDApe30gICAgLy/mj5LlhaXliLDmjIflrprpobrluo/vvIznm7jlkIxvcmRlcumXtOeahOWFiOWQjumhuuW6j+eci+WFt+S9k+WunueOsOmAu+i+kVxyXG4gICAgcG9wKCl7fSAgICAgICAgICAgICAgIC8v56e76Zmk5aS06YOo5YWD57SgXHJcbiAgICBwdWxsKCl7fSAgICAgICAgICAgICAgLy/np7vpmaTlsL7pg6jlhYPntKBcclxuICAgIHJlbW92ZShpZCA9IDApe30gICAgICAvL+agueaNrmlk56e76ZmkXHJcbiAgICBpdGVyYXRvcihjYWxsYmFjayA9IG51bGwpe31cclxuICAgIGl0ZXJhdG9yUmV2ZXJzZShjYWxsYmFjayA9IG51bGwpe31cclxuICAgIGl0ZXJhdG9yQ29tcGFyZShjYWxsYmFjayA9IG51bGwpe31cclxufVxyXG5cclxuZnVuY3Rpb24gR2V0TGlzdERhdGEobGlzdCA9IG51bGwsIGlkID0gMCwgcmVxdWlyZWQgPSBmYWxzZSl7XHJcbiAgICBsZXQgZGF0YSA9IGxpc3QuZ2V0KGlkKTtcclxuICAgIGlmKCFkYXRhICYmIHJlcXVpcmVkKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiY2FuJ3QgZmluZCBrZXlJZDogXCIsIGlkKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRMaXN0Rmlyc3QobGlzdCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGxpc3QuZmlyc3QoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0TGlzdExhc3QobGlzdCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGxpc3QubGFzdCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRMaXN0U2l6ZShsaXN0ID0gbnVsbCl7XHJcbiAgICByZXR1cm4gbGlzdC5zaXplKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrQWRkKGxpc3QgPSBudWxsLCBkYXRhID0gbnVsbCl7XHJcbiAgICBpZighbGlzdCB8fCAhZGF0YSB8fCAhZGF0YS5pZCl7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcImVycm9yIHBhcmFtLlwiKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvL+S4jeiDvemHjeWkjea3u+WKoFxyXG4gICAgbGV0IGQgPSBHZXRMaXN0RGF0YShsaXN0LCBpZCk7XHJcbiAgICBpZihkKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiZXJyb3IgaWQ6JWQgaXMgZXhpc3RcIiwgaWQpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICog5bC+6YOo6L+95YqgXHJcbiAqIEBwYXJhbSB7Kn0gbGlzdCBcclxuICogQHBhcmFtIHsqfSBkYXRhIFxyXG4gKi9cclxuZnVuY3Rpb24gQWRkVG9MaXN0KGxpc3QgPSBudWxsLCBkYXRhID0gbnVsbCl7XHJcbiAgICBpZihjaGVja0FkZChsaXN0LCBkYXRhKSl7XHJcbiAgICAgICAgbGlzdC5hZGQoZGF0YSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlpLTpg6jov73liqBcclxuICogQHBhcmFtIHsqfSBsaXN0IFxyXG4gKiBAcGFyYW0geyp9IGRhdGEgXHJcbiAqL1xyXG5mdW5jdGlvbiBQdXNoVG9MaXN0KGxpc3QgPSBudWxsLCBkYXRhID0gbnVsbCl7XHJcbiAgICBpZihjaGVja0FkZChsaXN0LCBkYXRhKSl7XHJcbiAgICAgICAgbGlzdC5wdXNoKGRhdGEpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICog5qC55o2u6aG65bqP5Y+35o+S5YWlXHJcbiAqIEBwYXJhbSB7Kn0gbGlzdCBcclxuICogQHBhcmFtIHsqfSBkYXRhIFxyXG4gKiBAcGFyYW0geyp9IG9yZGVyIFxyXG4gKi9cclxuZnVuY3Rpb24gSW5zZXJ0VG9MaXN0KGxpc3QgPSBudWxsLCBkYXRhID0gbnVsbCwgb3JkZXIgPSAwKXtcclxuICAgIGlmKGNoZWNrQWRkKGxpc3QsIGRhdGEpKXtcclxuICAgICAgICBsaXN0Lmluc2VydChkYXRhLCBvcmRlcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlpLTpg6jnp7vpmaRcclxuICogQHBhcmFtIHsqfSBsaXN0IFxyXG4gKi9cclxuZnVuY3Rpb24gUG9wRnJvbUxpc3QobGlzdCA9IG51bGwpe1xyXG4gICAgbGlzdC5wb3AoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOWwvumDqOenu+mZpFxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqL1xyXG5mdW5jdGlvbiBQdWxsRnJvbUxpc3QobGlzdCA9IG51bGwpe1xyXG4gICAgbGlzdC5wdWxsKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmoLnmja5pZOenu+mZpFxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqIEBwYXJhbSB7Kn0gaWQgXHJcbiAqL1xyXG5mdW5jdGlvbiBSZW1vdmVGcm9tTGlzdChsaXN0ID0gbnVsbCwgaWQgPSAwKXtcclxuICAgIGxpc3QucmVtb3ZlKGlkKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOato+WQkemBjeWOhlxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqIEBwYXJhbSB7Kn0gY2FsbGJhY2sgZnVuYyhkYXRhKXsgcmV0dXJuIGJvb2x9IOiLpWJvb2w9dHJ1Ze+8jOWImee7iOatoumBjeWOhlxyXG4gKi9cclxuZnVuY3Rpb24gTGlzdEl0ZXJhdG9yKGxpc3QgPSBudWxsLCBjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgaWYoIWxpc3QgfHwgIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy9sb2cgaGVyZVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgbGlzdC5pdGVyYXRvcihjYWxsYmFjayk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlj43lkJHpgY3ljoZcclxuICogQHBhcmFtIHsqfSBsaXN0IFxyXG4gKiBAcGFyYW0geyp9IGNhbGxiYWNrIFxyXG4gKi9cclxuZnVuY3Rpb24gTGlzdEl0ZXJhdG9yUmV2ZXJzZShsaXN0ID0gbnVsbCwgY2FsbGJhY2sgPSBudWxsKXtcclxuICAgIGlmKCFsaXN0IHx8ICFjYWxsYmFjaykge1xyXG4gICAgICAgIC8vbG9nIGhlcmVcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuICAgIGxpc3QuaXRlcmF0b3JSZXZlcnNlKGNhbGxiYWNrKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOWGhemDqOS+neasoeWvueavlFxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqIEBwYXJhbSB7Kn0gY2FsbGJhY2sgZnVuYyhkYXRhMSwgZGF0YTIpIHJldHVybiBib29sIOiLpWJvb2w9dHJ1Ze+8jOWImee7iOatoumBjeWOhlxyXG4gKi9cclxuZnVuY3Rpb24gTGlzdEl0ZXJhdG9yQ29tcGFyZShsaXN0ID0gbnVsbCwgY2FsbGJhY2sgPSBudWxsKXtcclxuICAgIGlmKCFsaW5rIHx8ICFjYWxsYmFjaykge1xyXG4gICAgICAgIC8vbG9nIGhlcmVcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuICAgIGxpc3QuaXRlcmF0b3JDb21wYXJlKGNhbGxiYWNrKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIEFic3RyYWN0TGlzdCxcclxuICAgIEdldExpc3REYXRhLCBHZXRMaXN0Rmlyc3QsIEdldExpc3RMYXN0LCBHZXRMaXN0U2l6ZSwgXHJcbiAgICBBZGRUb0xpc3QsIFB1c2hUb0xpc3QsIEluc2VydFRvTGlzdCwgUG9wRnJvbUxpc3QsIFB1bGxGcm9tTGlzdCwgUmVtb3ZlRnJvbUxpc3QsXHJcbiAgICBMaXN0SXRlcmF0b3IsIExpc3RJdGVyYXRvclJldmVyc2UsIExpc3RJdGVyYXRvckNvbXBhcmVcclxufSIsImltcG9ydCB7IEFic3RyYWN0TGlzdCB9IGZyb20gXCIuLi8uLi9mb3VuZGF0aW9uL2NvbnRhaW5lci9saXN0XCI7XHJcblxyXG5jbGFzcyBMaW5rTm9kZSB7XHJcblx0Y29uc3RydWN0b3IoZGF0YSA9IG51bGwsIHByZXAgPSBudWxsLCBuZXh0ID0gbnVsbCwgb3JkZXIgPSAwKSB7XHJcblx0XHR0aGlzLmRhdGEgPSBkYXRhO1xyXG5cdFx0dGhpcy5wcmVwID0gcHJlcDtcclxuICAgICAgICB0aGlzLm5leHQgPSBuZXh0O1xyXG4gICAgICAgIHRoaXMub3JkZXIgPSBvcmRlcjtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIExpbmtMaXN0IGV4dGVuZHMgQWJzdHJhY3RMaXN0IHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cdFx0dGhpcy5oZWFkID0gbmV3IExpbmtOb2RlKCk7XHRcdC8vZW1wdHkgZGF0YSBub2RlXHJcblx0XHR0aGlzLnRhaWwgPSBuZXcgTGlua05vZGUoKTtcclxuXHRcdHRoaXMuaGVhZC5uZXh0ID0gdGhpcy50YWlsO1xyXG5cdFx0dGhpcy50YWlsLnByZXAgPSB0aGlzLmhlYWQ7XHJcblx0XHR0aGlzLl9tYXAgPSBuZXcgTWFwKCk7XHJcblx0XHR0aGlzLl9zaXplID0gMDtcclxuICAgICAgICB0aGlzLl9kZWxMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5fY3VyciA9IHRoaXMuaGVhZDtcclxuICAgICAgICB0aGlzLl9sb2NrID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldChpZCA9IDApe1xyXG4gICAgICAgIGxldCBub2RlID0gdGhpcy5fbWFwLmdldChpZCk7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUgPyBub2RlLmRhdGEgOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGZpcnN0KCl7XHJcbiAgICAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQubmV4dDtcclxuICAgICAgICByZXR1cm4gbm9kZSA9PSB0aGlzLnRhaWwgPyBudWxsIDogbm9kZS5kYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIGxhc3QoKXtcclxuICAgICAgICBsZXQgbm9kZSA9IHRoaXMudGFpbC5wcmVwO1xyXG4gICAgICAgIHJldHVybiBub2RlID09IHRoaXMuaGVhZCA/IG51bGwgOiBub2RlLmRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgc2l6ZSgpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZChkYXRhID0gbnVsbCl7XHJcbiAgICAgICAgYWRkVG9MaW5rKHRoaXMsIGRhdGEsIHRoaXMudGFpbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVzaChkYXRhID0gbnVsbCl7XHJcbiAgICAgICAgYWRkVG9MaW5rKHRoaXMsIGRhdGEsIHRoaXMuaGVhZC5uZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICBpbnNlcnQoZGF0YSA9IG51bGwsIG9yZGVyID0gMCl7XHJcbiAgICAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQubmV4dDtcclxuICAgICAgICB3aGlsZShub2RlICE9IHRoaXMudGFpbCl7XHJcbiAgICAgICAgICAgIGlmKG9yZGVyIDwgbm9kZS5vcmRlcil7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBub2RlID0gbm9kZS5uZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBhZGRUb0xpbmsodGhpcywgZGF0YSwgbm9kZSwgb3JkZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIHBvcCgpe1xyXG4gICAgICAgIHJlbW92ZVdpdGhDaGVjayh0aGlzLCB0aGlzLmhlYWQubmV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVsbCgpe1xyXG4gICAgICAgIHJlbW92ZVdpdGhDaGVjayh0aGlzLCB0aGlzLnRhaWwucHJlcCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlKGlkID0gMCl7XHJcbiAgICAgICAgcmVtb3ZlV2l0aENoZWNrKHRoaXMsIHRoaXMuX21hcC5nZXQoaWQpKTtcclxuICAgIH1cclxuXHJcbiAgICBpdGVyYXRvcihjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgICAgIHRoaXMuX2xvY2sgPSB0cnVlO1xyXG4gICAgICAgIGxldCBub2RlID0gdGhpcy5oZWFkLm5leHQ7XHJcbiAgICAgICAgd2hpbGUobm9kZSAhPSB0aGlzLnRhaWwpe1xyXG4gICAgICAgICAgICBpZihjYWxsYmFjayhub2RlLmRhdGEpKXtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLm5leHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvY2sgPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSh0aGlzLl9kZWxMaXN0Lmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKHRoaXMsIHRoaXMuX2RlbExpc3QucG9wKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpdGVyYXRvclJldmVyc2UoY2FsbGJhY2sgPSBudWxsKXtcclxuICAgICAgICB0aGlzLl9sb2NrID0gdHJ1ZTtcclxuICAgICAgICBsZXQgbm9kZSA9IHRoaXMudGFpbC5wcmVwO1xyXG4gICAgICAgIHdoaWxlKG5vZGUgIT0gdGhpcy5oZWFkKXtcclxuICAgICAgICAgICAgaWYoY2FsbGJhY2sobm9kZS5kYXRhKSl7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBub2RlID0gbm9kZS5wcmVwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2NrID0gZmFsc2U7XHJcbiAgICAgICAgd2hpbGUodGhpcy5fZGVsTGlzdC5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgcmVtb3ZlTm9kZSh0aGlzLCB0aGlzLl9kZWxMaXN0LnBvcCgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaXRlcmF0b3JDb21wYXJlKGNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICAgICAgdGhpcy5fbG9jayA9IHRydWU7XHJcbiAgICAgICAgbGV0IG91dE5vZGUgPSB0aGlzLmhlYWQubmV4dDtcclxuICAgICAgICB3aGlsZShvdXROb2RlICE9IHRoaXMudGFpbCl7XHJcbiAgICAgICAgICAgIGxldCBpbk5vZGUgPSBvdXROb2RlLm5leHQ7XHJcbiAgICAgICAgICAgIHdoaWxlKGluTm9kZSAhPSB0aGlzLnRhaWwpe1xyXG4gICAgICAgICAgICAgICAgaWYoY2FsbGJhY2sob3V0Tm9kZS5kYXRhLCBpbk5vZGUuZGF0YSkpe1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5Ob2RlID0gaW5Ob2RlLm5leHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3V0Tm9kZSA9IG91dE5vZGUubmV4dDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9jayA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlKHRoaXMuX2RlbExpc3QubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUodGhpcywgdGhpcy5fZGVsTGlzdC5wb3AoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRUb0xpbmsobGluayA9IG51bGwsIGRhdGEgPSBudWxsLCBuZXh0ID0gbnVsbCwgb3JkZXIgPSAwKXtcclxuICAgIC8v5paw6IqC54K56L+e5o6lXHJcbiAgICBsZXQgcHJlcCA9IG5leHQucHJlcDtcclxuICAgIGxldCBub2RlID0gbmV3IExpbmtOb2RlKGRhdGEsIHByZXAsIG5leHQsIG9yZGVyKTtcclxuICAgIHByZXAubmV4dCA9IG5vZGU7XHJcbiAgICBuZXh0LnByZXAgPSBub2RlO1xyXG5cclxuICAgIGxpbmsuX21hcC5zZXQoZGF0YS5pZCwgbm9kZSk7XHJcbiAgICBsaW5rLl9zaXplKys7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZVdpdGhDaGVjayhsaW5rID0gbnVsbCwgdGFyZ2V0Tm9kZSA9IG51bGwpe1xyXG4gICAgaWYoIWxpbmsgfHwgIXRhcmdldE5vZGUgfHwgbGluay5fc2l6ZSA8PSAwKXtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZihsaW5rLl9sb2NrKXtcclxuICAgICAgICBsaW5rLl9kZWxMaXN0LnB1c2godGFyZ2V0Tm9kZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlTm9kZShsaW5rLCB0YXJnZXROb2RlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlTm9kZShsaW5rID0gbnVsbCwgbm9kZSA9IG51bGwpe1xyXG4gICAgbGluay5fbWFwLmRlbGV0ZShrZXlJZCk7XHJcbiAgICBsZXQgcCA9IG5vZGUucHJlcDtcclxuICAgIGxldCBuID0gbm9kZS5uZXh0O1xyXG4gICAgcC5uZXh0ID0gbjtcclxuICAgIG4ucHJlcCA9IHA7XHJcbiAgICBsaW5rLl9zaXplLS07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld0xpbmsoKXtcclxuICAgIHJldHVybiBuZXcgTGlua0xpc3QoKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIE5ld0xpbmtcclxufSIsIlxyXG4vKipcclxuICog5q+P5LiA56eN5paw57G75a+55bqU5LiA5LiqSUTvvIzkvr/kuo7lm57mlLZcclxuICovXHJcbnZhciBjbHpJZCA9IDE7XHJcbmZ1bmN0aW9uIE5leHRDbGFzc0lkKCl7XHJcblx0cmV0dXJuIGNseklkKys7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmr4/kuKrlrp7kvZPmi6XmnInkuIDkuKrni6znq4tJRFxyXG4gKi9cclxudmFyIGVudGl0eUlkID0gMTtcclxuZnVuY3Rpb24gTmV3RW50aXR5SWQoKXtcclxuXHRyZXR1cm4gZW50aXR5SWQrKztcclxufVxyXG5cclxuLyoqXHJcbiAqIOaaguWumui/meS4quWQjVxyXG4gKi9cclxuY2xhc3MgREZDbGFzcyB7XHJcblx0Y29uc3RydWN0b3IoY2x6SWQgPSAwKSB7XHJcblx0XHR0aGlzLmNseklkID0gY2x6SWQ7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICog5oul5pyJaWTlsZ7mgKfnmoTpg73nu6fmib/mraTnsbvvvIzljbNFQ1PkuK3nmoRFbnRpdHlcclxuICovXHJcbmNsYXNzIEdhbWVPYmplY3Qge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0dGhpcy5pZCA9IE5ld0VudGl0eUlkKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuKlx0VGhlIGJhc2UgQ29tcG9uZW50XHJcbipcdOavj+S4qmVudGl0eeWvueavj+enjee7hOS7tuWPquiDveaMgeacieS4gOS4qlxyXG4qL1xyXG5jbGFzcyBDb21wb25lbnQge1xyXG5cdGNvbnN0cnVjdG9yKGVudGl0eUlkID0gMCkge1xyXG5cdFx0dGhpcy5lbnRpdHlJZCA9IGVudGl0eUlkO1xyXG5cdFx0dGhpcy5pZCA9IGVudGl0eUlkO1x0XHRcdC8v57uZbGlua+S9v+eUqFxyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbipcdFRoZSBiYXNlIFN5c3RlbVxyXG4qL1xyXG5jbGFzcyBTeXN0ZW0ge1xyXG5cdGNvbnN0cnVjdG9yKCl7XHJcblx0XHR0aGlzLmlkID0gTmV3RW50aXR5SWQoKTtcclxuXHR9XHJcbiAgICBvblN0YXJ0KCl7fVxyXG4gICAgb25VcGRhdGUoZHQgPSAwKXt9XHJcbiAgICBvbkVuZCgpe31cclxufVxyXG5cclxuZXhwb3J0IHtOZXdFbnRpdHlJZCwgR2FtZU9iamVjdCwgQ29tcG9uZW50LCBTeXN0ZW19IiwiaW1wb3J0IHsgTmV3TGluayB9IGZyb20gXCIuLi8uLi9saXN0L2xpbmtsaXN0XCI7XHJcbmltcG9ydCB7IEluc2VydFRvTGlzdCwgR2V0TGlzdERhdGEsIFJlbW92ZUZyb21MaXN0LCBMaXN0SXRlcmF0b3IgfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9jb250YWluZXIvbGlzdFwiO1xyXG5cclxuLyoqXHJcbiAqIOaYvuekuuWbvuWxglxyXG4gKiAgb3JkZXLotorkvY7vvIzotorlhYjmuLLmn5PvvIzlkI7muLLmn5PnmoTkvJrpga7kvY/liY3pnaLmuLLmn5PnmoRcclxuICovXHJcbmNsYXNzIExheWVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG9yZGVyID0gMCl7XHJcbiAgICAgICAgdGhpcy5pZCA9IG9yZGVyO1xyXG4gICAgICAgIHRoaXMub3JkZXIgPSBvcmRlcjtcclxuICAgICAgICB0aGlzLmxpc3QgPSBOZXdMaW5rKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbnZhciBsYXllckxpc3QgPSBOZXdMaW5rKCk7XHJcbmZ1bmN0aW9uIGFkZExheWVyKG9yZGVyID0gMCl7XHJcbiAgICBsZXQgbGF5ZXIgPSBuZXcgTGF5ZXIob3JkZXIpO1xyXG4gICAgSW5zZXJ0VG9MaXN0KGxheWVyTGlzdCwgbGF5ZXIpO1xyXG4gICAgcmV0dXJuIGxheWVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRMYXllcihvcmRlciA9IDApe1xyXG4gICAgbGV0IGxheWVyID0gR2V0TGlzdERhdGEobGF5ZXJMaXN0LCBvcmRlcik7XHJcbiAgICBpZighbGF5ZXIpe1xyXG4gICAgICAgIGxheWVyID0gYWRkTGF5ZXIob3JkZXIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxheWVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBJdGVyYXRvckxheWVycyhjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgTGlzdEl0ZXJhdG9yKGxheWVyTGlzdCwgbGF5ZXIgPT4ge1xyXG4gICAgICAgIExpc3RJdGVyYXRvcihsYXllci5saXN0LCBkaXNwbGF5VHVwbGUgPT4ge1xyXG4gICAgICAgICAgICBjYWxsYmFjayhkaXNwbGF5VHVwbGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gQWRkVG9MYXllcihkaXNwbGF5VHVwbGUgPSBudWxsKXtcclxuICAgIGxldCBsYXllciA9IEdldExheWVyKGRpc3BsYXlUdXBsZS5sYXllck9yZGVyKTtcclxuICAgIEluc2VydFRvTGlzdChsYXllci5saXN0LCBkaXNwbGF5VHVwbGUsIGRpc3BsYXlUdXBsZS5vcmRlcik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFJlbW92ZUZyb21MYXllcihkaXNwbGF5VHVwbGUgPSBudWxsKXtcclxuICAgIGxldCBsYXllciA9IEdldExheWVyKGRpc3BsYXlUdXBsZS5vcmRlcik7XHJcbiAgICBSZW1vdmVGcm9tTGlzdChsYXllci5saXN0LCBkaXNwbGF5VHVwbGUuaWQpO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgR2V0TGF5ZXIsIEl0ZXJhdG9yTGF5ZXJzLCBBZGRUb0xheWVyLCBSZW1vdmVGcm9tTGF5ZXJcclxufSIsIi8qKlxyXG4gKiBkYXRh5bCx5piv5Zu+54mH5paH5Lu2XHJcbiAqIHdpZHRoLCBoZWlnaHTlj6/pgInvvIzmnIDlpb3mnIlcclxuICovXHJcbmNsYXNzIEJpdG1hcCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhID0gbnVsbCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIENyZWF0ZUJpdG1hcChiaXRtYXBEYXRhID0gbnVsbCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwKXtcclxuICAgIHJldHVybiBuZXcgQml0bWFwKGJpdG1hcERhdGEsIHdpZHRoLCBoZWlnaHQpO1xyXG59XHJcblxyXG4vKipcclxuICog55So5LqO6KGo56S6Yml0bWFw55qE5LiA5Liq5Yy65Z+f77yM5bm26Z2ecmVjdFxyXG4gKi9cclxuY2xhc3MgU2VnIHtcclxuICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwKXtcclxuICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICog5LiA5byg5Zu+5Lit55qE5LiA5Liq5Yy65Z+f77yM57q555CG5bin5oiW57K+54G15bin77yM5Y2V5L6L77yM5ZKM5byV5pOO5pyJ5YWzXHJcbiAqIOeyvueBteW4p+eUqOS6juagh+WHuuS4gOW8oOe6ueeQhuWbvueahOaMh+WumuWPluadkOWMuuWfn++8jOS7peWPiuebuOWvueeahOaYvuekuuS9jee9rlxyXG4gKi9cclxuY2xhc3MgU3ByaXRlRnJhbWUge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSA9IFwiXCIsIHNlZyA9IG51bGwsIGJpdG1hcCA9IG51bGwpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuc2VnID0gc2VnO1xyXG4gICAgICAgIHRoaXMuYml0bWFwID0gYml0bWFwO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBDcmVhdGVTcHJpdGVGcmFtZShuYW1lID0gXCJcIiwgYml0bWFwID0gbnVsbCwgeCA9IDAsIHkgPSAwLCB3aWR0aCA9IDAsIGhlaWdodCA9IDApe1xyXG4gICAgbGV0IHNlZyA9IG5ldyBTZWcoeCwgeSwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICBsZXQgZiA9IG5ldyBTcHJpdGVGcmFtZShuYW1lLCBzZWcsIGJpdG1hcCk7XHJcbiAgICByZXR1cm4gZjtcclxufVxyXG5cclxuLyoqXHJcbiAqIHNwcml0ZUZyYW1l5byA5aeL57uY5Yi255qE5Z2Q5qCH77yM5bem5LiK6KeS5byA5aeL77yM5LiOcG9z5peg5YWzXHJcbiAqIEBwYXJhbSB7Kn0gc3ByaXRlRnJhbWUgXHJcbiAqL1xyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZVN0YXJ0WChzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHNwcml0ZUZyYW1lLnNlZy54O1xyXG59XHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lU3RhcnRZKHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICByZXR1cm4gc3ByaXRlRnJhbWUuc2VnLnk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lV2lkdGgoc3ByaXRlRnJhbWUgPSBudWxsKXtcclxuICAgIHJldHVybiBzcHJpdGVGcmFtZS5zZWcud2lkdGg7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lSGFsZldpZHRoKHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICByZXR1cm4gc3ByaXRlRnJhbWUuc2VnLndpZHRoICogMC41O1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZUhlaWdodChzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHNwcml0ZUZyYW1lLnNlZy5oZWlnaHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lSGFsZkhlaWdodChzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHNwcml0ZUZyYW1lLnNlZy5oZWlnaHQgKiAwLjU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lQml0bWFwRGF0YShzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHNwcml0ZUZyYW1lLmJpdG1hcC5kYXRhO1xyXG59XHJcblxyXG5leHBvcnR7XHJcbiAgICBDcmVhdGVCaXRtYXAsIENyZWF0ZVNwcml0ZUZyYW1lLCBcclxuICAgIEdldFNwcml0ZUZyYW1lU3RhcnRYLCBHZXRTcHJpdGVGcmFtZVN0YXJ0WSxcclxuICAgIEdldFNwcml0ZUZyYW1lV2lkdGgsIEdldFNwcml0ZUZyYW1lSGFsZldpZHRoLCBHZXRTcHJpdGVGcmFtZUhlaWdodCwgR2V0U3ByaXRlRnJhbWVIYWxmSGVpZ2h0LFxyXG4gICAgR2V0U3ByaXRlRnJhbWVCaXRtYXBEYXRhXHJcbn0iLCJpbXBvcnQgeyBBZGRUb0xpc3QsIEdldExpc3REYXRhLCBSZW1vdmVGcm9tTGlzdCB9IGZyb20gXCIuLi8uLi9mb3VuZGF0aW9uL2NvbnRhaW5lci9saXN0XCI7XHJcbmltcG9ydCB7IE5ld1ZlYywgTmV3UG9zLCBVcGRhdGVQb3MsIFVwZGF0ZVZlYyB9IGZyb20gXCIuLi8uLi9mb3VuZGF0aW9uL3N0cnVjdHVyZS9nZW9tZXRyaWNcIjtcclxuXHJcbi8qKlxyXG4gKiDkvY3nva7nu4Tku7ZcclxuICovXHJcbmNsYXNzIFBvc0NvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbnRpdHlJZCA9IDAsIHBvcyA9IG51bGwpe1xyXG4gICAgICAgIHN1cGVyKGVudGl0eUlkKTtcclxuICAgICAgICB0aGlzLnBvcyA9IHBvcztcclxuICAgICAgICB0aGlzLnZlYyA9IE5ld1ZlYygpO1xyXG4gICAgfVxyXG59XHJcblxyXG52YXIgcG9zQ29tcyA9IE5ld0xpbmsoKTtcclxuZnVuY3Rpb24gY3JlYXRlUG9zQ29tcG9uZW50KGVudGl0eUlkID0gMCkge1xyXG4gICAgbGV0IGNvbSA9IG5ldyBQb3NDb21wb25lbnQoZW50aXR5SWQsIE5ld1BvcygpKTtcclxuICAgIEFkZFRvTGlzdChwb3NDb21zLCBjb20pO1xyXG4gICAgcmV0dXJuIGNvbTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0UG9zQ29tcG9uZW50KGVudGl0eUlkID0gMCkge1xyXG4gICAgbGV0IGNvbSA9IEdldExpc3REYXRhKHBvc0NvbXMsIGVudGl0eUlkKTtcclxuICAgIHJldHVybiBjb20gPyBjb20gOiBjcmVhdGVQb3NDb21wb25lbnQoZW50aXR5SWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBSZW1vdmVQb3NDb21wb25lbnQoZW50aXR5SWQgPSAwKXtcclxuICAgIFJlbW92ZUZyb21MaXN0KHBvc0NvbXMsIGVudGl0eUlkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0VW5pdFBvcyhlbnRpdHlJZCA9IDApe1xyXG4gICAgcmV0dXJuIEdldFBvc0NvbXBvbmVudChlbnRpdHlJZCkucG9zO1xyXG59XHJcblxyXG5mdW5jdGlvbiBTZXRVbml0UG9zKGVudGl0eUlkID0gMCwgeCA9IDAsIHkgPSAwKXtcclxuICAgIFVwZGF0ZVBvcyhHZXRVbml0UG9zKGVudGl0eUlkKSwgeCwgeSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFVuaXRWZWMoZW50aXR5SWQgPSAwKXtcclxuICAgIHJldHVybiBHZXRQb3NDb21wb25lbnQoZW50aXR5SWQpLnZlYztcclxufVxyXG5cclxuZnVuY3Rpb24gU2V0VW5pdFZlYyhlbnRpdHlJZCA9IDAsIHggPSAwLCB5ID0gMCl7XHJcbiAgICBVcGRhdGVWZWMoR2V0VW5pdFZlYyhlbnRpdHlJZCksIHgsIHkpO1xyXG59XHJcblxyXG5leHBvcnR7IFxyXG4gICAgR2V0UG9zQ29tcG9uZW50LCBSZW1vdmVQb3NDb21wb25lbnQsXHJcbiAgICBHZXRVbml0UG9zLCBTZXRVbml0UG9zLCBHZXRVbml0VmVjLCBTZXRVbml0VmVjXHJcbn0iLCJpbXBvcnQgeyBHZXRSZWFsUG9zLCBHZXRQb3MsIEdldE9mZnNldCB9IGZyb20gXCIuLi8uLi8uLi9mb3VuZGF0aW9uL29mZnNldC9iYXNlXCI7XHJcbmltcG9ydCB7IENvbXBvbmVudCwgR2FtZU9iamVjdCB9IGZyb20gXCIuLi8uLi8uLi9mb3VuZGF0aW9uL2NvbXBvbmVudC9lY3NcIjtcclxuaW1wb3J0IHsgTmV3TGluayB9IGZyb20gXCIuLi8uLi9saXN0L2xpbmtsaXN0XCI7XHJcbmltcG9ydCB7IEFkZFRvTGlzdCwgR2V0TGlzdERhdGEgfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9jb250YWluZXIvbGlzdFwiO1xyXG5pbXBvcnQgeyBOZXdQb3MsIFVwZGF0ZVBvcywgTmV3UmVjdCB9IGZyb20gXCIuLi8uLi8uLi9mb3VuZGF0aW9uL3N0cnVjdHVyZS9nZW9tZXRyaWNcIjtcclxuaW1wb3J0IHsgTmV3UmVjdFBvc1JlbGF0aW9uIH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vb2Zmc2V0L3JlY3RcIjtcclxuaW1wb3J0IHsgR2V0U3ByaXRlRnJhbWVXaWR0aCwgR2V0U3ByaXRlRnJhbWVIZWlnaHQgfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZnJhbWVcIjtcclxuaW1wb3J0IHsgR2V0UG9zQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uL3Bvcy9jb21wb25lbnRcIjtcclxuXHJcbi8qKlxyXG4gKiDmmL7npLrnu4Tku7bvvIzljIXlkKvkuIDkupvmmL7npLrlj4LmlbBcclxuICovXHJcbmNsYXNzIFJlbmRlckNvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XHJcblx0Y29uc3RydWN0b3IoZW50aXR5SWQgPSAwLCBpc29tZXRyaWNzID0gZmFsc2UsIGFuZ2xlID0gMCwgc2NhbGUgPSAxKSB7XHJcbiAgICAgICAgc3VwZXIoZW50aXR5SWQpO1xyXG4gICAgICAgIHRoaXMuaXNvbWV0cmljcyA9IGlzb21ldHJpY3M7XHJcbiAgICAgICAgdGhpcy5hbmdsZSA9IGFuZ2xlO1xyXG4gICAgICAgIHRoaXMuc2NhbGUgPSBzY2FsZTtcclxuXHR9XHJcbn1cclxuXHJcbnZhciByZW5kZXJDb21zID0gTmV3TGluaygpO1xyXG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJDb21wb25lbnQoZW50aXR5SWQgPSAwLCBvcHRpb25zID0gbnVsbCkge1xyXG4gICAgLy/pu5jorqTlgLxcclxuICAgIG9wdGlvbnMgPSBvcHRpb25zID8gb3B0aW9ucyA6IHt9O1xyXG4gICAgbGV0IGNvbSA9IG5ldyBSZW5kZXJDb21wb25lbnQoZW50aXR5SWQsIG9wdGlvbnMuaXNvbWV0cmljcywgb3B0aW9ucy5hbmdsZSwgb3B0aW9ucy5zY2FsZSk7XHJcbiAgICBBZGRUb0xpc3QocmVuZGVyQ29tcywgY29tKTtcclxuICAgIHJldHVybiBjb207XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmn6Xmib7muLLmn5PmmL7npLrnu4Tku7bvvIzmmoLml7bov5nmoLfmkJ5cclxuICogb3B0aW9ucyA6IHtcclxuICogICAgICBpc29tZXRyaWMgOiBmYWxzZSxcclxuICogICAgICBhbmdsZSA6IDE4MCxcclxuICogICAgICBzY2FsZSA6IDAuNVxyXG4gKiB9XHJcbiAqL1xyXG5mdW5jdGlvbiBHZXRSZW5kZXJDb21wb25lbnQoZW50aXR5SWQgPSAwLCBvcHRpb25zID0gbnVsbCkge1xyXG4gICAgbGV0IGNvbSA9IEdldExpc3REYXRhKHJlbmRlckNvbXMsIGVudGl0eUlkKTtcclxuICAgIHJldHVybiBjb20gPyBjb20gOiBjcmVhdGVSZW5kZXJDb21wb25lbnQoZW50aXR5SWQsIG9wdGlvbnMpO1xyXG59XHJcblxyXG4vKipcclxuICog5pi+56S65YWD5Lu2XHJcbiAqICDlkoxlbnRpdHnlhbPns7vkuI3lpKfvvIzkuIDkuKplbnRpdHnlj6/ku6Xmi6XmnInlpKfkuo7kuIDkuKpEaXNwbGF5VHVwbGVcclxuICogIOmcgOimgeiuvuiuoeacuuWItumBv+WFjea7peeUqOmXrumimFxyXG4gKi9cclxuY2xhc3MgRGlzcGxheVR1cGxlIGV4dGVuZHMgR2FtZU9iamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihzcHJpdGVGcmFtZSA9IG51bGwsIHJlbmRlckNvbSA9IG51bGwsIHJlY3RQb3NSZWwgPSBudWxsLCBvcmRlciA9IDAsIGxheWVyT3JkZXIgPSAwKXtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcclxuICAgICAgICB0aGlzLnJlbmRlckNvbSA9IHJlbmRlckNvbTtcclxuICAgICAgICB0aGlzLnJlY3RQb3NSZWwgPSByZWN0UG9zUmVsO1xyXG4gICAgICAgIHRoaXMub3JkZXIgPSBvcmRlcjtcclxuICAgICAgICB0aGlzLmxheWVyT3JkZXIgPSBsYXllck9yZGVyO1xyXG4gICAgICAgIHRoaXMuaXNvUG9zID0gTmV3UG9zKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld0Rpc3BsYXllcihlbnRpdHlJZCA9IDAsIHNwcml0ZUZyYW1lID0gbnVsbCwgb2Zmc2V0ID0gbnVsbCwgb3JkZXIgPSAwLCBsYXllck9yZGVyID0gMCl7XHJcbiAgICBsZXQgcmVuZGVyQ29tID0gR2V0UmVuZGVyQ29tcG9uZW50KGVudGl0eUlkKTtcclxuICAgIGxldCBwb3NDb20gPSBHZXRQb3NDb21wb25lbnQoZW50aXR5SWQpO1xyXG4gICAgbGV0IHJwID0gTmV3UmVjdFBvc1JlbGF0aW9uKHBvc0NvbS5wb3MsIG9mZnNldCwgTmV3UmVjdChcclxuICAgICAgICAgICAgR2V0U3ByaXRlRnJhbWVXaWR0aChzcHJpdGVGcmFtZSksIEdldFNwcml0ZUZyYW1lSGVpZ2h0KHNwcml0ZUZyYW1lKSkpO1xyXG4gICAgbGV0IGRzID0gbmV3IERpc3BsYXlUdXBsZShzcHJpdGVGcmFtZSwgcmVuZGVyQ29tLCBycCwgb3JkZXIsIGxheWVyT3JkZXIpO1xyXG4gICAgcmV0dXJuIGRzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBJc0Rpc3BsYXlJU09tZXRyaWNzKGRpc3BsYXllciA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGRpc3BsYXllci5yZW5kZXJDb20uaXNvbWV0cmljcztcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0RGlzcGxheVNwcml0ZUZyYW1lKGRpc3BsYXllciA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGRpc3BsYXllci5zcHJpdGVGcmFtZTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0RGlzcGxheUNlbnRlclBvcyhkaXNwbGF5ZXIgPSBudWxsKXtcclxuICAgIHJldHVybiBHZXRSZWFsUG9zKGRpc3BsYXllci5yZWN0UG9zUmVsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0RGlzcGxheUlzb1BvcyhkaXNwbGF5ZXIgPSBudWxsKXtcclxuICAgIHJldHVybiBkaXNwbGF5ZXIuaXNvUG9zO1xyXG59XHJcblxyXG5mdW5jdGlvbiBVcGRhdGVJc29Qb3MoZGlzcGxheWVyID0gbnVsbCl7XHJcbiAgICBsZXQgcG9zID0gR2V0UG9zKGRpc3BsYXlUdXBsZS5yZWN0UG9zUmVsKTtcclxuICAgIGxldCBvZmZzZXQgPSBHZXRPZmZzZXQoZGlzcGxheVR1cGxlLnJlY3RQb3NSZWwpO1xyXG4gICAgVXBkYXRlUG9zKGRpc3BsYXllci5pc29Qb3MsXHJcbiAgICAgICAgKHBvcy54IC0gcG9zLnkpICogMC41ICsgb2Zmc2V0LngsXHJcbiAgICAgICAgKHBvcy54ICsgcG9zLnkpICogMC41ICsgb2Zmc2V0LnkpO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgR2V0UmVuZGVyQ29tcG9uZW50LCBOZXdEaXNwbGF5ZXIsIFxyXG4gICAgSXNEaXNwbGF5SVNPbWV0cmljcywgR2V0RGlzcGxheVNwcml0ZUZyYW1lLCBHZXREaXNwbGF5Q2VudGVyUG9zLFxyXG4gICAgR2V0RGlzcGxheUlzb1BvcywgVXBkYXRlSXNvUG9zXHJcbn0iLCJpbXBvcnQgeyBEcmF3RnJhbWUsIENsZWFyIH0gZnJvbSBcIi4uLy4uL2RpcmVjdG9yL3JlbmRlclwiO1xyXG5pbXBvcnQgeyBTeXN0ZW0gfSBmcm9tIFwiLi4vLi4vZm91bmRhdGlvbi9jb21wb25lbnQvZWNzXCI7XHJcbmltcG9ydCB7IEl0ZXJhdG9yTGF5ZXJzIH0gZnJvbSBcIi4vY29tcG9uZW50L2xheWVyXCI7XHJcbmltcG9ydCB7IEdldERpc3BsYXlJc29Qb3MsIEdldERpc3BsYXlTcHJpdGVGcmFtZSwgR2V0RGlzcGxheUNlbnRlclBvcywgVXBkYXRlSXNvUG9zIH0gZnJvbSBcIi4vY29tcG9uZW50L3JlbmRlclwiO1xyXG5cclxuLyoqXHJcbiAqIOa4suafk+ezu+e7n++8jOmAu+i+keatpemqpO+8mlxyXG4gKiAxLiAgIOa4hemZpOeUu+W4g1xyXG4gKiAyLiAgIOmHjeWumuS9jeaRhOWDj+aculxyXG4gKiAzLiAgIOiuoeeul+WNleS9jeaYvuekuuefqeW9ouaYr+WQpuWcqOaRhOWDj+acuuefqeW9ouWGhVxyXG4gKiA0LiAgIOi9rOaNouS4uueUu+W4g+WdkOagh1xyXG4gKiA1LiAgIOeUu+WHuuWbvuWDj1xyXG4gKi9cclxuY2xhc3MgUmVuZGVyVXBkYXRlU3lzdGVtIGV4dGVuZHMgU3lzdGVtIHtcclxuICAgIG9uVXBkYXRlKGR0ID0gMCl7XHJcbiAgICAgICAgQ2xlYXIoKTtcclxuICAgICAgICBMaW5rSXRlcmF0b3IoR2V0RGlzcGxheUxpc3QoKSwgZGlzcGxheVR1cGxlID0+IHtcclxuICAgICAgICAgICAgbGV0IHBvcyA9IEdldFBvcyhkaXNwbGF5VHVwbGUuZW50aXR5SWQpO1xyXG4gICAgICAgICAgICBVcGRhdGVSZWN0UG9zQnlVbml0KGRpc3BsYXlUdXBsZS5kaXNwbGF5QXJlYSwgcG9zLngsIHBvcy55KTtcclxuICAgICAgICAgICAgRHJhd0ZyYW1lKGRpc3BsYXlUdXBsZS5zcHJpdGVGcmFtZSwgZGlzcGxheVR1cGxlLnBvcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIExheWVyUmVuZGVyVXBkYXRlU3lzdGVtIGV4dGVuZHMgU3lzdGVtIHtcclxuICAgIG9uVXBkYXRlKGR0ID0gMCl7XHJcbiAgICAgICAgQ2xlYXIoKTtcclxuICAgICAgICBJdGVyYXRvckxheWVycyhkaXNwbGF5VHVwbGUgPT4ge1xyXG4gICAgICAgICAgICBpZihJc0Rpc3BsYXlJU09tZXRyaWNzKGRpc3BsYXlUdXBsZSkpe1xyXG4gICAgICAgICAgICAgICAgZHJhd0lzbyhjYW1lcmEsIGRpc3BsYXlUdXBsZSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgZHJhdyhjYW1lcmEsIGRpc3BsYXlUdXBsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0lzbyhkaXNwbGF5VHVwbGUgPSBudWxsKXtcclxuICAgIFVwZGF0ZUlzb1BvcyhkaXNwbGF5VHVwbGUpO1xyXG4gICAgRHJhd0ZyYW1lKFxyXG4gICAgICAgIEdldERpc3BsYXlJc29Qb3MoZGlzcGxheVR1cGxlKSxcclxuICAgICAgICBHZXREaXNwbGF5U3ByaXRlRnJhbWUoZGlzcGxheVR1cGxlKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXcoZGlzcGxheVR1cGxlID0gbnVsbCl7XHJcbiAgICBEcmF3RnJhbWUoXHJcbiAgICAgICAgR2V0RGlzcGxheUNlbnRlclBvcyhkaXNwbGF5VHVwbGUpLFxyXG4gICAgICAgIEdldERpc3BsYXlTcHJpdGVGcmFtZShkaXNwbGF5VHVwbGUpKTtcclxufVxyXG5cclxudmFyIHJlbmRlclN5cyA9IG51bGw7XHJcbmZ1bmN0aW9uIEdldFJlbmRlclVwZGF0ZVN5c3RlbSgpe1xyXG4gICAgaWYoIXJlbmRlclN5cyl7XHJcbiAgICAgICAgcmVuZGVyU3lzID0gbmV3IExheWVyUmVuZGVyVXBkYXRlU3lzdGVtKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVuZGVyU3lzO1xyXG59XHJcblxyXG5leHBvcnQge0dldFJlbmRlclVwZGF0ZVN5c3RlbX0iLCJpbXBvcnQgeyBHZXRFbmdpbmUgfSBmcm9tIFwiLi4vcmVzb3VyY2VcIjtcclxuaW1wb3J0IHsgTGlzdEl0ZXJhdG9yIH0gZnJvbSBcIi4uLy4uL2ZvdW5kYXRpb24vY29udGFpbmVyL2xpc3RcIjtcclxuaW1wb3J0IHsgTmV3TGluayB9IGZyb20gXCIuLi8uLi9saWIvbGlzdC9saW5rbGlzdFwiO1xyXG5pbXBvcnQgeyBFbmdpbmVTdGFydCB9IGZyb20gXCIuLi8uLi9saWIvZW5naW5lL2Jhc2VcIjtcclxuaW1wb3J0IHsgR2V0UmVuZGVyVXBkYXRlU3lzdGVtIH0gZnJvbSBcIi4uLy4uL2xpYi92aWV3L3N5c3RlbVwiO1xyXG5cclxuLyoqXHJcbiAqIOS4u+ezu+e7n+WIl+ihqFxyXG4gKi9cclxudmFyIGxvZ2ljU3lzdGVtcyA9IE5ld0xpbmsoKTtcclxudmFyIHJlbmRlclN5c3RlbSA9IG51bGw7XHJcbmZ1bmN0aW9uIGluaXRTeXN0ZW1zKGRlYnVnID0gZmFsc2Upe1xyXG4gICAgLy9JbnNlcnRUb0xpbmsobG9naWNTeXN0ZW1zLCBHZXRBY3Rpb25TeXN0ZW0oKSk7XHJcbiAgICAvL0luc2VydFRvTGluayhsb2dpY1N5c3RlbXMsIEdldFBvc1VwZGF0ZVN5c3RlbSgpKTtcclxuICAgIHJlbmRlclN5c3RlbSA9IEdldFJlbmRlclVwZGF0ZVN5c3RlbSgpO1xyXG59XHJcblxyXG52YXIgbG9naWNUaWNrID0gMTY7ICAgICAvLzYwZnBzXHJcbnZhciByZW5kZXJUaWNrID0gNDE7ICAgIC8vMjRmcHNcclxudmFyIF90MSA9IDA7XHJcbnZhciBfdDIgPSAwO1xyXG5mdW5jdGlvbiBydW5XaXRoU2NlbmUoc2NlbmUgPSBudWxsKXtcclxuICAgIExpc3RJdGVyYXRvcihsb2dpY1N5c3RlbXMsIHN5c3RlbSA9PiB7XHJcbiAgICAgICAgc3lzdGVtLm9uU3RhcnQoKTtcclxuICAgIH0pO1xyXG4gICAgcmVuZGVyU3lzdGVtLm9uU3RhcnQoKTtcclxuICAgIHNjZW5lLm9uU3RhcnQoKTtcclxuXHJcbiAgICAvL21haW4gbG9vcFxyXG4gICAgRW5naW5lU3RhcnQoR2V0RW5naW5lKCksIGR0ID0+IHtcclxuICAgICAgICBfdDEgKz0gZHQ7XHJcbiAgICAgICAgaWYoX3QxID49IGxvZ2ljVGljayl7XHJcbiAgICAgICAgICAgIF90MSAtPSBsb2dpY1RpY2s7XHJcbiAgICAgICAgICAgIHNjZW5lLm9uVXBkYXRlKGR0KTtcclxuICAgICAgICAgICAgTGlzdEl0ZXJhdG9yKGxvZ2ljU3lzdGVtcywgc3lzdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIHN5c3RlbS5vblVwZGF0ZShkdCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX3QyICs9IGR0O1xyXG4gICAgICAgIGlmKF90MiA+PSByZW5kZXJUaWNrKXtcclxuICAgICAgICAgICAgX3QyIC09IHJlbmRlclRpY2s7XHJcbiAgICAgICAgICAgIHJlbmRlclN5c3RlbS5vblVwZGF0ZShkdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFN5c3RlbShzeXN0ZW0gPSBudWxsKXtcclxuICAgIGlmKCFzeXN0ZW0pe1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIEluc2VydFRvTGluayhsb2dpY1N5c3RlbXMsIHN5c3RlbSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0b3BTeXN0ZW0oKXtcclxuICAgIExpc3RJdGVyYXRvcihsb2dpY1N5c3RlbXMsIHN5c3RlbSA9PiB7XHJcbiAgICAgICAgc3lzdGVtLm9uRW5kKCk7XHJcbiAgICB9KTtcclxuICAgIHJlbmRlclN5c3RlbS5vbkVuZCgpO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgaW5pdFN5c3RlbXMsIHJ1bldpdGhTY2VuZSwgYWRkU3lzdGVtLCBzdG9wU3lzdGVtXHJcbn0iLCJcclxuIC8qKlxyXG4gICogZ3JpZG1hcOeahOe9keagvOWNleWFg1xyXG4gICovXHJcbiBjbGFzcyBCYXNlR3JpZCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih3aWR0aCA9IDAsIGhlaWdodCA9IDAsIGRhdGEgPSBudWxsKXtcclxuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsgICAgICAgLy/lrZjlgqjnmoTlr7nosaFcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOe9keagvOihqOaYr+S4quWfuuehgOS6jOWFg+WuueWZqO+8jOW6lOW9kuexu+S4uuWFg+aVsOaNrlxyXG4gKiByb3dzID0g6KGM5pWwXHJcbiAqIGNvbHVtbnMgPSDliJfmlbBcclxuICogZ3JpZFdpZHRoLCBncmlkSGVpZ2h0ID0g5q+P5Liq572R5qC855qE5a696auY6IyD5Zu077yM5bu66K6uMToxXHJcbiAqIFxyXG4gKi9cclxuY2xhc3MgQWJzdHJhY3RHcmlkTWFwIHtcclxuICAgIGdldERhdGEocG9zID0gbnVsbCl7fVxyXG4gICAgc2V0RGF0YShwb3MgPSBudWxsLCBkYXRhID0gbnVsbCl7fVxyXG4gICAgZ2V0R3JpZChwb3MgPSBudWxsKXt9XHJcbiAgICBnZXRHcmlkTWFwV2lkdGgoKXt9XHJcbiAgICBnZXRHcmlkTWFwSGVpZ2h0KCl7fVxyXG4gICAgaXRlcmF0b3IoY2FsbGJhY2sgPSBudWxsKXt9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldEdyaWREYXRhKGdyaWRtYXAgPSBudWxsLCBwb3MgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkbWFwLmdldERhdGEocG9zKTtcclxufVxyXG5mdW5jdGlvbiBTZXRHcmlkRGF0YShncmlkbWFwID0gbnVsbCwgcG9zID0gbnVsbCwgZGF0YSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGdyaWRtYXAuc2V0RGF0YShwb3MsIGRhdGEpO1xyXG59XHJcbmZ1bmN0aW9uIEdldEdyaWQoZ3JpZG1hcCA9IG51bGwsIHBvcyA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGdyaWRtYXAuZ2V0R3JpZChwb3MpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIOWfuuehgOWxnuaAp++8muWuveW6plxyXG4gKi9cclxuZnVuY3Rpb24gR2V0R3JpZFdpZHRoKGdyaWQgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkLndpZHRoO1xyXG59XHJcbmZ1bmN0aW9uIEdldEhhbGZHcmlkV2lkdGgoZ3JpZCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIEdldEdyaWRXaWR0aChncmlkKSAqIDAuNTtcclxufVxyXG5mdW5jdGlvbiBHZXRHcmlkTWFwV2lkdGgoZ3JpZG1hcCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIGdyaWRtYXAuZ2V0R3JpZE1hcFdpZHRoKCk7XHJcbn1cclxuZnVuY3Rpb24gR2V0SGFsZkdyaWRNYXBXaWR0aChncmlkbWFwID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0R3JpZE1hcFdpZHRoKGdyaWRtYXApICogMC41O1xyXG59XHJcblxyXG4vKipcclxuICog5Z+656GA5bGe5oCn77ya6auY5bqmXHJcbiAqL1xyXG5mdW5jdGlvbiBHZXRHcmlkSGVpZ2h0KGdyaWQgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkLmhlaWdodDtcclxufVxyXG5mdW5jdGlvbiBHZXRIYWxmR3JpZEhlaWdodChncmlkID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0R3JpZEhlaWdodChncmlkKSAqIDAuNTtcclxufVxyXG5mdW5jdGlvbiBHZXRHcmlkTWFwSGVpZ2h0KGdyaWRtYXAgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkbWFwLmdldEdyaWRNYXBIZWlnaHQoKTtcclxufVxyXG5mdW5jdGlvbiBHZXRIYWxmR3JpZE1hcEhlaWdodChncmlkbWFwID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0R3JpZE1hcEhlaWdodChncmlkbWFwKSAqIDAuNTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOmBjeWOhlxyXG4gKiBAcGFyYW0geyp9IGdyaWRtYXAgXHJcbiAqIEBwYXJhbSB7Kn0gY2FsbGJhY2sgXHJcbiAqL1xyXG5mdW5jdGlvbiBHcmlkTWFwSXRlcmF0b3IoZ3JpZG1hcCA9IG51bGwsIGNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICBncmlkbWFwLml0ZXJhdG9yKGNhbGxiYWNrKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIEJhc2VHcmlkLCBBYnN0cmFjdEdyaWRNYXAsIEdldEdyaWREYXRhLCBTZXRHcmlkRGF0YSwgR2V0R3JpZCxcclxuICAgIEdldEdyaWRXaWR0aCwgR2V0SGFsZkdyaWRXaWR0aCwgR2V0R3JpZE1hcFdpZHRoLCBHZXRIYWxmR3JpZE1hcFdpZHRoLFxyXG4gICAgR2V0R3JpZEhlaWdodCwgR2V0SGFsZkdyaWRIZWlnaHQsIEdldEdyaWRNYXBIZWlnaHQsIEdldEhhbGZHcmlkTWFwSGVpZ2h0LFxyXG4gICAgR3JpZE1hcEl0ZXJhdG9yXHJcbn0iLCJpbXBvcnQgeyBOZXdQb3MsIFRvTG9jYXRlUG9zIH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vc3RydWN0dXJlL2dlb21ldHJpY1wiO1xyXG5pbXBvcnQgeyBHZXRJbnQgfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvbWF0aFwiO1xyXG5pbXBvcnQgeyBHZXRIYWxmR3JpZE1hcFdpZHRoLCBHZXRIYWxmR3JpZE1hcEhlaWdodCwgR2V0R3JpZFdpZHRoLCBHZXRHcmlkSGVpZ2h0LCBCYXNlR3JpZCwgQWJzdHJhY3RHcmlkTWFwIH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vY29udGFpbmVyL2dyaWRtYXBcIjtcclxuXHJcbi8qKlxyXG4gICogZ3JpZG1hcOeahOe9keagvOWNleWFg1xyXG4gICovXHJcbiBjbGFzcyBUaWxlR3JpZCBleHRlbmRzIEJhc2VHcmlkIHtcclxuICAgIGNvbnN0cnVjdG9yKHdpZHRoID0gMCwgaGVpZ2h0ID0gMCwgcm93SW5kZXggPSAwLCBjb2xJbmRleCA9IDAsIGRhdGEgPSBudWxsKXtcclxuICAgICAgICBzdXBlcih3aWR0aCwgaGVpZ2h0LCBkYXRhKTtcclxuICAgICAgICB0aGlzLnJvd0luZGV4ID0gcm93SW5kZXg7XHJcbiAgICAgICAgdGhpcy5jb2xJbmRleCA9IGNvbEluZGV4O1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogMmTnk7fnoJblnLDlm77vvIznlLFHcmlkTWFw5omp5bGVXHJcbiAqIHNhbXBsZTpcclxuICogW1xyXG5cdDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIFxyXG5cdDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIFxyXG5cdDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsIDEsIDEsIFxyXG5cdDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsXHJcblx0MSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgXHJcblx0MSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgXHJcbl1cclxuICovXHJcbmNsYXNzIFRpbGVNYXAgZXh0ZW5kcyBBYnN0cmFjdEdyaWRNYXAge1xyXG4gICAgY29uc3RydWN0b3IocG9zID0gbnVsbCwgcm93cyA9IDAsIGNvbHVtbnMgPSAwLCBncmlkV2lkdGggPSAwLCBncmlkSGVpZ2h0ID0gMCwgZ3JpZHMgPSBudWxsKXtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMucG9zID0gcG9zO1xyXG4gICAgICAgIHRoaXMucm93cyA9IHJvd3M7XHJcbiAgICAgICAgdGhpcy5jb2x1bW5zID0gY29sdW1ucztcclxuICAgICAgICB0aGlzLmdyaWRXaWR0aCA9IGdyaWRXaWR0aDtcclxuICAgICAgICB0aGlzLmdyaWRIZWlnaHQgPSBncmlkSGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuZ3JpZHMgPSBncmlkcztcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRhKHBvcyA9IG51bGwpe1xyXG4gICAgICAgIGxldCBncmlkID0gZ2V0R3JpZFdpdGhQb3MocG9zLCB0aGlzKTtcclxuICAgICAgICByZXR1cm4gZ3JpZCA/IGdyaWQuZGF0YSA6IG51bGw7XHJcbiAgICB9XHJcbiAgICBzZXREYXRhKHBvcyA9IG51bGwsIGRhdGEgPSBudWxsKXtcclxuICAgICAgICBsZXQgZ3JpZCA9IGdldEdyaWRXaXRoUG9zKHBvcywgdGhpcyk7XHJcbiAgICAgICAgaWYoZ3JpZCl7XHJcbiAgICAgICAgICAgIGdyaWQuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0R3JpZChwb3MgPSBudWxsKXtcclxuICAgICAgICByZXR1cm4gZ2V0R3JpZFdpdGhQb3MocG9zLCB0aGlzKTtcclxuICAgIH1cclxuICAgIGdldEdyaWRNYXBXaWR0aCgpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbHVtbnMgKiB0aGlzLmdyaWRXaWR0aDtcclxuICAgIH1cclxuICAgIGdldEdyaWRNYXBIZWlnaHQoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5yb3dzICogdGhpcy5ncmlkSGVpZ2h0O1xyXG4gICAgfVxyXG4gICAgaXRlcmF0b3IoY2FsbGJhY2sgPSBudWxsKXtcclxuICAgICAgICB0aGlzLmdyaWRzLmZvckVhY2goZ3JpZCA9PiB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGdyaWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBOZXdUaWxlTWFwKHJvd3MgPSAwLCBjb2x1bW5zID0gMCwgZ3JpZFdpZHRoID0gMCwgZ3JpZEhlaWdodCA9IDAsIHBvcyA9IG51bGwpe1xyXG4gICAgbGV0IGdyaWRzID0gW107XHJcbiAgICBmb3IgKGxldCByb3dJbmRleCA9IDA7IHJvd0luZGV4IDwgcm93czsgcm93SW5kZXgrKykge1xyXG4gICAgICAgIGZvciAobGV0IGNvbEluZGV4ID0gMDsgY29sSW5kZXggPCBjb2x1bW5zOyBjb2xJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGdyaWRzLnB1c2gobmV3IFRpbGVHcmlkKGdyaWRXaWR0aCwgZ3JpZEhlaWdodCwgcm93SW5kZXgsIGNvbEluZGV4KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcG9zID0gcG9zID8gcG9zIDogTmV3UG9zKCk7XHJcbiAgICByZXR1cm4gbmV3IFRpbGVNYXAocG9zLCByb3dzLCBjb2x1bW5zLCBncmlkV2lkdGgsIGdyaWRIZWlnaHQsIGdyaWRzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tJbih4ID0gMCwgeSA9IDAsIHRpbGVtYXAgPSBudWxsKXtcclxuICAgIHJldHVybiB4ID4gMCAmJiB4IDwgdGlsZW1hcC5nZXRHcmlkTWFwV2lkdGgoKSAmJiB5ID4gMCAmJiB5IDwgdGlsZW1hcC5nZXRHcmlkTWFwSGVpZ2h0KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEdyaWRXaXRoUG9zKHBvcyA9IG51bGwsIHRpbGVtYXAgPSBudWxsKXtcclxuICAgIGxldCB0UG9zID0gVG9Mb2NhdGVQb3MocG9zLCB0aWxlbWFwLnBvcyk7XHJcbiAgICBpZighY2hlY2tJbih0UG9zLngsIHRQb3MueSwgdGlsZW1hcCkpe1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgbGV0IGNvbHVtbiA9IEdldEludCh0UG9zLnggLyBncmlkbWFwLmdyaWRXaWR0aCk7XHJcbiAgICBsZXQgcm93ID0gR2V0SW50KHRQb3MueSAvIGdyaWRtYXAuZ3JpZEhlaWdodCk7XHJcbiAgICByZXR1cm4gZ3JpZG1hcC5ncmlkc1tyb3cgKiBncmlkbWFwLmNvbHVtbnMgKyBjb2x1bW5dO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIOWfuuehgOWdkOagh1xyXG4gKiBAcGFyYW0geyp9IHRpbGVtYXAgXHJcbiAqL1xyXG5mdW5jdGlvbiBHZXRUaWxlbWFwU3RhcnQodGlsZW1hcCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIE5ld1BvcyhcclxuICAgICAgICB0aWxlbWFwLnBvcy54IC0gR2V0SGFsZkdyaWRNYXBXaWR0aCh0aWxlbWFwKSxcclxuICAgICAgICB0aWxlbWFwLnBvcy55IC0gR2V0SGFsZkdyaWRNYXBIZWlnaHQodGlsZW1hcClcclxuICAgICk7XHJcbn1cclxuZnVuY3Rpb24gR2V0VGlsZW1hcEVuZCh0aWxlbWFwID0gbnVsbCl7XHJcbiAgICByZXR1cm4gTmV3UG9zKFxyXG4gICAgICAgIHRpbGVtYXAucG9zLnggKyBHZXRIYWxmR3JpZE1hcFdpZHRoKHRpbGVtYXApLFxyXG4gICAgICAgIHRpbGVtYXAucG9zLnkgKyBHZXRIYWxmR3JpZE1hcEhlaWdodCh0aWxlbWFwKVxyXG4gICAgKTtcclxufVxyXG5mdW5jdGlvbiBHZXRUaWxlbWFwQ2VudGVyKHRpbGVtYXAgPSBudWxsKXtcclxuICAgIHJldHVybiBOZXdQb3ModGlsZW1hcC5wb3MueCwgdGlsZW1hcC5wb3MueSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFRpbGVHcmlkU3RhcnQodGlsZW1hcCA9IG51bGwsIGdyaWQgPSBudWxsKXtcclxuICAgIGxldCBzdGFydCA9IEdldFRpbGVtYXBTdGFydCh0aWxlbWFwKTtcclxuICAgIHJldHVybiBOZXdQb3MoXHJcbiAgICAgICAgc3RhcnQueCArIEdldEdyaWRXaWR0aCh0aWxlbWFwLmdyaWRtYXApICogZ3JpZC5jb2xJbmRleCxcclxuICAgICAgICBzdGFydC55ICsgR2V0R3JpZEhlaWdodCh0aWxlbWFwLmdyaWRtYXApICogZ3JpZC5yb3dJbmRleFxyXG4gICAgKTtcclxufVxyXG5mdW5jdGlvbiBHZXRUaWxlR3JpZEVuZCh0aWxlbWFwID0gbnVsbCwgZ3JpZCA9IG51bGwpe1xyXG4gICAgbGV0IHN0YXJ0ID0gR2V0VGlsZW1hcFN0YXJ0KHRpbGVtYXApO1xyXG4gICAgcmV0dXJuIE5ld1BvcyhcclxuICAgICAgICBzdGFydC54ICsgdGlsZW1hcC5ncmlkV2lkdGggKiAoZ3JpZC5jb2xJbmRleCArIDEpLFxyXG4gICAgICAgIHN0YXJ0LnkgKyB0aWxlbWFwLmdyaWRIZWlnaHQgKiAoZ3JpZC5yb3dJbmRleCArIDEpXHJcbiAgICApO1xyXG59XHJcbmZ1bmN0aW9uIEdldFRpbGVHcmlkQ2VudGVyKHRpbGVtYXAgPSBudWxsLCBncmlkID0gbnVsbCl7XHJcbiAgICBsZXQgc3RhcnQgPSBHZXRUaWxlbWFwU3RhcnQodGlsZW1hcCk7XHJcbiAgICByZXR1cm4gTmV3UG9zKFxyXG4gICAgICAgIHN0YXJ0LnggKyB0aWxlbWFwLmdyaWRXaWR0aCAqIChncmlkLmNvbEluZGV4ICsgMC41KSxcclxuICAgICAgICBzdGFydC55ICsgdGlsZW1hcC5ncmlkSGVpZ2h0ICogKGdyaWQucm93SW5kZXggKyAwLjUpXHJcbiAgICApO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgTmV3VGlsZU1hcCwgXHJcbiAgICBHZXRUaWxlbWFwU3RhcnQsIEdldFRpbGVtYXBFbmQsIEdldFRpbGVtYXBDZW50ZXIsIFxyXG4gICAgR2V0VGlsZUdyaWRTdGFydCwgR2V0VGlsZUdyaWRFbmQsIEdldFRpbGVHcmlkQ2VudGVyXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmib7lh7rkuI5yZWN055u45Lqk55qE5omA5pyJZ3JpZFxyXG4gKiBUT0RPIOacquWumu+8jOWPr+iDveS4jemcgOimgei/meenjeWBmuazlVxyXG4gKi9cclxuZnVuY3Rpb24gR2V0R3JpZHNCeVJlY3QodGlsZU1hcCA9IG51bGwsIHJlY3QgPSBudWxsKXtcclxuICAgIC8v5piv5ZCm5ZyodGlsZW1hcOS4rVxyXG4gICAgaWYoIUlzUmVjdENyb3NzKHRpbGVNYXAucmVjdCwgcmVjdCkpe1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgbGV0IGdyaWRzID0gW107XHJcbiAgICBsZXQgcG9zU3RhcnQgPSByZWN0LnBvc1N0YXJ0O1xyXG4gICAgbGV0IGNvbHVtblN0YXJ0ID0gcGFyc2VJbnQocG9zU3RhcnQueCAvIHRpbGVNYXAuZ3JpZFdpZHRoKTtcclxuICAgIGxldCByb3dTdGFydCA9IHBhcnNlSW50KHBvc1N0YXJ0LnkgLyB0aWxlTWFwLmdyaWRIZWlnaHQpO1xyXG4gICAgY29sdW1uU3RhcnQgPSBjb2x1bW5TdGFydCA8IDAgPyAwIDogY29sdW1uU3RhcnQ7XHJcbiAgICByb3dTdGFydCA9IHJvd1N0YXJ0IDwgMCA/IDAgOiByb3dTdGFydDtcclxuXHJcbiAgICBsZXQgcG9zRW5kID0gcmVjdC5wb3NFbmQ7XHJcbiAgICBsZXQgY29sdW1uRW5kID0gcGFyc2VJbnQocG9zRW5kLnggLyB0aWxlTWFwLmdyaWRXaWR0aCk7XHJcbiAgICBsZXQgcm93RW5kID0gcGFyc2VJbnQocG9zRW5kLnkgLyB0aWxlTWFwLmdyaWRIZWlnaHQpO1xyXG4gICAgY29sdW1uRW5kID0gY29sdW1uRW5kID4gdGlsZU1hcC5jb2x1bW5zIC0gMSA/IHRpbGVNYXAuY29sdW1ucyAtIDEgOiBjb2x1bW5FbmQ7XHJcbiAgICByb3dFbmQgPSByb3dFbmQgPiB0aWxlTWFwLnJvd3MgLSAxID8gdGlsZU1hcC5yb3dzIC0gMSA6IHJvd0VuZDtcclxuXHJcbiAgICBmb3IobGV0IHJvdz1yb3dTdGFydDsgcm93PD1yb3dFbmQ7IHJvdysrKXtcclxuICAgICAgICBmb3IobGV0IGNvbHVtbj1jb2x1bW5TdGFydDsgY29sdW1uPD1jb2x1bW5FbmQ7IGNvbHVtbisrKXtcclxuICAgICAgICAgICAgZ3JpZHMucHVzaCh0aWxlTWFwLmdyaWRzW3Jvd11bY29sdW1uXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGdyaWRzO1xyXG59IiwiaW1wb3J0IHsgR3JpZE1hcEl0ZXJhdG9yIH0gZnJvbSBcIi4uLy4uL2ZvdW5kYXRpb24vY29udGFpbmVyL2dyaWRtYXBcIjtcclxuaW1wb3J0IHsgR2V0SW50IH0gZnJvbSBcIi4uLy4uL2ZvdW5kYXRpb24vc3RydWN0dXJlL21hdGhcIjtcclxuaW1wb3J0IHsgTmV3VGlsZU1hcCB9IGZyb20gXCIuL3RpbGVtYXAvYmFzZVwiO1xyXG5pbXBvcnQgeyBOZXdQb3MgfSBmcm9tIFwiLi4vLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZ2VvbWV0cmljXCI7XHJcbmltcG9ydCB7IEdldERlZiB9IGZyb20gXCIuLi8uLi9kaXJlY3Rvci9yZXNvdXJjZVwiO1xyXG5cclxuLyoqXHJcbiAqIHRpbGVtYXAgPSBncmlkbWFwICsgcG9zXHJcbiAqIGdyaWRtYXDnmoTnm7jlr7nlnZDmoIfmmK8oMCwgMCnvvIzljbPlt6bkuIrop5JcclxuICogdGlsZW1hcC5wb3Plkozlhbbku5blr7nosaHkuIDmoLfvvIzku47kuK3pl7TlvIDlp4tcclxuICogZ3JpZFBvc+aYr2dyaWTnn6nlvaLkuK3pl7RcclxuICog5L6L5aaC77yadGlsZW1hcC5wb3MueCA9IDIwLCBncmlkV2lkdGggPSA1MCwgY29sdW1uID0gNTtcclxuICog6YKj5LmIZ3JpZFswXeeahHBvcy54PSAyMCArIDAqNTAgKyA1MC8yID0gNDUsIHBvc1N0YXJ0LnggPSA0NSAtIDUwLzIgPSAyMFxyXG4gKiDlkIznkIZncmlkWzRd55qEcG9zLng9IDIwICsgNCo1MCArIDUwLzIgPSAyNDUsIHBvc1N0YXJ0LnggPSAyNDUgLSA1MC8yID0gMjIwXHJcbiAqIFxyXG4gKiBvcHRpb25zOntcclxuICogICAgICBkYXRhIDogWyAgICAgICAgICAgICAgICDkuIDnu7TmlbDnu4RcclxuICogICAgICAgICAgMSwgMSwgMSwgMCwgMCwgMSxcclxuICogICAgICAgICAgMiwgMSwgMCwgMCwgMSwgMixcclxuICogICAgICAgICAgMiwgMiwgMSwgMSwgMSwgMVxyXG4gKiAgICAgICAgICBdXHJcbiAqICAgICAgY29sdW1ucyA6IDYgICAgIOWIl+aVsFxyXG4gKiAgICAgIGdyaWQtd2lkdGggOiAzMlxyXG4gKiAgICAgIGdyaWRpaGVpZ2h0IDogMzIgICAgIOavj+S4quagvOWtkOeahOWuvemrmFxyXG4gKiAgICAgIHggOiAwXHJcbiAqICAgICAgeSA6IDAgICAgICAgICAgIOWIneWni+S9jee9ru+8jOm7mOiupOS4unN0YWdl5Lit5b+D77yM5Y2zKDAsIDApXHJcbiAqICAgICAgb25DcmVhdGUgOiBmdW5jXHJcbiAqIH1cclxuICovXHJcbmZ1bmN0aW9uIENyZWF0ZVRpbGVNYXBXaXRoRGF0YShvcHRpb25zID0gbnVsbCwgb25DcmVhdGUgPSBudWxsKXtcclxuICAgIC8v6buY6K6k5YC8XHJcbiAgICBkZWZhdWx0VGlsZU1hcERhdGEob3B0aW9ucyk7XHJcbiAgICBcclxuICAgIC8v6aqM6K+BdGlsZW1hcOaVsOaNruWujOaVtOaAp1xyXG4gICAgbGV0IGNvbHVtbnMgPSBvcHRpb25zLmNvbHVtbnM7XHJcbiAgICBsZXQgcm93cyA9IEdldEludChvcHRpb25zLmRhdGEubGVuZ3RoIC8gY29sdW1ucyk7XHJcbiAgICBpZihyb3dzICogY29sdW1ucyAhPSBvcHRpb25zLmRhdGEubGVuZ3RoKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiZXJyb3IgcGFyYW06IGxlbihncmlkcyk6ICVkLCBjb2x1bW5zOiAlZFwiLCBvcHRpb25zLmRhdGEubGVuZ3RoLCBjb2x1bW5zKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGxldCB0aWxlbWFwID0gTmV3VGlsZU1hcChcclxuICAgICAgICByb3dzLCBjb2x1bW5zLCBvcHRpb25zLmdyaWRXaWR0aCwgb3B0aW9ucy5ncmlkSGVpZ2h0LCBOZXdQb3Mob3B0aW9ucy54LCBvcHRpb25zLnkpKTtcclxuICAgIGlmKG9uQ3JlYXRlKXtcclxuICAgICAgICBHcmlkTWFwSXRlcmF0b3IodGlsZW1hcCwgZ3JpZCA9PiB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhID0gR2V0RGVmKG9wdGlvbnMuZGF0YVtncmlkLnJvd0luZGV4ICogY29sdW1ucyArIGdyaWQuY29sSW5kZXhdKVxyXG4gICAgICAgICAgICBvbkNyZWF0ZShkYXRhLCB0aWxlbWFwLCBncmlkKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aWxlbWFwO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWZhdWx0VGlsZU1hcERhdGEob3B0aW9ucyA9IG51bGwpe1xyXG4gICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xyXG4gICAgICAgIGNvbHVtbnMgOiAxLFxyXG4gICAgICAgIGdyaWRXaWR0aCA6IDMyLFxyXG4gICAgICAgIGdyaWRIZWlnaHQgOiAzMixcclxuICAgICAgICB4IDogMCxcclxuICAgICAgICB5IDogMCxcclxuICAgICAgICBkYXRhIDogWzBdXHJcbiAgICB9LCBvcHRpb25zKTtcclxuICAgIG9wdGlvbnMuZ3JpZFdpZHRoID0gb3B0aW9ucy5ncmlkV2lkdGggPiAwID8gb3B0aW9ucy5ncmlkV2lkdGggOiAzMjtcclxuICAgIG9wdGlvbnMuZ3JpZEhlaWdodCA9IG9wdGlvbnMuZ3JpZEhlaWdodCA+IDAgPyBvcHRpb25zLmdyaWRIZWlnaHQgOiAzMjtcclxufVxyXG5cclxuZXhwb3J0e1xyXG4gICAgQ3JlYXRlVGlsZU1hcFdpdGhEYXRhXHJcbn0iLCJcclxudmFyIF9jYWxsYmFjaztcclxudmFyIF9mcmFtZU5vID0gMDtcclxudmFyIF9kdCA9IDA7XHJcbnZhciBfbGFzdCA9IDA7XHJcbnZhciBfaXNFbmQgPSBmYWxzZTtcclxuZnVuY3Rpb24gcnVuVGljayh0aW1lc3RhbXApIHtcclxuICAgIF9kdCA9IHRpbWVzdGFtcCAtIF9sYXN0O1xyXG4gICAgX2xhc3QgPSB0aW1lc3RhbXA7XHJcbiAgICBfY2FsbGJhY2soX2R0KTtcclxuICAgIGlmKCFfaXNFbmQpe1xyXG4gICAgICAgIF9mcmFtZU5vID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBkZWJ1Z1xyXG4gKi9cclxudmFyIHN0YXJ0ID0gbnVsbDtcclxudmFyIGxhc3QgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuZnVuY3Rpb24gcnVuVGljazIoZnBzID0gMCwgb25VcGRhdGVDYWxsYmFjayA9IG51bGwpIHtcclxuICAgIF9pc0VuZCA9IGZhbHNlO1xyXG4gICAgb25VcGRhdGVDYWxsYmFjaztcclxuICAgIGxldCB0aWNrID0gMTAwMCAvIGZwcztcclxuICAgIHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICBzdGFydCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGlmKCFfaXNFbmQpe1xyXG4gICAgICAgICAgICBvblVwZGF0ZUNhbGxiYWNrKHN0YXJ0IC0gbGFzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxhc3QgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgIH0sIHRpY2spO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wKCl7XHJcbiAgICBfaXNFbmQgPSB0cnVlO1xyXG59XHJcblxyXG5cclxuLy/lm6DkuLrmjInkvY/plK7nmoTor53vvIzkvJrkuI3mlq3op6blj5FvbktleWRvd27vvIzmiYDku6XlgZrkuKptYXDliKTmlq1cclxudmFyIF9rZXlEb3duTWFwID0gbmV3IE1hcCgpO1xyXG5mdW5jdGlvbiBjYW52YXNPbktleUNhbGxiYWNrKGtleURvd25DYWxsYmFjayA9IG51bGwsIGtleVVwQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBlID0+IHtcclxuICAgICAgICBsZXQgY29kZSA9IGUua2V5Q29kZTtcclxuICAgICAgICBpZihfa2V5RG93bk1hcC5nZXQoY29kZSkpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9rZXlEb3duTWFwLnNldChjb2RlLCAxKTtcclxuICAgICAgICBrZXlEb3duQ2FsbGJhY2soZS5rZXlDb2RlKTtcclxuICAgIH0pO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBlID0+IHtcclxuICAgICAgICBsZXQgY29kZSA9IGUua2V5Q29kZTtcclxuICAgICAgICBfa2V5RG93bk1hcC5kZWxldGUoY29kZSk7XHJcbiAgICAgICAga2V5VXBDYWxsYmFjayhlLmtleUNvZGUpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBodHRwczovL2Jsb2cuY3Nkbi5uZXQvcXFfMTc2MTYxNjkvYXJ0aWNsZS9kZXRhaWxzLzcyODMzMDQ0XHJcbiAqL1xyXG5mdW5jdGlvbiBjYW52YXNPbk1vdXNlQ2FsbGJhY2soZW5naW5lID0gbnVsbCwgbW91c2Vkb3duQ2FsbGJhY2sgPSBudWxsLCBtb3VzZXVwQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgIGVuZ2luZS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBldmVudCA9PiB7XHJcbiAgICAgICAgbGV0IHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgbGV0IHggPSBldmVudC5jbGllbnRYIC0gcmVjdC5sZWZ0ICogKGNhbnZhcy53aWR0aCAvIHJlY3Qud2lkdGgpO1xyXG4gICAgICAgIGxldCB5ID0gZXZlbnQuY2xpZW50WSAtIHJlY3QudG9wICogKGNhbnZhcy5oZWlnaHQgLyByZWN0LmhlaWdodCk7XHJcbiAgICAgICAgbW91c2Vkb3duQ2FsbGJhY2soeCwgeSk7XHJcbiAgICB9KTtcclxuICAgIGVuZ2luZS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZXZlbnQgPT4ge1xyXG4gICAgICAgIGxldCByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIGxldCB4ID0gZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdCAqIChjYW52YXMud2lkdGggLyByZWN0LndpZHRoKTtcclxuICAgICAgICBsZXQgeSA9IGV2ZW50LmNsaWVudFkgLSByZWN0LnRvcCAqIChjYW52YXMuaGVpZ2h0IC8gcmVjdC5oZWlnaHQpO1xyXG4gICAgICAgIG1vdXNldXBDYWxsYmFjayh4LCB5KTtcclxuICAgIH0pO1xyXG4gICAgLy8gZW5naW5lLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZXZlbnQgPT4ge1xyXG4gICAgLy8gICAgIGNvbnNvbGUubG9nKGV2ZW50LngsIGV2ZW50LnkpO1xyXG4gICAgLy8gfSk7XHJcbiAgICAvL2VuZ2luZS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLGRvTW91c2VNb3ZlLGZhbHNlKTtcclxuICAgIC8vZW5naW5lLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIixkb01vdXNlT3V0LGZhbHNlKTtcclxufVxyXG5cclxuZXhwb3J0e1xyXG4gICAgcnVuVGljazIsIHN0b3AsIGNhbnZhc09uS2V5Q2FsbGJhY2ssIGNhbnZhc09uTW91c2VDYWxsYmFja1xyXG59IiwiaW1wb3J0IHsgcnVuVGljazIsIGNhbnZhc09uS2V5Q2FsbGJhY2ssIGNhbnZhc09uTW91c2VDYWxsYmFjayB9IGZyb20gXCIuL3Byb2Nlc3NvclwiO1xyXG5pbXBvcnQgeyBHZXRTcHJpdGVGcmFtZUJpdG1hcERhdGEsIEdldFNwcml0ZUZyYW1lU3RhcnRYLCBHZXRTcHJpdGVGcmFtZVN0YXJ0WSwgR2V0U3ByaXRlRnJhbWVXaWR0aCwgR2V0U3ByaXRlRnJhbWVIZWlnaHQsIEdldFNwcml0ZUZyYW1lSGFsZldpZHRoLCBHZXRTcHJpdGVGcmFtZUhhbGZIZWlnaHQgfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZnJhbWVcIjtcclxuaW1wb3J0IHsgQWJzdHJhY3RFbmdpbmUgfSBmcm9tIFwiLi4vYmFzZVwiO1xyXG5pbXBvcnQgeyBHZXRSZWN0SGFsZldpZHRoLCBHZXRSZWN0SGFsZkhlaWdodCwgR2V0UmVjdEhlaWdodCwgR2V0UmVjdFdpZHRoIH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vc3RydWN0dXJlL2dlb21ldHJpY1wiO1xyXG5cclxuLyoqXHJcbiAqIOa1j+iniOWZqOeahGtleS1jb2RlXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgS0VZX1JJR0hUID0gMzk7XHJcbmV4cG9ydCBjb25zdCBLRVlfTEVGVCA9IDM3O1xyXG5leHBvcnQgY29uc3QgS0VZX1VQID0gMzg7XHJcbmV4cG9ydCBjb25zdCBLRVlfRE9XTiA9IDQwO1xyXG5cclxuZXhwb3J0IGNvbnN0IEtFWV9TUEFDRSA9IDMyO1xyXG5cclxuZXhwb3J0IGNvbnN0IEtFWV9XID0gODc7XHJcbmV4cG9ydCBjb25zdCBLRVlfQSA9IDY1O1xyXG5leHBvcnQgY29uc3QgS0VZX1MgPSA4MztcclxuZXhwb3J0IGNvbnN0IEtFWV9EID0gNjg7XHJcblxyXG5jbGFzcyBINUVuZ2luZSBleHRlbmRzIEFic3RyYWN0RW5naW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKGZwcyA9IDYwLCBjYW52YXMgPSBudWxsLCBjdHggPSBudWxsKXtcclxuICAgICAgICBzdXBlcihmcHMpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xyXG4gICAgICAgIHRoaXMuY3R4ID0gY3R4O1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyKCl7XHJcbiAgICAgICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYXdGcmFtZShjZW50ZXJQb3MgPSBudWxsLCBzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgICAgIC8v5Y+C6ICD77yaY29udGV4dC5kcmF3SW1hZ2UoaW1nLHN4LHN5LHN3aWR0aCxzaGVpZ2h0LHgseSx3aWR0aCxoZWlnaHQpO1xyXG4gICAgICAgIHRoaXMuY3R4LmRyYXdJbWFnZShcclxuICAgICAgICAgICAgR2V0U3ByaXRlRnJhbWVCaXRtYXBEYXRhKHNwcml0ZUZyYW1lKSxcclxuICAgICAgICAgICAgR2V0U3ByaXRlRnJhbWVTdGFydFgoc3ByaXRlRnJhbWUpLCBHZXRTcHJpdGVGcmFtZVN0YXJ0WShzcHJpdGVGcmFtZSksIEdldFNwcml0ZUZyYW1lV2lkdGgoc3ByaXRlRnJhbWUpLCBHZXRTcHJpdGVGcmFtZUhlaWdodChzcHJpdGVGcmFtZSksXHJcbiAgICAgICAgICAgIGNlbnRlclBvcy54IC0gR2V0U3ByaXRlRnJhbWVIYWxmV2lkdGgoc3ByaXRlRnJhbWUpLCBjZW50ZXJQb3MueSAtIEdldFNwcml0ZUZyYW1lSGFsZkhlaWdodChzcHJpdGVGcmFtZSksIEdldFNwcml0ZUZyYW1lV2lkdGgoc3ByaXRlRnJhbWUpLCBHZXRTcHJpdGVGcmFtZUhlaWdodChzcHJpdGVGcmFtZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYXdSZWN0KGNlbnRlclBvcyA9IG51bGwsIHJlY3QgPSBudWxsKXtcclxuICAgICAgICB0aGlzLmN0eC5zdHJva2VSZWN0KFxyXG4gICAgICAgICAgICBjZW50ZXJQb3MueCAtIEdldFJlY3RIYWxmV2lkdGgocmVjdCksIGNlbnRlclBvcy55IC0gR2V0UmVjdEhhbGZIZWlnaHQocmVjdCksXHJcbiAgICAgICAgICAgIEdldFJlY3RXaWR0aChyZWN0KSwgR2V0UmVjdEhlaWdodChyZWN0KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZHJhd0xpbmUoc3RhcnRQb3MgPSBudWxsLCBlbmRQb3MgPSBudWxsKXtcclxuICAgICAgICBsZXQgY3R4ID0gdGhpcy5jdHg7XHJcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGN0eC5tb3ZlVG8oc3RhcnRQb3MueCwgc3RhcnRQb3MueSk7XHJcbiAgICAgICAgY3R4LmxpbmVUbyhlbmRQb3MueCwgZW5kUG9zLnkpO1xyXG4gICAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBkcmF3Q2lyY2xlKGNlbnRlclBvcyA9IG51bGwsIHJhZGl1cyA9IDApe1xyXG4gICAgICAgIGxldCBjdHggPSB0aGlzLmN0eDtcclxuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgY3R4LmFyYyhjZW50ZXJQb3MueCwgY2VudGVyUG9zLnksIHJhZGl1cywgMCwgMiAqIE1hdGguUEkpO1xyXG4gICAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkUmVzb3VyY2UoaW1nU3JjID0gXCJcIiwgb25Mb2FkQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgICAgICBsZXQgaW1nID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgaW1nLnNyYyA9IGltZ1NyYztcclxuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBvbkxvYWRDYWxsYmFjayhpbWcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbktleUNhbGxiYWNrKGtleURvd25DYWxsYmFjayA9IG51bGwsIGtleVVwQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgICAgICBjYW52YXNPbktleUNhbGxiYWNrKGtleURvd25DYWxsYmFjaywga2V5VXBDYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Ub3VjaENhbGxiYWNrKHRvdWNoT25DYWxsYmFjayA9IG51bGwsIHRvdWNoT3ZlckNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICAgICAgY2FudmFzT25Nb3VzZUNhbGxiYWNrKHRoaXMsIHRvdWNoT25DYWxsYmFjaywgdG91Y2hPdmVyQ2FsbGJhY2spO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KG9uRW50ZXJGcmFtZUNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICAgICAgcnVuVGljazIodGhpcy5mcHMsIG9uRW50ZXJGcmFtZUNhbGxiYWNrKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIE5ld0g1RW5naW5lKHdpZHRoID0gMCwgaGVpZ2h0ID0gMCwgZnBzID0gMCl7XHJcbiAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIik7XHJcbiAgICBjYW52YXMud2lkdGggPSB3aWR0aDtcclxuICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICBsZXQgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgIGN0eC5zdHJva2VTdHlsZT1cIiMwMDAwZmZcIjsgICAgICAgICAgLy/nlLvnn6nlvaLmoYbnlKjnmoRcclxuICAgIHJldHVybiBuZXcgSDVFbmdpbmUoZnBzLCBjYW52YXMsIGN0eCk7XHJcbn1cclxuXHJcbmV4cG9ydHtcclxuICAgIE5ld0g1RW5naW5lXHJcbn1cclxuXHJcblxyXG5jb25zdCBSYWRpdXMgPSBNYXRoLlBJLzE4MDtcclxuZnVuY3Rpb24gRHJhd0ltYWdlV2l0aEFuZ2xlKGFuZ2xlID0gMCwgaW1nRGF0YSwgc3ggPSAwLCBzeSA9IDAsIHN3aWR0aCA9IDAsIHNoZWlnaHQgPSAwLCB4ID0gMCwgeSA9IDAsIHdpZHRoID0gMCwgaGVpZ2h0ID0gMCkge1xyXG4gICAgbGV0IGN0eCA9IF9lbmdpbmUuY3R4O1xyXG4gICAgY3R4LnNhdmUoKTtcclxuICAgIGN0eC50cmFuc2xhdGUoeCArIHdpZHRoLzIsIHkgKyBoZWlnaHQvMik7XHJcbiAgICBjdHgucm90YXRlKGFuZ2xlICogUmFkaXVzKTtcclxuICAgIERyYXdJbWFnZShpbWdEYXRhLCBzeCwgc3ksIHN3aWR0aCwgc2hlaWdodCwgLXdpZHRoLzIsIC1oZWlnaHQvMiwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICBjdHgucmVzdG9yZSgpO1xyXG5cclxuICAgIC8vIGN0eC50cmFuc2xhdGUoMTAwLCAxMDApO1xyXG5cdC8vIGN0eC5yb3RhdGUoOTAgKiBNYXRoLlBJLzE4MCk7XHQvL+S7peS4iumdoueahOWBj+enu+eCueS4uuWHhu+8jOi/m+ihjOaXi+i9rFxyXG5cdC8vIGN0eC5kcmF3SW1hZ2UoaSwgMTg3LCAwLCAxODYsIDEzMCwgLTAsIC0wLCAxMDAsIDEwMCk7XHJcbn0iLCJpbXBvcnQgeyBOZXdINUVuZ2luZSB9IGZyb20gXCIuL3dlYi9tb2RlbFwiO1xyXG5cclxuY29uc3QgRW5naW5lV2ViID0gMDtcclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0geyp9IG9wdGlvbnNcclxuICoge1xyXG4gKiAgICAgIHR5cGUgOiAwLFxyXG4gKiAgICAgIHdpZHRoIDogNDAwLFxyXG4gKiAgICAgIGhlaWdodCA6IDQwMCxcclxuICogICAgICBmcHMgOiA2MCxcclxuICogICAgICBrZXlEb3duSGFuZGxlciA6IGZ1bmMsXHJcbiAqICAgICAga2V5VXBIYW5sZXIgOiBmdW5jLFxyXG4gKiAgICAgIG1vdXNlZG93bkhhbmRsZXIgOiBmdW5jLFxyXG4gKiAgICAgIG1vdXNldXBIYW5kbGVyIDogZnVuY1xyXG4gKiB9XHJcbiAqL1xyXG5mdW5jdGlvbiBDcmVhdGVFbmdpbmVXaXRoRGF0YShvcHRpb25zID0gbnVsbCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwLCBrZXlEb3duSGFuZGxlciA9IG51bGwsIGtleVVwSGFubGVyID0gbnVsbCwgdG91Y2hPbkNhbGxiYWNrID0gbnVsbCwgdG91Y2hPdmVyQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgIC8v6buY6K6k5YC8XHJcbiAgICBvcHRpb25zID0gb3B0aW9ucyA/IG9wdGlvbnMgOiB7fTtcclxuICAgIC8vIGxldCB3aWR0aCA9IG9wdGlvbnNbJ3dpZHRoJ107XHJcbiAgICAvLyB3aWR0aCA9IHdpZHRoID8gd2lkdGggOiA0MDA7XHJcbiAgICAvLyBsZXQgaGVpZ2h0ID0gb3B0aW9uc1snaGVpZ2h0J107XHJcbiAgICAvLyBoZWlnaHQgPSBoZWlnaHQgPyBoZWlnaHQgOiA0MDA7XHJcbiAgICBsZXQgZnBzID0gb3B0aW9uc1snZnBzJ107XHJcbiAgICBmcHMgPSBmcHMgPyBmcHMgOiA2MDtcclxuICAgIGxldCB0eXBlID0gb3B0aW9uc1sndHlwZSddO1xyXG4gICAgdHlwZSA9IHR5cGUgPyB0eXBlIDogRW5naW5lV2ViO1xyXG5cclxuICAgIGxldCBlbmdpbmUgPSBudWxsO1xyXG4gICAgc3dpdGNoKHR5cGUpe1xyXG4gICAgICAgIGNhc2UgRW5naW5lV2ViOlxyXG4gICAgICAgICAgICBlbmdpbmUgPSBOZXdINUVuZ2luZSh3aWR0aCwgaGVpZ2h0LCBmcHMpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvL2Vycm9yIGxvZ1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvL+azqOWGjOaMiemUruWbnuiwg1xyXG4gICAgaWYoa2V5RG93bkhhbmRsZXIgJiYga2V5VXBIYW5sZXIpe1xyXG4gICAgICAgIGVuZ2luZS5vbktleUNhbGxiYWNrKGtleURvd25IYW5kbGVyLCBrZXlVcEhhbmxlcik7XHJcbiAgICB9XHJcbiAgICBpZih0b3VjaE9uQ2FsbGJhY2sgJiYgdG91Y2hPdmVyQ2FsbGJhY2spe1xyXG4gICAgICAgIGVuZ2luZS5vblRvdWNoQ2FsbGJhY2sodG91Y2hPbkNhbGxiYWNrLCB0b3VjaE92ZXJDYWxsYmFjayk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZW5naW5lO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgQ3JlYXRlRW5naW5lV2l0aERhdGFcclxufSIsImltcG9ydCB7IFNldERlZmF1bHRDYW1lcmEsIFNldEVuZ2luZSwgU2V0RGF0YSwgU2V0RGVmIH0gZnJvbSBcIi4uL3Jlc291cmNlXCI7XHJcbmltcG9ydCB7IENyZWF0ZUNhbWVyYVdpdGhEYXRhIH0gZnJvbSBcIi4uLy4uL2xpYi9jYW1lcmEvdXRpbHNcIjtcclxuaW1wb3J0IHsgaW5pdFN5c3RlbXMgfSBmcm9tIFwiLi9zeXN0ZW1cIjtcclxuaW1wb3J0IHsgQ3JlYXRlVGlsZU1hcFdpdGhEYXRhIH0gZnJvbSBcIi4uLy4uL2xpYi9ncmlkL3V0aWxzXCI7XHJcbmltcG9ydCB7IENyZWF0ZUVuZ2luZVdpdGhEYXRhIH0gZnJvbSBcIi4uLy4uL2xpYi9lbmdpbmUvdXRpbHNcIjtcclxuXHJcbi8qKlxyXG4gKiDpgJrov4flj4LmlbDphY3nva7liJ3lp4vljJbns7vnu5/otYTmupBcclxuICogb3B0aW9ucyB7XHJcbiAqICAgICAgZGVidWcgOiBmYWxzZSxcclxuICogICAgICBmcHMgOiA2MCxcclxuICogICAgICB0ZXh0dXJlcyA6IFtd5qC85byP6KeBTG9hZFJlc291cmNlKCnlhoVcclxuICogICAgICBzY3JlZW4td2lkdGggOiA4MDAsXHJcbiAqICAgICAgc2NyZWVuLWhlaWdodCA6IDgwMCxcclxuICogICAgICBjYW1lcmEgOiB7fSxcclxuICogICAgICBlbmdpbmUgOiB7fSxcclxuICogICAgICBsYXllcnMgOiBbXHJcbiAqICAgICAgICAgIHtcclxuICogICAgICAgICAgICAgIHR5cGUgOiAxIOagvOW8j+WPguiAg3RpbGVtYXDkuIDoioJcclxuICogICAgICAgICAgfVxyXG4gKiAgICAgIF1cclxuICogICAgICBjb2xsaWRlIDoge31cclxuICogfVxyXG4gKi9cclxuZnVuY3Rpb24gaW5pdEdhbWUob3B0aW9ucyA9IG51bGwpIHtcclxuICAgIC8v6buY6K6k5YC8XHJcbiAgICBsZXQgc2NyZWVuV2lkdGggPSBvcHRpb25zWydzY3JlZW4td2lkdGgnXTtcclxuICAgIHNjcmVlbldpZHRoID0gc2NyZWVuV2lkdGggJiYgc2NyZWVuV2lkdGggPiAwID8gc2NyZWVuV2lkdGggOiA4MDA7XHJcbiAgICBsZXQgc2NyZWVuSGVpZ2h0ID0gb3B0aW9uc1snc2NyZWVuLWhlaWdodCddO1xyXG4gICAgc2NyZWVuSGVpZ2h0ID0gc2NyZWVuSGVpZ2h0ICYmIHNjcmVlbkhlaWdodCA+IDAgPyBzY3JlZW5IZWlnaHQgOiA4MDA7XHJcblxyXG4gICAgLy/mkYTlg4/mnLpcclxuICAgIFNldERlZmF1bHRDYW1lcmEoXHJcbiAgICAgICAgQ3JlYXRlQ2FtZXJhV2l0aERhdGEob3B0aW9uc1snY2FtZXJhJ10sIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpKTtcclxuXHJcbiAgICAvL+W8leaTjlxyXG4gICAgU2V0RW5naW5lKFxyXG4gICAgICAgIENyZWF0ZUVuZ2luZVdpdGhEYXRhKG9wdGlvbnNbJ2VuZ2luZSddLCBzY3JlZW5XaWR0aCwgc2NyZWVuSGVpZ2h0LCBvcHRpb25zLmtleURvd25IYW5kbGVyLCBvcHRpb25zLmtleVVwSGFubGVyLCBvcHRpb25zLnRvdWNoT25DYWxsYmFjaywgb3B0aW9ucy50b3VjaE92ZXJDYWxsYmFjaykpO1xyXG4gICAgXHJcbiAgICAvL+ezu+e7n1xyXG4gICAgaW5pdFN5c3RlbXMob3B0aW9uc1snZGVidWcnXSk7XHJcblxyXG4gICAgLy/lvIDlkK/norDmkp7ns7vnu59cclxuICAgIGlmKG9wdGlvbnMuY29sbGlkZSl7XHJcbiAgICAgICAgT3BlbkNvbGxpZGVyKG9wdGlvbnMuY29sbGlkZSk7XHJcblxyXG4gICAgICAgIC8vIGlmKG9wdGlvbnMudXNlVGlsZUNvbWJpbmUpe1xyXG4gICAgICAgIC8vICAgICBsZXQgcmVzdWx0Tm9kZXMgPSBDcmVhdGVDb21iaW5lTm9kZXModGlsZW1hcCwgY29sbGlkZS5ib3hIYW5kbGVyKTtcclxuICAgICAgICAvLyAgICAgcmVzdWx0Tm9kZXMuZm9yRWFjaChyZXN1bHQgPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgY29sbGlkZS5sb2FkQ2FsbGJhY2socmVzdWx0LnZhbHVlLCByZXN1bHQucmVjdCk7XHJcbiAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgIC8vIH1cclxuICAgIH1cclxuXHJcbiAgICAvL+iHquWumuS5ieaVsOaNruetiVxyXG4gICAgaW5pdERlZihvcHRpb25zWydkZWYnXSk7XHJcbiAgICBpbml0RGF0YXMob3B0aW9uc1snZGF0YXMnXSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXREZWYob3B0aW9ucyA9IG51bGwpe1xyXG4gICAgZm9yKGxldCBrZXkgaW4gb3B0aW9ucyl7XHJcbiAgICAgICAgU2V0RGVmKGtleSwgb3B0aW9uc1trZXldKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE8g5Li05pe25pa55rOV77yM5Lul5ZCO5LyY5YyWXHJcbiAqIEBwYXJhbSB7Kn0gb3B0aW9ucyBcclxuICovXHJcbmZ1bmN0aW9uIGluaXREYXRhcyhkYXRhcyA9IG51bGwpe1xyXG4gICAgaWYoIWRhdGFzIHx8IGRhdGFzLmxlbmd0aCA9PSAwKXtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkYXRhcy5mb3JFYWNoKGRhdGEgPT4ge1xyXG4gICAgICAgIGluaXREYXRhT2JqKGRhdGEpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gaW5pdERhdGFPYmoob3B0aW9ucyA9IG51bGwpe1xyXG4gICAgbGV0IGRhdGFPYmogPSBudWxsO1xyXG4gICAgaWYob3B0aW9uc1sndGlsZW1hcCddKXtcclxuICAgICAgICBkYXRhT2JqID0gQ3JlYXRlVGlsZU1hcFdpdGhEYXRhKG9wdGlvbnNbJ3RpbGVtYXAnXSwgb3B0aW9uc1sndGlsZW1hcCddLm9uQ2VhdGUpO1xyXG4gICAgfVxyXG4gICAgbGV0IG5hbWUgPSBvcHRpb25zWyduYW1lJ107XHJcbiAgICBpZihuYW1lKXtcclxuICAgICAgICBTZXREYXRhKG5hbWUsIGRhdGFPYmopO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnR7XHJcbiAgICBpbml0R2FtZVxyXG59IiwiaW1wb3J0IHsgaW5pdEdhbWUgfSBmcm9tIFwiLi9zZXJ2aWNlL2luaXRcIjtcclxuaW1wb3J0IHsgcnVuV2l0aFNjZW5lLCBzdG9wU3lzdGVtIH0gZnJvbSBcIi4vc2VydmljZS9zeXN0ZW1cIjtcclxuaW1wb3J0IHsgR2V0U2NlbmUsIEdldEVuZ2luZSwgU2V0U3ByaXRlRnJhbWUgfSBmcm9tIFwiLi9yZXNvdXJjZVwiO1xyXG5pbXBvcnQgeyBDcmVhdGVCaXRtYXAgfSBmcm9tIFwiLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZnJhbWVcIjtcclxuXHJcbi8qKlxyXG4gKiBvcHRpb25zIHtcclxuICogICAgICB0ZXh0dXJlcyA6IOagvOW8j+ingUxvYWRSZXNvdXJjZSgp5YaFXHJcbiAqICAgICAgc2NyZWVuIDoge1xyXG4gKiAgICAgICAgICB3aWR0aCA6IDgwMCxcclxuICogICAgICAgICAgaGVpZ2h0IDogODAwXHJcbiAqICAgICAgfSxcclxuICogICAgICBmcHMgOiA2MCxcclxuICogICAgICBkZWJ1ZyA6IGZhbHNlLFxyXG4gKiAgICAgIGNhbWVyYSA6IHtcclxuICogICAgICAgICAgeCA6IDAsXHJcbiAqICAgICAgICAgIHkgOiAwXHJcbiAqICAgICAgfSxcclxuICogICAgICB0aWxlbWFwIDog5qC85byP5Y+C6ICDdGlsZW1hcOS4gOiKglxyXG4gKiAgICAgIGtleUhhbmRsZXIgOiBmdW5jdGlvbih0eXBlLCBrZXlDb2RlKSAgIHR5cGU9MSA9IGRvd24sIHR5cGU9MiA9IHVwXHJcbiAqICAgICAgY29sbGlkZSA6IHtcclxuICogICAgICAgICAgdXNlQm94IDogZmFsc2UsXHJcbiAqICAgICAgICAgIHVzZUdyb3VwIDogZmFsc2UsXHJcbiAqICAgICAgICAgIHBhaXJzIDogW1xyXG4gKiAgICAgICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgICAgIHRlYW0xIDogMSxcclxuICogICAgICAgICAgICAgICAgICB0ZWFtMiA6IDJcclxuICogICAgICAgICAgICAgIH1cclxuICogICAgICAgICAgXSxcclxuICogICAgICAgICAgaGFuZGxlciA6IGZ1bmN0aW9uKGR0LCBjb2xsaWRlcjEsIGNvbGxpZGVyMilcclxuICogICAgICB9XHJcbiAqIH1cclxuICogVE9ETyBzY2VuZeWPr+S7peaYr+S4gOS4qmFjdGlvbj9cclxuICovXHJcbmZ1bmN0aW9uIFN0YXJ0KG9wdGlvbnMgPSBudWxsLCBzY2VuZSA9IG51bGwpe1xyXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XHJcbiAgICBpZihvcHRpb25zWyd0ZXh0dXJlcyddKXtcclxuICAgICAgICBsb2FkUmVzb3VyY2Uob3B0aW9uc1sndGV4dHVyZXMnXSwgbnVsbCwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpbml0R2FtZShvcHRpb25zKTtcclxuICAgICAgICAgICAgcnVuV2l0aFNjZW5lKHNjZW5lKTtcclxuICAgICAgICB9KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGluaXRHYW1lKG9wdGlvbnMpO1xyXG4gICAgICAgIHJ1bldpdGhTY2VuZShzY2VuZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFN0b3AoKXtcclxuICAgIEdldFNjZW5lKCkub25FbmQoKTtcclxuICAgIC8vc3RvcFN5c3RlbXMoKTtcclxuICAgIHN0b3BTeXN0ZW0oKTtcclxuICAgIFN0b3BFbmdpbmUoZ2V0RW5naW5lKCkpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIOWKoOi9vei1hOa6kO+8jOWIm+W7uueyvueBteW4p1xyXG4gKiB0ZXh0dXJlcyA6IFtcclxuICogICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgaW1nIDogXCJyZXMvYS5wbmdcIixcclxuICogICAgICAgICAgICAgIGZyYW1lcyA6IFtcclxuICogICAgICAgICAgICAgICAgICB7XHJcbiAqICAgICAgICAgICAgICAgICAgICAgIG5hbWUgOiBcIndhbGsxXCJcclxuICogICAgICAgICAgICAgICAgICAgICAgdGV4dHVyZUFyZWEgOiB7XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICB4IDogMCxcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHkgOiAwLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggOiAwLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IDogMFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAqICAgICAgICAgICAgICAgICAgfVxyXG4gKiAgICAgICAgICAgICAgXVxyXG4gKiAgICAgICAgICB9XHJcbiAqICAgICAgXSxcclxuICovXHJcbmZ1bmN0aW9uIGxvYWRSZXNvdXJjZSh0ZXh0dXJlc0RhdGEgPSBudWxsLCBPbmxvYWRDYWxsYmFjayA9IG51bGwsIE9uQ29tcGxldGVDYWxsYmFjayA9IG51bGwpe1xyXG4gICAgLy/liqDovb3lm77lg4/lubbliJvlu7rmmL7npLrluKdcclxuICAgIGlmKCF0ZXh0dXJlc0RhdGEgfHwgdGV4dHVyZXNEYXRhLmxlbmd0aCA9PSAwKXtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgX2NvdW50ID0gMDtcclxuICAgIHRleHR1cmVzRGF0YS5mb3JFYWNoKHQgPT57XHJcbiAgICAgICAgRW5naW5lTG9hZFJlc291cmNlKEdldEVuZ2luZSgpLCB0LmltZywgYml0bWFwRGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBiaXRtYXAgPSBDcmVhdGVCaXRtYXAoYml0bWFwRGF0YSwgYml0bWFwRGF0YS53aWR0aCwgYml0bWFwRGF0YS5oZWlnaHQpO1xyXG4gICAgICAgICAgICB0LmZyYW1lcy5mb3JFYWNoKGZyYW1lRGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVTcHJpdGVGcmFtZVdpdGhEYXRhKGZyYW1lRGF0YS5uYW1lLCBiaXRtYXAsIGZyYW1lRGF0YS50ZXh0dXJlQXJlYSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBfY291bnQrKztcclxuICAgICAgICAgICAgaWYoT25sb2FkQ2FsbGJhY2spe1xyXG4gICAgICAgICAgICAgICAgT25sb2FkQ2FsbGJhY2soX2NvdW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0ZXh0dXJlc0RhdGEubGVuZ3RoID09IF9jb3VudCAmJiBPbkNvbXBsZXRlQ2FsbGJhY2spe1xyXG4gICAgICAgICAgICAgICAgT25Db21wbGV0ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVNwcml0ZUZyYW1lV2l0aERhdGEobmFtZSA9IFwiXCIsIGJpdG1hcCA9IG51bGwsIHRleHR1cmVBcmVhRGF0YSA9IG51bGwpe1xyXG4gICAgaWYobmFtZSA9PSBcIlwiIHx8ICFiaXRtYXAgfHwgIXRleHR1cmVBcmVhRGF0YSl7XHJcbiAgICAgICAgY29uc29sZS5lcnIoXCJlcnJvciBwYXJhbS5cIik7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBsZXQgeCA9IHRleHR1cmVBcmVhRGF0YVsneCddO1xyXG4gICAgbGV0IHkgPSB0ZXh0dXJlQXJlYURhdGFbJ3knXTtcclxuICAgIGxldCB3aWR0aCA9IHRleHR1cmVBcmVhRGF0YVsnd2lkdGgnXTtcclxuICAgIGxldCBoZWlnaHQgPSB0ZXh0dXJlQXJlYURhdGFbJ2hlaWdodCddO1xyXG4gICAgaWYoIXdpZHRoIHx8ICFoZWlnaHQpe1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgbGV0IGYgPSBDcmVhdGVTcHJpdGVGcmFtZShuYW1lLCBiaXRtYXAsIHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgU2V0U3ByaXRlRnJhbWUobmFtZSwgZik7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBTdGFydCwgU3RvcFxyXG59IiwiaW1wb3J0IHsgQWRkVG9MYXllciwgUmVtb3ZlRnJvbUxheWVyLCBHZXRMYXllciB9IGZyb20gXCIuL2NvbXBvbmVudC9sYXllclwiO1xyXG5pbXBvcnQgeyBOZXdEaXNwbGF5ZXIgfSBmcm9tIFwiLi9jb21wb25lbnQvcmVuZGVyXCI7XHJcblxyXG5cclxuLyoqXHJcbiAqIOWKoOWFpea4suafk+mYn+WIl1xyXG4gKiBsYXllck9yZGVyID0g5Zu+5bGC6aG65bqP77yM5pWw5YC85LuO5L2O5Yiw6auY6aG65bqP5riy5p+TXHJcbiAqIG9yZGVyID0g6Ieq5bex5omA5Zyo5Zu+5bGC5YaF55qE6aG65bqPXHJcbiAqIFRPRE8g6ZyA6KaB5Yik5pat6YeN5aSN5oCn77yM5aaC5LiA5LiqZW50aXR5SWTlpJrmrKHnlKjkuoblkIzmoLfnmoRzcHJpdGXvvIznm7jkupLopobnm5bvvIzpgKDmiJDmtarotLlcclxuICovXHJcbmZ1bmN0aW9uIEFkZERpc3BsYXllcihzcHJpdGVGcmFtZSA9IG51bGwsIGVudGl0eUlkID0gMCwgbGF5ZXJPcmRlciA9IDAsIG9yZGVyID0gMCwgb2Zmc2V0ID0gbnVsbCkge1xyXG4gICAgbGV0IGRzID0gTmV3RGlzcGxheWVyKGVudGl0eUlkLCBzcHJpdGVGcmFtZSwgb2Zmc2V0LCBvcmRlciwgbGF5ZXJPcmRlcik7XHJcbiAgICBBZGRUb0xheWVyKGRzKTtcclxuICAgIHJldHVybiBkcztcclxufVxyXG5cclxuZnVuY3Rpb24gUmVtb3ZlRGlzcGxheWVyKGRpc3BsYXllciA9IG51bGwpIHtcclxuICAgIFJlbW92ZUZyb21MYXllcihkaXNwbGF5ZXIpO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgQWRkRGlzcGxheWVyLCBSZW1vdmVEaXNwbGF5ZXJcclxufSIsImltcG9ydCBkYXRhIGZyb20gJy4vZGF0YSc7XHJcbmltcG9ydCB7IEdldERhdGEsIEdldERlZmF1bHRDYW1lcmEsIEdldFNwcml0ZUZyYW1lIH0gZnJvbSAnLi9mcmFtZXdvcmsvZGlyZWN0b3IvcmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBEcmF3UmVjdCwgRHJhd0xpbmUsIERyYXdDaXJjbGUgfSBmcm9tICcuL2ZyYW1ld29yay9kaXJlY3Rvci9yZW5kZXInO1xyXG5pbXBvcnQgeyBTdGFydCB9IGZyb20gJy4vZnJhbWV3b3JrL2RpcmVjdG9yL2Jvb3QnO1xyXG5pbXBvcnQgeyBHcmlkTWFwSXRlcmF0b3IsIEdldEdyaWRXaWR0aCwgR2V0SGFsZkdyaWRXaWR0aCB9IGZyb20gJy4vZnJhbWV3b3JrL2ZvdW5kYXRpb24vY29udGFpbmVyL2dyaWRtYXAnO1xyXG5pbXBvcnQgeyBHZXRUaWxlR3JpZENlbnRlciB9IGZyb20gJy4vZnJhbWV3b3JrL2xpYi9ncmlkL3RpbGVtYXAvYmFzZSc7XHJcbmltcG9ydCB7IE5ld1JlY3QsIE5ld1BvcyB9IGZyb20gJy4vZnJhbWV3b3JrL2ZvdW5kYXRpb24vc3RydWN0dXJlL2dlb21ldHJpYyc7XHJcbmltcG9ydCB7IEdldENhbWVyYUhlaWdodCwgR2V0Q2FtZXJhV2lkdGggfSBmcm9tICcuL2ZyYW1ld29yay9saWIvY2FtZXJhL2Jhc2UnO1xyXG5pbXBvcnQgeyBBZGREaXNwbGF5ZXIgfSBmcm9tICcuL2ZyYW1ld29yay9saWIvdmlldy91dGlscyc7XHJcbmltcG9ydCB7IE5ld0VudGl0eUlkIH0gZnJvbSAnLi9mcmFtZXdvcmsvZm91bmRhdGlvbi9jb21wb25lbnQvZWNzJztcclxuaW1wb3J0IHsgR2V0UmVuZGVyQ29tcG9uZW50IH0gZnJvbSAnLi9mcmFtZXdvcmsvbGliL3ZpZXcvY29tcG9uZW50L3JlbmRlcic7XHJcbmltcG9ydCB7IFNldFVuaXRQb3MgfSBmcm9tICcuL2ZyYW1ld29yay9saWIvcG9zL2NvbXBvbmVudCc7XHJcblxyXG4vL+iwqOiusOaVsOaNrumpseWKqO+8jOWIhua4heS4muWKoemFjee9ruWSjOahhuaetumAu+i+kemFjee9rlxyXG52YXIgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oZGF0YSwge1xyXG4gICAgdG91Y2hPbkNhbGxiYWNrIDogdG91Y2hPbkNhbGxiYWNrLFxyXG4gICAgdG91Y2hPdmVyQ2FsbGJhY2sgOiB0b3VjaE92ZXJDYWxsYmFjayxcclxufSk7XHJcbm9wdGlvbnMudGlsZW1hcC5vbkNyZWF0ZSA9IGZ1bmN0aW9uKGRhdGEgPSBudWxsLCB0aWxlbWFwID0gbnVsbCwgZ3JpZCA9IG51bGwpe1xyXG4gICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICBpbml0RGlzcGxheShkYXRhLCB0aWxlbWFwLCBncmlkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG91Y2hPbkNhbGxiYWNrKHggPSAwLCB5ID0gMCl7XHJcbiAgICBjb25zb2xlLmxvZyh4LCB5KTtcclxufVxyXG5mdW5jdGlvbiB0b3VjaE92ZXJDYWxsYmFjayh4ID0gMCwgeSA9IDApe1xyXG5cclxufVxyXG5cclxuY2xhc3MgTXlTY2VuZSB7XHJcbiAgICBvblN0YXJ0KCl7XHJcbiAgICAgICAgLy9kcmF3KCk7XHJcbiAgICB9XHJcbiAgICBvblVwZGF0ZShkdCA9IDApe1xyXG4gICAgICAgIGRyYXcoKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhdygpe1xyXG4gICAgZHJhd1RpbGUoKTtcclxuICAgIGRyYXdDZW50ZXIoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0NlbnRlcigpe1xyXG4gICAgRHJhd0NpcmNsZShOZXdQb3MoKSwgMyk7XHJcbiAgICBEcmF3UmVjdChOZXdQb3MoKSwgTmV3UmVjdChcclxuICAgICAgICBHZXRDYW1lcmFXaWR0aChcclxuICAgICAgICAgICAgR2V0RGVmYXVsdENhbWVyYSgpKSxcclxuICAgICAgICBHZXRDYW1lcmFIZWlnaHQoXHJcbiAgICAgICAgICAgIEdldERlZmF1bHRDYW1lcmEoKSkpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd1RpbGUoKXtcclxuICAgIGxldCB0aWxlbWFwID0gR2V0RGF0YShcInRpbGUxXCIpO1xyXG4gICAgR3JpZE1hcEl0ZXJhdG9yKHRpbGVtYXAsIGdyaWQgPT4ge1xyXG4gICAgICAgIGxldCBwb3MgPSBHZXRUaWxlR3JpZENlbnRlcih0aWxlbWFwLCBncmlkKTtcclxuICAgICAgICBsZXQgaGFsZldpZHRoID0gR2V0SGFsZkdyaWRXaWR0aChncmlkKTtcclxuICAgICAgICBsZXQgd2lkdGggPSBHZXRHcmlkV2lkdGgoZ3JpZCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJnWyVkLCAlZF06ICglZCwgJWQpLCAlZCAlZFwiLCBncmlkLnJvd0luZGV4LCBncmlkLmNvbEluZGV4LCBwb3MueCwgcG9zLnksIGhhbGZXaWR0aCwgd2lkdGgpO1xyXG4gICAgICAgIC8vRHJhd1JlY3QocG9zLCBOZXdSZWN0KHdpZHRoLCB3aWR0aCkpO1xyXG4gICAgICAgIHRlc3RJc28ocG9zLCBoYWxmV2lkdGgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRlc3RJc28ocG9zID0gbnVsbCwgaGFsZldpZHRoID0gMCl7XHJcbiAgICBsZXQgcG9zMSA9IE5ld1Bvcyhwb3MueCAtIGhhbGZXaWR0aCwgcG9zLnkgLSBoYWxmV2lkdGgpO1xyXG4gICAgbGV0IHBvczFpc28gPSBnZXRJc28ocG9zMSk7XHJcbiAgICBsZXQgcG9zMiA9IE5ld1Bvcyhwb3MueCArIGhhbGZXaWR0aCwgcG9zLnkgLSBoYWxmV2lkdGgpO1xyXG4gICAgbGV0IHBvczJpc28gPSBnZXRJc28ocG9zMik7XHJcbiAgICBsZXQgcG9zMyA9IE5ld1Bvcyhwb3MueCAtIGhhbGZXaWR0aCwgcG9zLnkgKyBoYWxmV2lkdGgpO1xyXG4gICAgbGV0IHBvczNpc28gPSBnZXRJc28ocG9zMyk7XHJcbiAgICBsZXQgcG9zNCA9IE5ld1Bvcyhwb3MueCArIGhhbGZXaWR0aCwgcG9zLnkgKyBoYWxmV2lkdGgpO1xyXG4gICAgbGV0IHBvczRpc28gPSBnZXRJc28ocG9zNCk7XHJcbiAgICBjb25zb2xlLmxvZyhcInAxOiglZCwgJWQpLCBpc286KCVkLCAlZClcIiwgcG9zMS54ICxwb3MxLnksIHBvczFpc28ueCwgcG9zMWlzby55KTtcclxuICAgIGNvbnNvbGUubG9nKFwicDI6KCVkLCAlZCksIGlzbzooJWQsICVkKVwiLCBwb3MyLnggLHBvczIueSwgcG9zMmlzby54LCBwb3MyaXNvLnkpO1xyXG4gICAgY29uc29sZS5sb2coXCJwMzooJWQsICVkKSwgaXNvOiglZCwgJWQpXCIsIHBvczMueCAscG9zMy55LCBwb3MzaXNvLngsIHBvczNpc28ueSk7XHJcbiAgICBjb25zb2xlLmxvZyhcInA0OiglZCwgJWQpLCBpc286KCVkLCAlZClcIiwgcG9zNC54ICxwb3M0LnksIHBvczRpc28ueCwgcG9zNGlzby55KTtcclxuICAgIC8vIERyYXdMaW5lKHBvczFpc28sIHBvczJpc28pO1xyXG4gICAgLy8gRHJhd0xpbmUocG9zMmlzbywgcG9zM2lzbyk7XHJcbiAgICAvLyBEcmF3TGluZShwb3MzaXNvLCBwb3M0aXNvKTtcclxuICAgIC8vIERyYXdMaW5lKHBvczRpc28sIHBvczFpc28pO1xyXG4gICAgRHJhd0xpbmUocG9zMWlzbywgcG9zMmlzbyk7XHJcbiAgICBEcmF3TGluZShwb3MyaXNvLCBwb3M0aXNvKTtcclxuICAgIERyYXdMaW5lKHBvczRpc28sIHBvczNpc28pO1xyXG4gICAgRHJhd0xpbmUocG9zM2lzbywgcG9zMWlzbyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldElzbyhwb3MgPSBudWxsKXtcclxuICAgIHJldHVybiBOZXdQb3MoXHJcbiAgICAgICAgKHBvcy54IC0gcG9zLnkpLFxyXG4gICAgICAgIChwb3MueCArIHBvcy55KSAqIDAuNVxyXG4gICAgKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFwiMVwiIDoge1xyXG5cdFx0XHRcImRpc3BsYXlcIiA6IHtcclxuXHRcdFx0XHRcImlzb21ldHJpY1wiIDogdHJ1ZSxcclxuXHRcdFx0XHRcImZyYW1lXCIgOiBcImJ1aWxkaW5nMVwiXHJcblx0XHRcdH1cclxuXHRcdH0sXHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0RGlzcGxheShkYXRhID0gbnVsbCwgdGlsZW1hcCA9IG51bGwsIGdyaWQgPSBudWxsKXtcclxuICAgIGxldCBkID0gZGF0YVsnZGlzcGxheWVyJ107XHJcbiAgICBsZXQgaWQgPSBOZXdFbnRpdHlJZCgpO1xyXG4gICAgR2V0UmVuZGVyQ29tcG9uZW50KGlkLCB7aXNvbWV0cmljczp0cnVlfSk7XHJcbiAgICBsZXQgcG9zID0gR2V0VGlsZUdyaWRDZW50ZXIodGlsZW1hcCwgZ3JpZCk7XHJcbiAgICBTZXRVbml0UG9zKGlkLCBwb3MueCwgcG9zLnkpO1xyXG4gICAgQWRkRGlzcGxheWVyKFxyXG4gICAgICAgIEdldFNwcml0ZUZyYW1lKGRbJ2ZyYW1lJ10pLCBpZCk7XHJcbn1cclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uICgpe1xyXG4gICAgY29uc29sZS5sb2cob3B0aW9ucyk7XHJcbiAgICBTdGFydChvcHRpb25zLCBuZXcgTXlTY2VuZSgpKTtcclxufSkoKSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN0R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDN0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDdkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3ZKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDL0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN6REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM1RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQy9FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDdkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n')}]);