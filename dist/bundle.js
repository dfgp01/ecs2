!function(t){var e={};function n(l){if(e[l])return e[l].exports;var i=e[l]={i:l,l:!1,exports:{}};return t[l].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,l){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:l})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(l,i,function(e){return t[e]}.bind(null,i));return l},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t){t.exports={debug:!0,def:{0:{},1:{color:"#333333"}},datas:[{name:"tile1",tilemap:{data:[1,1,1,1,0,1,1,1,1],columns:3,gridWidth:80,gridHeight:80}}]}},function(t,e,n){"use strict";n.r(e);var l=n(0),i=new Map;var r=new Map;var u=null;function a(){return u}var s=null;function o(){return s}function h(t=null,e=null){!function(t=null,e=null,n=null){let l=ToCameraPosStart(t,e);!function(t=null,e=null,n=null){t.drawRect(e,n)}(o(),l,n)}(a(),t,e)}function c(t=null){let e=t["screen-width"];e=e&&e>0?e:800;let n=t["screen-height"];n=n&&n>0?n:800,setDefaultCamera(CreateCameraWithData(t.camera,e,n)),setEngine(CreateEngineWithData(t.engine,e,n)),initSystems(t.debug),t.collide&&OpenCollider(t.collide),function(t=null){if(!t||0==t.length)return;t.forEach(t=>{!function(t=null){let e=null;t.tilemap&&(e=CreateTileMapWithData(t.tilemap));let n=t.name;n&&setDataByName(n,e)}(t)})}(t.datas)}class d{constructor(){}get(t=0){}firsr(){}last(){}size(){}add(t=null){}push(t=null){}insert(t=null,e=0){}pop(){}pull(){}remove(t=0){}iterator(t=null){}iteratorReverse(t=null){}iteratorCompare(t=null){}}function p(t=null,e=null){t&&e&&t.iterator(e)}class f{constructor(t=null,e=null,n=null,l=0){this.data=t,this.prep=e,this.next=n,this.order=l}}class g extends d{constructor(){this.head=new f,this.tail=new f,this.head.next=this.tail,this.tail.prep=this.head,this._map=new Map,this._size=0,this._delList=[],this._curr=this.head,this._lock=!1}get(t=0){let e=this._map.get(t);return e?e.data:null}first(){let t=this.head.next;return t==this.tail?null:t.data}last(){let t=this.tail.prep;return t==this.head?null:t.data}size(){return this._size}add(t=null){m(this,t,this.tail)}push(t=null){m(this,t,this.head.next)}insert(t=null,e=0){let n=this.head.next;for(;n!=this.tail&&!(e<n.order);)n=n.next;m(this,t,n,e)}pop(){_(this,this.head.next)}pull(){_(this,this.tail.prep)}remove(t=0){_(this,this._map.get(t))}iterator(t=null){this._lock=!0;let e=this.head.next;for(;e!=this.tail&&!t(e.data);)e=e.next;for(this._lock=!1;this._delList.length>0;)x(this,this._delList.pop())}iteratorReverse(t=null){this._lock=!0;let e=this.tail.prep;for(;e!=this.head&&!t(e.data);)e=e.prep;for(this._lock=!1;this._delList.length>0;)x(this,this._delList.pop())}iteratorCompare(t=null){this._lock=!0;let e=this.head.next;for(;e!=this.tail;){let n=e.next;for(;n!=this.tail&&!t(e.data,n.data);)n=n.next;e=e.next}for(this._lock=!1;this._delList.length>0;)x(this,this._delList.pop())}}function m(t=null,e=null,n=null,l=0){let i=n.prep,r=new f(e,i,n,l);i.next=r,n.prep=r,t._map.set(e.id,r),t._size++}function _(t=null,e=null){!t||!e||t._size<=0||(t._lock?t._delList.push(e):x(t,e))}function x(t=null,e=null){t._map.delete(keyId);let n=e.prep,l=e.next;n.next=l,l.prep=n,t._size--}function v(){return new g}v();class w{constructor(t=null,e=0,n=0){this.data=t,this.width=e,this.height=n}}v();var y=v(),b=null;var S=16,C=41,k=0,L=0;function M(t=null){p(y,t=>{t.onStart()}),b.onStart(),t.onStart(),function(t=null,e=null){t.start(e)}(o(),e=>{(k+=e)>=S&&(k-=S,t.onUpdate(e),p(y,t=>{t.onUpdate(e)})),(L+=e)>=C&&(L-=C,b.onUpdate(e))})}function O(t=null,e=null){(t=t||{}).textures?function(t=null,e=null,n=null){if(!t||0==t.length)return;let l=0;t.forEach(r=>{EngineLoadResource(o(),r.img,u=>{let a=function(t=null,e=0,n=0){return new w(t,e,n)}(u,u.width,u.height);r.frames.forEach(t=>{!function(t="",e=null,n=null){if(""==t||!e||!n)return console.err("error param."),null;let l=n.x,r=n.y,u=n.width,a=n.height;if(!u||!a)return null;let s=CreateSpriteFrame(t,e,l,r,u,a);!function(t="",e=null,n=!0){i.get(t)&&n?console.error("frame: %s exists.",t):i.set(t,e)}(t,s)}(t.name,a,t.textureArea)}),l++,e&&e(l),t.length==l&&n&&n()})})}(t.textures,null,()=>{c(t),M(e)}):(c(t),M(e))}function j(t=null){return t.width}class z{onStart(){!function(t=null,e=null){t.iterator(e)}(function(t=""){return r.get(t)}("tile1"),t=>{let e=GetTileGridCenter(t),n=(function(t=null){j(t)}(t),j(t));h(e,n)})}onUpdate(t=0){}}console.log(l),O(l,new z)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9kaXJlY3Rvci9yZXNvdXJjZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2RpcmVjdG9yL3JlbmRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi9lbmdpbmUvYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2RpcmVjdG9yL3NlcnZpY2UvaW5pdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2ZvdW5kYXRpb24vY29udGFpbmVyL2xpc3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZyYW1ld29yay9saWIvbGlzdC9saW5rbGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2xpYi92aWV3L2NvbXBvbmVudC9sYXllci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2ZvdW5kYXRpb24vc3RydWN0dXJlL2ZyYW1lLmpzIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvbGliL3ZpZXcvY29tcG9uZW50L3JlbmRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2RpcmVjdG9yL3NlcnZpY2Uvc3lzdGVtLmpzIiwid2VicGFjazovLy8uL3NyYy9mcmFtZXdvcmsvZGlyZWN0b3IvYm9vdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZnJhbWV3b3JrL2ZvdW5kYXRpb24vY29udGFpbmVyL2dyaWRtYXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21haW4uanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJfc3ByaXRlRnJhbWVNYXAiLCJNYXAiLCJyZXNvdXJjZV9kYXRhIiwiZGVmYXVsdENhbWVyYSIsIkdldERlZmF1bHRDYW1lcmEiLCJjdXJyRW5naW5lIiwiR2V0RW5naW5lIiwiRHJhd1JlY3QiLCJwb3MiLCJyZWN0IiwiY2FtZXJhIiwiY1BvcyIsIlRvQ2FtZXJhUG9zU3RhcnQiLCJlbmdpbmUiLCJjZW50ZXJQb3MiLCJkcmF3UmVjdCIsIkVuZ2luZURyYXdSZWN0IiwiRHJhd1JlY3RJbkNhbWVyYSIsImluaXRHYW1lIiwib3B0aW9ucyIsInNjcmVlbldpZHRoIiwic2NyZWVuSGVpZ2h0Iiwic2V0RGVmYXVsdENhbWVyYSIsIkNyZWF0ZUNhbWVyYVdpdGhEYXRhIiwic2V0RW5naW5lIiwiQ3JlYXRlRW5naW5lV2l0aERhdGEiLCJpbml0U3lzdGVtcyIsImNvbGxpZGUiLCJPcGVuQ29sbGlkZXIiLCJkYXRhcyIsImxlbmd0aCIsImZvckVhY2giLCJkYXRhIiwiZGF0YU9iaiIsIkNyZWF0ZVRpbGVNYXBXaXRoRGF0YSIsInNldERhdGFCeU5hbWUiLCJpbml0RGF0YU9iaiIsImluaXREYXRhcyIsIkFic3RyYWN0TGlzdCIsIltvYmplY3QgT2JqZWN0XSIsImlkIiwib3JkZXIiLCJjYWxsYmFjayIsIkxpc3RJdGVyYXRvciIsImxpc3QiLCJpdGVyYXRvciIsIkxpbmtOb2RlIiwicHJlcCIsIm5leHQiLCJ0aGlzIiwibGlua2xpc3RfTGlua0xpc3QiLCJoZWFkIiwidGFpbCIsIl9tYXAiLCJfc2l6ZSIsIl9kZWxMaXN0IiwiX2N1cnIiLCJfbG9jayIsIm5vZGUiLCJhZGRUb0xpbmsiLCJyZW1vdmVXaXRoQ2hlY2siLCJyZW1vdmVOb2RlIiwicG9wIiwib3V0Tm9kZSIsImluTm9kZSIsImxpbmsiLCJzZXQiLCJ0YXJnZXROb2RlIiwicHVzaCIsImRlbGV0ZSIsImtleUlkIiwiTmV3TGluayIsIkJpdG1hcCIsIndpZHRoIiwiaGVpZ2h0IiwibG9naWNTeXN0ZW1zIiwicmVuZGVyU3lzdGVtIiwibG9naWNUaWNrIiwicmVuZGVyVGljayIsIl90MSIsIl90MiIsInJ1bldpdGhTY2VuZSIsInNjZW5lIiwic3lzdGVtIiwib25TdGFydCIsIm9uRW50ZXJGcmFtZUNhbGxiYWNrIiwic3RhcnQiLCJFbmdpbmVTdGFydCIsImR0Iiwib25VcGRhdGUiLCJTdGFydCIsInRleHR1cmVzRGF0YSIsIk9ubG9hZENhbGxiYWNrIiwiT25Db21wbGV0ZUNhbGxiYWNrIiwiX2NvdW50IiwiRW5naW5lTG9hZFJlc291cmNlIiwiaW1nIiwiYml0bWFwRGF0YSIsImJpdG1hcCIsIkNyZWF0ZUJpdG1hcCIsImZyYW1lcyIsImZyYW1lRGF0YSIsInRleHR1cmVBcmVhRGF0YSIsImNvbnNvbGUiLCJlcnIiLCJ4IiwieSIsImYiLCJDcmVhdGVTcHJpdGVGcmFtZSIsInNwcml0ZUZyYW1lIiwiY2hlY2siLCJlcnJvciIsIlNldFNwcml0ZUZyYW1lIiwiY3JlYXRlU3ByaXRlRnJhbWVXaXRoRGF0YSIsInRleHR1cmVBcmVhIiwibG9hZFJlc291cmNlIiwiR2V0R3JpZFdpZHRoIiwiZ3JpZCIsIk15U2NlbmUiLCJncmlkbWFwIiwiR3JpZE1hcEl0ZXJhdG9yIiwiR2V0RGF0YSIsIkdldFRpbGVHcmlkQ2VudGVyIiwiR2V0SGFsZkdyaWRXaWR0aCIsImxvZyJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFBQUwsR0FBQU0s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LEdBQUFELEdBQ0FBLFFBdERBc0IsQ0FBQWhHLEVBQUEsbUJBQ1lELEVBQVFDLEdBQ1I4RCxFQUFZQyxNQUdoQmhFLEVBQVFDLEdBQ1I4RCxFQUFZQyxJQ0RwQixTQUFBa0MsRUFBQUMsRUFBQSxNQUNBLE9BQUFBLEVBQUE1QyxNQ3JCQSxNQUFBNkMsRUFDQS9FLFdEcURBLFNBQUFnRixFQUFBLEtBQUE3RSxFQUFBLE1BQ0E2RSxFQUFBMUUsU0FBQUgsR0M1Q0k4RSxDWkZKLFNBQUFqSixFQUFBLElBQ0EsT0FBVzJCLEVBQUlyQixJQUFBTixHWUFHa0osQ0FBTyxTQUNOSixJQUNuQixJQUFBN0csRUFBQWtILGtCQUFBTCxHQUVBNUMsR0RTQSxTQUFBNEMsRUFBQSxNQUNBRCxFQUFBQyxHQ1h3Qk0sQ0FBZ0JOLEdBQ3BCRCxFQUFZQyxJQUN4QjlHLEVBQVFDLEVBQUFpRSxLQVhoQmxDLFNBQUFpRCxFQUFBLEtBZ0JBZSxRQUFBcUIsSUFBZ0I1RixHQUNaMEQsRUFBTTFELEVBQU8sSUFBQXNGIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbiIsIi8qKlxyXG4gKiDlhajlsYDljZXkvovotYTmupBcclxuICovXHJcblxyXG5cclxuIC8qKlxyXG4gKiDojrflj5bnsr7ngbXluKdcclxuICogVE9ETyBcclxuICog5Y+v6IO95Lya5pS55oiQaWTlvaLlvI9cclxuICog5byV5YWl6buY6K6k6LWE5rqQ5py65Yi277yM5om+5LiN5Yiw5bin5pe255qE6buY6K6k56m65bin77yM5Y+v5Lul5piv5LiA5byg57qi5Y+J5Zu+54mH77yMXHJcbiAqL1xyXG52YXIgX3Nwcml0ZUZyYW1lTWFwID0gbmV3IE1hcCgpO1xyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZShuYW1lID0gXCJcIiwgZGVmYXVsdFZhbHVlID0gdHJ1ZSl7XHJcbiAgICBsZXQgZiA9IF9zcHJpdGVGcmFtZU1hcC5nZXQobmFtZSk7XHJcbiAgICByZXR1cm4gZiA/IGYgOiBcclxuICAgICAgICBkZWZhdWx0VmFsdWUgPyBfc3ByaXRlRnJhbWVNYXAuZ2V0KFwiZGVmYWx1dFwiKSA6IG51bGw7XHJcbn1cclxuZnVuY3Rpb24gU2V0U3ByaXRlRnJhbWUobmFtZSA9IFwiXCIsIHNwcml0ZUZyYW1lID0gbnVsbCwgY2hlY2sgPSB0cnVlKXtcclxuICAgIGxldCBmID0gX3Nwcml0ZUZyYW1lTWFwLmdldChuYW1lKTtcclxuICAgIGlmKGYgJiYgY2hlY2spe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJmcmFtZTogJXMgZXhpc3RzLlwiLCBuYW1lKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfc3ByaXRlRnJhbWVNYXAuc2V0KG5hbWUsIHNwcml0ZUZyYW1lKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiDoh6rlrprkuYnmlbDmja5cclxuICovXHJcbnZhciBkYXRhID0gbmV3IE1hcCgpO1xyXG5mdW5jdGlvbiBHZXREYXRhKG5hbWUgPSBcIlwiKXtcclxuICAgIHJldHVybiBkYXRhLmdldChuYW1lKTtcclxufVxyXG5mdW5jdGlvbiBTZXREYXRhKG5hbWUgPSBcIlwiLCBkYXRhID0gbnVsbCwgY2hlY2sgPSB0cnVlKXtcclxuICAgIGxldCBkID1kYXRhLmdldChuYW1lKTtcclxuICAgIGlmKGQgJiYgY2hlY2spe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJkYXRhOiAlcyBleGlzdHMuXCIsIG5hbWUpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGRhdGEuc2V0KG5hbWUsIGRhdGEpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIOaRhOWDj+aculxyXG4gKi9cclxudmFyIGRlZmF1bHRDYW1lcmEgPSBudWxsO1xyXG5mdW5jdGlvbiBTZXREZWZhdWx0Q2FtZXJhKGNhbWVyYSA9IG51bGwpe1xyXG4gICAgZGVmYXVsdENhbWVyYSA9IGNhbWVyYTtcclxufVxyXG5mdW5jdGlvbiBHZXREZWZhdWx0Q2FtZXJhKCl7XHJcbiAgICByZXR1cm4gZGVmYXVsdENhbWVyYTtcclxufVxyXG5cclxudmFyIGNhbWVyYXMgPSBbXTtcclxuZnVuY3Rpb24gQWRkQ2FtZXJhKGNhbWVyYSA9IG51bGwpe1xyXG4gICAgY2FtZXJhcy5wdXNoKGNhbWVyYSk7XHJcbn1cclxuZnVuY3Rpb24gR2V0Q2FtZXJhcygpe1xyXG4gICAgcmV0dXJuIGNhbWVyYXM7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICog5aSW6YOo5byV5pOOXHJcbiAqL1xyXG52YXIgY3VyckVuZ2luZSA9IG51bGw7XHJcbmZ1bmN0aW9uIFNldEVuZ2luZShlbmdpbmVPYmogPSBudWxsKXtcclxuICAgIGN1cnJFbmdpbmUgPSBlbmdpbmVPYmo7XHJcbn1cclxuZnVuY3Rpb24gR2V0RW5naW5lKCl7XHJcbiAgICByZXR1cm4gY3VyckVuZ2luZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOW9k+WJjeWcuuaZr1xyXG4gKi9cclxudmFyIGN1cnJTY2VuZSA9IG51bGw7XHJcbmZ1bmN0aW9uIFNldFNjZW5lKHNjZW5lID0gbnVsbCl7XHJcbiAgICBjdXJyU2NlbmUgPSBzY2VuZTtcclxufVxyXG5mdW5jdGlvbiBHZXRTY2VuZSgpe1xyXG4gICAgcmV0dXJuIGN1cnJTY2VuZTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIEdldFNwcml0ZUZyYW1lLCBTZXRTcHJpdGVGcmFtZSwgR2V0RGF0YSwgU2V0RGF0YSwgXHJcbiAgICBTZXREZWZhdWx0Q2FtZXJhLCBHZXREZWZhdWx0Q2FtZXJhLCBBZGRDYW1lcmEsIEdldENhbWVyYXMsXHJcbiAgICBTZXRFbmdpbmUsIEdldEVuZ2luZSwgU2V0U2NlbmUsIEdldFNjZW5lXHJcbn0iLCJpbXBvcnQgeyBHZXRFbmdpbmUsIEdldERlZmF1bHRDYW1lcmEgfSBmcm9tIFwiLi9yZXNvdXJjZVwiO1xyXG5pbXBvcnQgeyBFbmdpbmVEcmF3RnJhbWUsIEVuZ2luZURyYXdSZWN0IH0gZnJvbSBcIi4uL2xpYi9lbmdpbmUvYmFzZVwiO1xyXG5cclxuLyoqXHJcbiAqIOa4hemZpOeUu+W4g1xyXG4gKi9cclxuZnVuY3Rpb24gQ2xlYXIoKXtcclxuICAgIEVuZ2luZUNsZWFyKEdldEVuZ2luZSgpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE8g5Y+v6IO95Lya5pS55oiQc3ByaXRlRnJhbWVJZOWPguaVsFxyXG4gKi9cclxuZnVuY3Rpb24gRHJhd0ZyYW1lKHBvcyA9IG51bGwsIHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICBEcmF3RnJhbWVJbkNhbWVyYShcclxuICAgICAgICBHZXREZWZhdWx0Q2FtZXJhKCksIHBvcywgc3ByaXRlRnJhbWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3RnJhbWVJbkNhbWVyYShjYW1lcmEgPSBudWxsLCBwb3MgPSBudWxsLCBzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgbGV0IGNQb3MgPSBUb0NhbWVyYVBvc1N0YXJ0KGNhbWVyYSwgcG9zKTtcclxuICAgIEVuZ2luZURyYXdGcmFtZShHZXRFbmdpbmUoKSxcclxuICAgICAgICBjUG9zLngsIGNQb3MueSwgc3ByaXRlRnJhbWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3UmVjdChwb3MgPSBudWxsLCByZWN0ID0gbnVsbCl7XHJcbiAgICBEcmF3UmVjdEluQ2FtZXJhKFxyXG4gICAgICAgIEdldERlZmF1bHRDYW1lcmEoKSwgcG9zLCByZWN0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gRHJhd1JlY3RJbkNhbWVyYShjYW1lcmEgPSBudWxsLCBwb3MgPSBudWxsLCByZWN0ID0gbnVsbCl7XHJcbiAgICBsZXQgY1BvcyA9IFRvQ2FtZXJhUG9zU3RhcnQoY2FtZXJhLCBwb3MpO1xyXG4gICAgRW5naW5lRHJhd1JlY3QoR2V0RW5naW5lKCksIGNQb3MsIHJlY3QpO1xyXG59XHJcblxyXG4vKipcclxuICogIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMg5LiL6Z2i55qE6L+Y5rKh5pS577yM6L+Q6KGM6LW35p2l5YWIXHJcbiovXHJcblxyXG5mdW5jdGlvbiBEcmF3TGluZShwb3MgPSBudWxsLCB2ZWMgPSBudWxsKXtcclxuICAgIERyYXdMaW5lSW5DYW1lcmEoXHJcbiAgICAgICAgR2V0RGVmYXVsdENhbWVyYSgpLCBwb3MsIHZlYyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIERyYXdMaW5lSW5DYW1lcmEoY2FtZXJhID0gbnVsbCwgcG9zID0gbnVsbCwgdmVjID0gbnVsbCl7XHJcbiAgICBsZXQgY1BvcyA9IFRvQ2FtZXJhUG9zKGNhbWVyYSwgcG9zKTtcclxuICAgIGxldCBjUG9zMiA9IFRvQ2FtZXJhUG9zKGNhbWVyYSwgTmV3UG9zKHBvcy54ICsgdmVjLngsIHBvcy55ICsgdmVjLnkpKTtcclxuICAgIEVuZ2luZURyYXdMaW5lKGdldEVuZ2luZSgpLFxyXG4gICAgICAgIGNQb3MueCwgY1Bvcy55LCBjUG9zMi54LCBjUG9zMi55KTtcclxufVxyXG5cclxuZnVuY3Rpb24gRHJhd0NpcmNsZShjaXJjbGUgPSBudWxsKXtcclxuICAgIEdldEVuZ2luZSgpLmRyYXdDaXJjbGUoXHJcbiAgICAgICAgY2lyY2xlLFxyXG4gICAgICAgIEdldENhbWVyYSgpLnRvQ2FtZXJhUG9zKFxyXG4gICAgICAgICAgICBHZXRDaXJjbGVQb3NTdGFydChjaXJjbGUpKSk7XHJcbn1cclxuXHJcbmV4cG9ydHtcclxuICAgIENsZWFyLCBEcmF3RnJhbWUsIERyYXdGcmFtZUluQ2FtZXJhLFxyXG4gICAgRHJhd1JlY3QsIERyYXdSZWN0SW5DYW1lcmFcclxufSIsIlxyXG4vKipcclxuICog5aSW6YOo5byV5pOO5oq96LGh57G7XHJcbiAqIHgsIHkg6YO95piv5bGP5bmV5Z2Q5qCH77yM5rOo5oSPXHJcbiAqL1xyXG5jbGFzcyBBYnN0cmFjdEVuZ2luZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihmcHMgPSA2MCl7XHJcbiAgICAgICAgdGhpcy5mcHMgPSBmcHM7XHJcbiAgICAgICAgdGhpcy50aWNrID0gMTAwMCAvIGZwcztcclxuICAgIH1cclxuXHJcbiAgICAvL+a4hemZpOeUu+W4g1xyXG4gICAgY2xlYXIoKXt9XHJcblxyXG4gICAgLy/nlLvluKdcclxuICAgIGRyYXdGcmFtZShjZW50ZXJQb3MgPSBudWxsLCBzcHJpdGVGcmFtZSA9IG51bGwpe31cclxuXHJcbiAgICAvL+eUu+efqeW9olxyXG4gICAgZHJhd1JlY3QoY2VudGVyUG9zID0gbnVsbCwgcmVjdCA9IG51bGwpe31cclxuXHJcbiAgICAvL+eUu+e6v+autVxyXG4gICAgZHJhd0xpbmUoY2VudGVyUG9zID0gbnVsbCwgZW5kUG9zID0gbnVsbCl7fVxyXG5cclxuICAgIC8v55S75ZyGXHJcbiAgICBkcmF3Q2lyY2xlKGNlbnRlclBvcyA9IG51bGwsIHJhZGl1cyA9IDApe31cclxuXHJcbiAgICAvL2ltZ1NyY+aYr+WbvuWDj+WcsOWdgFxyXG4gICAgbG9hZFJlc291cmNlKGltZ1NyYyA9IFwiXCIsIG9uTG9hZENhbGxiYWNrID0gbnVsbCl7fVxyXG5cclxuICAgIG9uS2V5Q2FsbGJhY2soa2V5RG93bkNhbGxiYWNrID0gbnVsbCwga2V5VXBDYWxsYmFjayA9IG51bGwpe31cclxuICAgIG9uVG91Y2hDYWxsYmFjayh0b3VjaE9uQ2FsbGJhY2sgPSBudWxsLCB0b3VjaE92ZXJDYWxsYmFjayA9IG51bGwpe31cclxuICAgIHN0YXJ0KG9uRW50ZXJGcmFtZUNhbGxiYWNrID0gbnVsbCl7fVxyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVDbGVhcihlbmdpbmUgPSBudWxsKXtcclxuICAgIGVuZ2luZS5jbGVhcigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVEcmF3RnJhbWUoZW5naW5lID0gbnVsbCwgY2VudGVyUG9zID0gbnVsbCwgc3ByaXRlRnJhbWUgPSBudWxsKXtcclxuICAgIGVuZ2luZS5kcmF3RnJhbWUoY2VudGVyUG9zLCBzcHJpdGVGcmFtZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEVuZ2luZURyYXdSZWN0KGVuZ2luZSA9IG51bGwsIGNlbnRlclBvcyA9IG51bGwsIHJlY3QgPSBudWxsKXtcclxuICAgIGVuZ2luZS5kcmF3UmVjdChjZW50ZXJQb3MsIHJlY3QpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVEcmF3TGluZShlbmdpbmUgPSBudWxsLCBjZW50ZXJQb3MgPSBudWxsLCBlbmRQb3MgPSBudWxsKXtcclxuICAgIGVuZ2luZS5kcmF3TGluZShjZW50ZXJQb3MsIGVuZFBvcyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEVuZ2luZURyYXdDaXJjbGUoZW5naW5lID0gbnVsbCwgY2VudGVyUG9zID0gbnVsbCwgcmFkaXVzID0gbnVsbCl7XHJcbiAgICBlbmdpbmUuZHJhd0NpcmNsZShjZW50ZXJQb3MsIHJhZGl1cyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEVuZ2luZUxvYWRSZXNvdXJjZShlbmdpbmUgPSBudWxsLCBpbWdTcmMgPSBcIlwiLCBvbkxvYWRDYWxsYmFjayA9IG51bGwpe1xyXG4gICAgZW5naW5lLmxvYWRSZXNvdXJjZShpbWdTcmMsIG9uTG9hZENhbGxiYWNrKTtcclxufVxyXG5cclxuZnVuY3Rpb24gRW5naW5lT25LZXlDYWxsYmFjayhlbmdpbmUgPSBudWxsLCBrZXlEb3duQ2FsbGJhY2sgPSBudWxsLCBrZXlVcENhbGxiYWNrID0gbnVsbCl7XHJcbiAgICBlbmdpbmUub25LZXlDYWxsYmFjayhrZXlEb3duQ2FsbGJhY2ssIGtleVVwQ2FsbGJhY2spO1xyXG59XHJcblxyXG5mdW5jdGlvbiBFbmdpbmVPblRvdWNoQ2FsbGJhY2soZW5naW5lID0gbnVsbCwgdG91Y2hPbkNhbGxiYWNrID0gbnVsbCwgdG91Y2hPdmVyQ2FsbGJhY2sgPSBudWxsKXtcclxuICAgIGVuZ2luZS5vblRvdWNoQ2FsbGJhY2sodG91Y2hPbkNhbGxiYWNrLCB0b3VjaE92ZXJDYWxsYmFjayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEVuZ2luZVN0YXJ0KGVuZ2luZSA9IG51bGwsIG9uRW50ZXJGcmFtZUNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICBlbmdpbmUuc3RhcnQob25FbnRlckZyYW1lQ2FsbGJhY2spO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgQWJzdHJhY3RFbmdpbmUsIEVuZ2luZUNsZWFyLCBcclxuICAgIEVuZ2luZURyYXdGcmFtZSwgRW5naW5lRHJhd1JlY3QsIEVuZ2luZURyYXdMaW5lLCBFbmdpbmVEcmF3Q2lyY2xlLFxyXG4gICAgRW5naW5lTG9hZFJlc291cmNlLCBFbmdpbmVPbktleUNhbGxiYWNrLCBFbmdpbmVPblRvdWNoQ2FsbGJhY2ssIEVuZ2luZVN0YXJ0XHJcbn0iLCJcclxuLyoqXHJcbiAqIOmAmui/h+WPguaVsOmFjee9ruWIneWni+WMluezu+e7n+i1hOa6kFxyXG4gKiBvcHRpb25zIHtcclxuICogICAgICBkZWJ1ZyA6IGZhbHNlLFxyXG4gKiAgICAgIGZwcyA6IDYwLFxyXG4gKiAgICAgIHRleHR1cmVzIDogW13moLzlvI/op4FMb2FkUmVzb3VyY2UoKeWGhVxyXG4gKiAgICAgIHNjcmVlbi13aWR0aCA6IDgwMCxcclxuICogICAgICBzY3JlZW4taGVpZ2h0IDogODAwLFxyXG4gKiAgICAgIGNhbWVyYSA6IHt9LFxyXG4gKiAgICAgIGVuZ2luZSA6IHt9LFxyXG4gKiAgICAgIGxheWVycyA6IFtcclxuICogICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgdHlwZSA6IDEg5qC85byP5Y+C6ICDdGlsZW1hcOS4gOiKglxyXG4gKiAgICAgICAgICB9XHJcbiAqICAgICAgXVxyXG4gKiAgICAgIGNvbGxpZGUgOiB7fVxyXG4gKiB9XHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0R2FtZShvcHRpb25zID0gbnVsbCkge1xyXG4gICAgLy/pu5jorqTlgLxcclxuICAgIGxldCBzY3JlZW5XaWR0aCA9IG9wdGlvbnNbJ3NjcmVlbi13aWR0aCddO1xyXG4gICAgc2NyZWVuV2lkdGggPSBzY3JlZW5XaWR0aCAmJiBzY3JlZW5XaWR0aCA+IDAgPyBzY3JlZW5XaWR0aCA6IDgwMDtcclxuICAgIGxldCBzY3JlZW5IZWlnaHQgPSBvcHRpb25zWydzY3JlZW4taGVpZ2h0J107XHJcbiAgICBzY3JlZW5IZWlnaHQgPSBzY3JlZW5IZWlnaHQgJiYgc2NyZWVuSGVpZ2h0ID4gMCA/IHNjcmVlbkhlaWdodCA6IDgwMDtcclxuXHJcbiAgICAvL+aRhOWDj+aculxyXG4gICAgc2V0RGVmYXVsdENhbWVyYShcclxuICAgICAgICBDcmVhdGVDYW1lcmFXaXRoRGF0YShvcHRpb25zWydjYW1lcmEnXSwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCkpO1xyXG5cclxuICAgIC8v5byV5pOOXHJcbiAgICBzZXRFbmdpbmUoXHJcbiAgICAgICAgQ3JlYXRlRW5naW5lV2l0aERhdGEob3B0aW9uc1snZW5naW5lJ10sIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpKTtcclxuICAgIFxyXG4gICAgLy/ns7vnu59cclxuICAgIGluaXRTeXN0ZW1zKG9wdGlvbnNbJ2RlYnVnJ10pO1xyXG5cclxuICAgIC8v5byA5ZCv56Kw5pKe57O757ufXHJcbiAgICBpZihvcHRpb25zLmNvbGxpZGUpe1xyXG4gICAgICAgIE9wZW5Db2xsaWRlcihvcHRpb25zLmNvbGxpZGUpO1xyXG5cclxuICAgICAgICAvLyBpZihvcHRpb25zLnVzZVRpbGVDb21iaW5lKXtcclxuICAgICAgICAvLyAgICAgbGV0IHJlc3VsdE5vZGVzID0gQ3JlYXRlQ29tYmluZU5vZGVzKHRpbGVtYXAsIGNvbGxpZGUuYm94SGFuZGxlcik7XHJcbiAgICAgICAgLy8gICAgIHJlc3VsdE5vZGVzLmZvckVhY2gocmVzdWx0ID0+IHtcclxuICAgICAgICAvLyAgICAgICAgIGNvbGxpZGUubG9hZENhbGxiYWNrKHJlc3VsdC52YWx1ZSwgcmVzdWx0LnJlY3QpO1xyXG4gICAgICAgIC8vICAgICB9KTtcclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgLy/oh6rlrprkuYnmlbDmja7nrYlcclxuICAgIGluaXREYXRhcyhvcHRpb25zWydkYXRhcyddKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBUT0RPIOS4tOaXtuaWueazle+8jOS7peWQjuS8mOWMllxyXG4gKiBAcGFyYW0geyp9IG9wdGlvbnMgXHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0RGF0YXMoZGF0YXMgPSBudWxsKXtcclxuICAgIGlmKCFkYXRhcyB8fCBkYXRhcy5sZW5ndGggPT0gMCl7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgZGF0YXMuZm9yRWFjaChkYXRhID0+IHtcclxuICAgICAgICBpbml0RGF0YU9iaihkYXRhKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGluaXREYXRhT2JqKG9wdGlvbnMgPSBudWxsKXtcclxuICAgIGxldCBkYXRhT2JqID0gbnVsbDtcclxuICAgIGlmKG9wdGlvbnNbJ3RpbGVtYXAnXSl7XHJcbiAgICAgICAgZGF0YU9iaiA9IENyZWF0ZVRpbGVNYXBXaXRoRGF0YShvcHRpb25zWyd0aWxlbWFwJ10pO1xyXG4gICAgfVxyXG4gICAgbGV0IG5hbWUgPSBvcHRpb25zWyduYW1lJ107XHJcbiAgICBpZihuYW1lKXtcclxuICAgICAgICBzZXREYXRhQnlOYW1lKG5hbWUsIGRhdGFPYmopO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnR7XHJcbiAgICBpbml0R2FtZVxyXG59IiwiLyoqXHJcbiAqIOaKveixoeWIl+ihqOaTjeS9nFxyXG4gKi9cclxuY2xhc3MgQWJzdHJhY3RMaXN0IHtcclxuICAgIGNvbnN0cnVjdG9yKCl7fVxyXG4gICAgZ2V0KGlkID0gMCl7fSAgICAgICAgICAvL+agueaNrmlk6I635b6XXHJcbiAgICBmaXJzcigpe31cclxuICAgIGxhc3QoKXt9XHJcbiAgICBzaXplKCl7fSAgICAgICAgICAgICAgICAvL+i/lOWbnumVv+W6plxyXG4gICAgYWRkKGRhdGEgPSBudWxsKXt9ICAgICAgLy/lsL7pg6jov73liqBcclxuICAgIHB1c2goZGF0YSA9IG51bGwpe30gICAgIC8v5aS06YOo6L+95YqgXHJcbiAgICBpbnNlcnQoZGF0YSA9IG51bGwsIG9yZGVyID0gMCl7fSAgICAvL+aPkuWFpeWIsOaMh+WumumhuuW6j++8jOebuOWQjG9yZGVy6Ze055qE5YWI5ZCO6aG65bqP55yL5YW35L2T5a6e546w6YC76L6RXHJcbiAgICBwb3AoKXt9ICAgICAgICAgICAgICAgLy/np7vpmaTlpLTpg6jlhYPntKBcclxuICAgIHB1bGwoKXt9ICAgICAgICAgICAgICAvL+enu+mZpOWwvumDqOWFg+e0oFxyXG4gICAgcmVtb3ZlKGlkID0gMCl7fSAgICAgIC8v5qC55o2uaWTnp7vpmaRcclxuICAgIGl0ZXJhdG9yKGNhbGxiYWNrID0gbnVsbCl7fVxyXG4gICAgaXRlcmF0b3JSZXZlcnNlKGNhbGxiYWNrID0gbnVsbCl7fVxyXG4gICAgaXRlcmF0b3JDb21wYXJlKGNhbGxiYWNrID0gbnVsbCl7fVxyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRMaXN0RGF0YShsaXN0ID0gbnVsbCwgaWQgPSAwLCByZXF1aXJlZCA9IGZhbHNlKXtcclxuICAgIGxldCBkYXRhID0gbGlzdC5nZXQoaWQpO1xyXG4gICAgaWYoIWRhdGEgJiYgcmVxdWlyZWQpe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJjYW4ndCBmaW5kIGtleUlkOiBcIiwgaWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldExpc3RGaXJzdChsaXN0ID0gbnVsbCl7XHJcbiAgICByZXR1cm4gbGlzdC5maXJzdCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRMaXN0TGFzdChsaXN0ID0gbnVsbCl7XHJcbiAgICByZXR1cm4gbGlzdC5sYXN0KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldExpc3RTaXplKGxpc3QgPSBudWxsKXtcclxuICAgIHJldHVybiBsaXN0LnNpemUoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tBZGQobGlzdCA9IG51bGwsIGRhdGEgPSBudWxsKXtcclxuICAgIGlmKCFsaXN0IHx8ICFkYXRhIHx8ICFkYXRhLmlkKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiZXJyb3IgcGFyYW0uXCIpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8v5LiN6IO96YeN5aSN5re75YqgXHJcbiAgICBsZXQgZCA9IEdldExpc3REYXRhKGxpc3QsIGlkKTtcclxuICAgIGlmKGQpe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJlcnJvciBpZDolZCBpcyBleGlzdFwiLCBpZCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlsL7pg6jov73liqBcclxuICogQHBhcmFtIHsqfSBsaXN0IFxyXG4gKiBAcGFyYW0geyp9IGRhdGEgXHJcbiAqL1xyXG5mdW5jdGlvbiBBZGRUb0xpc3QobGlzdCA9IG51bGwsIGRhdGEgPSBudWxsKXtcclxuICAgIGlmKGNoZWNrQWRkKGxpc3QsIGRhdGEpKXtcclxuICAgICAgICBsaXN0LmFkZChkYXRhKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOWktOmDqOi/veWKoFxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqIEBwYXJhbSB7Kn0gZGF0YSBcclxuICovXHJcbmZ1bmN0aW9uIFB1c2hUb0xpc3QobGlzdCA9IG51bGwsIGRhdGEgPSBudWxsKXtcclxuICAgIGlmKGNoZWNrQWRkKGxpc3QsIGRhdGEpKXtcclxuICAgICAgICBsaXN0LnB1c2goZGF0YSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmoLnmja7pobrluo/lj7fmj5LlhaVcclxuICogQHBhcmFtIHsqfSBsaXN0IFxyXG4gKiBAcGFyYW0geyp9IGRhdGEgXHJcbiAqIEBwYXJhbSB7Kn0gb3JkZXIgXHJcbiAqL1xyXG5mdW5jdGlvbiBJbnNlcnRUb0xpc3QobGlzdCA9IG51bGwsIGRhdGEgPSBudWxsLCBvcmRlciA9IDApe1xyXG4gICAgaWYoY2hlY2tBZGQobGlzdCwgZGF0YSkpe1xyXG4gICAgICAgIGxpc3QuaW5zZXJ0KGRhdGEsIG9yZGVyKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOWktOmDqOenu+mZpFxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqL1xyXG5mdW5jdGlvbiBQb3BGcm9tTGlzdChsaXN0ID0gbnVsbCl7XHJcbiAgICBsaXN0LnBvcCgpO1xyXG59XHJcblxyXG4vKipcclxuICog5bC+6YOo56e76ZmkXHJcbiAqIEBwYXJhbSB7Kn0gbGlzdCBcclxuICovXHJcbmZ1bmN0aW9uIFB1bGxGcm9tTGlzdChsaXN0ID0gbnVsbCl7XHJcbiAgICBsaXN0LnB1bGwoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOagueaNrmlk56e76ZmkXHJcbiAqIEBwYXJhbSB7Kn0gbGlzdCBcclxuICogQHBhcmFtIHsqfSBpZCBcclxuICovXHJcbmZ1bmN0aW9uIFJlbW92ZUZyb21MaXN0KGxpc3QgPSBudWxsLCBpZCA9IDApe1xyXG4gICAgbGlzdC5yZW1vdmUoaWQpO1xyXG59XHJcblxyXG4vKipcclxuICog5q2j5ZCR6YGN5Y6GXHJcbiAqIEBwYXJhbSB7Kn0gbGlzdCBcclxuICogQHBhcmFtIHsqfSBjYWxsYmFjayBmdW5jKGRhdGEpeyByZXR1cm4gYm9vbH0g6IulYm9vbD10cnVl77yM5YiZ57uI5q2i6YGN5Y6GXHJcbiAqL1xyXG5mdW5jdGlvbiBMaXN0SXRlcmF0b3IobGlzdCA9IG51bGwsIGNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICBpZighbGlzdCB8fCAhY2FsbGJhY2spIHtcclxuICAgICAgICAvL2xvZyBoZXJlXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcbiAgICBsaXN0Lml0ZXJhdG9yKGNhbGxiYWNrKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOWPjeWQkemBjeWOhlxyXG4gKiBAcGFyYW0geyp9IGxpc3QgXHJcbiAqIEBwYXJhbSB7Kn0gY2FsbGJhY2sgXHJcbiAqL1xyXG5mdW5jdGlvbiBMaXN0SXRlcmF0b3JSZXZlcnNlKGxpc3QgPSBudWxsLCBjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgaWYoIWxpc3QgfHwgIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy9sb2cgaGVyZVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgbGlzdC5pdGVyYXRvclJldmVyc2UoY2FsbGJhY2spO1xyXG59XHJcblxyXG4vKipcclxuICog5YaF6YOo5L6d5qyh5a+55q+UXHJcbiAqIEBwYXJhbSB7Kn0gbGlzdCBcclxuICogQHBhcmFtIHsqfSBjYWxsYmFjayBmdW5jKGRhdGExLCBkYXRhMikgcmV0dXJuIGJvb2wg6IulYm9vbD10cnVl77yM5YiZ57uI5q2i6YGN5Y6GXHJcbiAqL1xyXG5mdW5jdGlvbiBMaXN0SXRlcmF0b3JDb21wYXJlKGxpc3QgPSBudWxsLCBjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgaWYoIWxpbmsgfHwgIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy9sb2cgaGVyZVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgbGlzdC5pdGVyYXRvckNvbXBhcmUoY2FsbGJhY2spO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgQWJzdHJhY3RMaXN0LFxyXG4gICAgR2V0TGlzdERhdGEsIEdldExpc3RGaXJzdCwgR2V0TGlzdExhc3QsIEdldExpc3RTaXplLCBcclxuICAgIEFkZFRvTGlzdCwgUHVzaFRvTGlzdCwgSW5zZXJ0VG9MaXN0LCBQb3BGcm9tTGlzdCwgUHVsbEZyb21MaXN0LCBSZW1vdmVGcm9tTGlzdCxcclxuICAgIExpc3RJdGVyYXRvciwgTGlzdEl0ZXJhdG9yUmV2ZXJzZSwgTGlzdEl0ZXJhdG9yQ29tcGFyZVxyXG59IiwiaW1wb3J0IHsgQWJzdHJhY3RMaXN0IH0gZnJvbSBcIi4uLy4uL2ZvdW5kYXRpb24vY29udGFpbmVyL2xpc3RcIjtcclxuXHJcbmNsYXNzIExpbmtOb2RlIHtcclxuXHRjb25zdHJ1Y3RvcihkYXRhID0gbnVsbCwgcHJlcCA9IG51bGwsIG5leHQgPSBudWxsLCBvcmRlciA9IDApIHtcclxuXHRcdHRoaXMuZGF0YSA9IGRhdGE7XHJcblx0XHR0aGlzLnByZXAgPSBwcmVwO1xyXG4gICAgICAgIHRoaXMubmV4dCA9IG5leHQ7XHJcbiAgICAgICAgdGhpcy5vcmRlciA9IG9yZGVyO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgTGlua0xpc3QgZXh0ZW5kcyBBYnN0cmFjdExpc3Qge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0dGhpcy5oZWFkID0gbmV3IExpbmtOb2RlKCk7XHRcdC8vZW1wdHkgZGF0YSBub2RlXHJcblx0XHR0aGlzLnRhaWwgPSBuZXcgTGlua05vZGUoKTtcclxuXHRcdHRoaXMuaGVhZC5uZXh0ID0gdGhpcy50YWlsO1xyXG5cdFx0dGhpcy50YWlsLnByZXAgPSB0aGlzLmhlYWQ7XHJcblx0XHR0aGlzLl9tYXAgPSBuZXcgTWFwKCk7XHJcblx0XHR0aGlzLl9zaXplID0gMDtcclxuICAgICAgICB0aGlzLl9kZWxMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5fY3VyciA9IHRoaXMuaGVhZDtcclxuICAgICAgICB0aGlzLl9sb2NrID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldChpZCA9IDApe1xyXG4gICAgICAgIGxldCBub2RlID0gdGhpcy5fbWFwLmdldChpZCk7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUgPyBub2RlLmRhdGEgOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGZpcnN0KCl7XHJcbiAgICAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQubmV4dDtcclxuICAgICAgICByZXR1cm4gbm9kZSA9PSB0aGlzLnRhaWwgPyBudWxsIDogbm9kZS5kYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIGxhc3QoKXtcclxuICAgICAgICBsZXQgbm9kZSA9IHRoaXMudGFpbC5wcmVwO1xyXG4gICAgICAgIHJldHVybiBub2RlID09IHRoaXMuaGVhZCA/IG51bGwgOiBub2RlLmRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgc2l6ZSgpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZChkYXRhID0gbnVsbCl7XHJcbiAgICAgICAgYWRkVG9MaW5rKHRoaXMsIGRhdGEsIHRoaXMudGFpbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVzaChkYXRhID0gbnVsbCl7XHJcbiAgICAgICAgYWRkVG9MaW5rKHRoaXMsIGRhdGEsIHRoaXMuaGVhZC5uZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICBpbnNlcnQoZGF0YSA9IG51bGwsIG9yZGVyID0gMCl7XHJcbiAgICAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQubmV4dDtcclxuICAgICAgICB3aGlsZShub2RlICE9IHRoaXMudGFpbCl7XHJcbiAgICAgICAgICAgIGlmKG9yZGVyIDwgbm9kZS5vcmRlcil7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBub2RlID0gbm9kZS5uZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBhZGRUb0xpbmsodGhpcywgZGF0YSwgbm9kZSwgb3JkZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIHBvcCgpe1xyXG4gICAgICAgIHJlbW92ZVdpdGhDaGVjayh0aGlzLCB0aGlzLmhlYWQubmV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVsbCgpe1xyXG4gICAgICAgIHJlbW92ZVdpdGhDaGVjayh0aGlzLCB0aGlzLnRhaWwucHJlcCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlKGlkID0gMCl7XHJcbiAgICAgICAgcmVtb3ZlV2l0aENoZWNrKHRoaXMsIHRoaXMuX21hcC5nZXQoaWQpKTtcclxuICAgIH1cclxuXHJcbiAgICBpdGVyYXRvcihjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgICAgIHRoaXMuX2xvY2sgPSB0cnVlO1xyXG4gICAgICAgIGxldCBub2RlID0gdGhpcy5oZWFkLm5leHQ7XHJcbiAgICAgICAgd2hpbGUobm9kZSAhPSB0aGlzLnRhaWwpe1xyXG4gICAgICAgICAgICBpZihjYWxsYmFjayhub2RlLmRhdGEpKXtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLm5leHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvY2sgPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSh0aGlzLl9kZWxMaXN0Lmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKHRoaXMsIHRoaXMuX2RlbExpc3QucG9wKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpdGVyYXRvclJldmVyc2UoY2FsbGJhY2sgPSBudWxsKXtcclxuICAgICAgICB0aGlzLl9sb2NrID0gdHJ1ZTtcclxuICAgICAgICBsZXQgbm9kZSA9IHRoaXMudGFpbC5wcmVwO1xyXG4gICAgICAgIHdoaWxlKG5vZGUgIT0gdGhpcy5oZWFkKXtcclxuICAgICAgICAgICAgaWYoY2FsbGJhY2sobm9kZS5kYXRhKSl7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBub2RlID0gbm9kZS5wcmVwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2NrID0gZmFsc2U7XHJcbiAgICAgICAgd2hpbGUodGhpcy5fZGVsTGlzdC5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgcmVtb3ZlTm9kZSh0aGlzLCB0aGlzLl9kZWxMaXN0LnBvcCgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaXRlcmF0b3JDb21wYXJlKGNhbGxiYWNrID0gbnVsbCl7XHJcbiAgICAgICAgdGhpcy5fbG9jayA9IHRydWU7XHJcbiAgICAgICAgbGV0IG91dE5vZGUgPSB0aGlzLmhlYWQubmV4dDtcclxuICAgICAgICB3aGlsZShvdXROb2RlICE9IHRoaXMudGFpbCl7XHJcbiAgICAgICAgICAgIGxldCBpbk5vZGUgPSBvdXROb2RlLm5leHQ7XHJcbiAgICAgICAgICAgIHdoaWxlKGluTm9kZSAhPSB0aGlzLnRhaWwpe1xyXG4gICAgICAgICAgICAgICAgaWYoY2FsbGJhY2sob3V0Tm9kZS5kYXRhLCBpbk5vZGUuZGF0YSkpe1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5Ob2RlID0gaW5Ob2RlLm5leHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3V0Tm9kZSA9IG91dE5vZGUubmV4dDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9jayA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlKHRoaXMuX2RlbExpc3QubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUodGhpcywgdGhpcy5fZGVsTGlzdC5wb3AoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRUb0xpbmsobGluayA9IG51bGwsIGRhdGEgPSBudWxsLCBuZXh0ID0gbnVsbCwgb3JkZXIgPSAwKXtcclxuICAgIC8v5paw6IqC54K56L+e5o6lXHJcbiAgICBsZXQgcHJlcCA9IG5leHQucHJlcDtcclxuICAgIGxldCBub2RlID0gbmV3IExpbmtOb2RlKGRhdGEsIHByZXAsIG5leHQsIG9yZGVyKTtcclxuICAgIHByZXAubmV4dCA9IG5vZGU7XHJcbiAgICBuZXh0LnByZXAgPSBub2RlO1xyXG5cclxuICAgIGxpbmsuX21hcC5zZXQoZGF0YS5pZCwgbm9kZSk7XHJcbiAgICBsaW5rLl9zaXplKys7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZVdpdGhDaGVjayhsaW5rID0gbnVsbCwgdGFyZ2V0Tm9kZSA9IG51bGwpe1xyXG4gICAgaWYoIWxpbmsgfHwgIXRhcmdldE5vZGUgfHwgbGluay5fc2l6ZSA8PSAwKXtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZihsaW5rLl9sb2NrKXtcclxuICAgICAgICBsaW5rLl9kZWxMaXN0LnB1c2godGFyZ2V0Tm9kZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlTm9kZShsaW5rLCB0YXJnZXROb2RlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlTm9kZShsaW5rID0gbnVsbCwgbm9kZSA9IG51bGwpe1xyXG4gICAgbGluay5fbWFwLmRlbGV0ZShrZXlJZCk7XHJcbiAgICBsZXQgcCA9IG5vZGUucHJlcDtcclxuICAgIGxldCBuID0gbm9kZS5uZXh0O1xyXG4gICAgcC5uZXh0ID0gbjtcclxuICAgIG4ucHJlcCA9IHA7XHJcbiAgICBsaW5rLl9zaXplLS07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld0xpbmsoKXtcclxuICAgIHJldHVybiBuZXcgTGlua0xpc3QoKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIE5ld0xpbmtcclxufSIsImltcG9ydCB7IE5ld0xpbmsgfSBmcm9tIFwiLi4vLi4vbGlzdC9saW5rbGlzdFwiO1xyXG5pbXBvcnQgeyBJbnNlcnRUb0xpc3QsIEdldExpc3REYXRhLCBSZW1vdmVGcm9tTGlzdCwgTGlzdEl0ZXJhdG9yIH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vY29udGFpbmVyL2xpc3RcIjtcclxuXHJcbi8qKlxyXG4gKiDmmL7npLrlm77lsYJcclxuICogIG9yZGVy6LaK5L2O77yM6LaK5YWI5riy5p+T77yM5ZCO5riy5p+T55qE5Lya6YGu5L2P5YmN6Z2i5riy5p+T55qEXHJcbiAqL1xyXG5jbGFzcyBMYXllciB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcmRlciA9IDApe1xyXG4gICAgICAgIHRoaXMuaWQgPSBvcmRlcjtcclxuICAgICAgICB0aGlzLm9yZGVyID0gb3JkZXI7XHJcbiAgICAgICAgdGhpcy5saXN0ID0gTmV3TGluaygpO1xyXG4gICAgfVxyXG59XHJcblxyXG52YXIgbGF5ZXJMaXN0ID0gTmV3TGluaygpO1xyXG5mdW5jdGlvbiBhZGRMYXllcihvcmRlciA9IDApe1xyXG4gICAgbGV0IGxheWVyID0gbmV3IExheWVyKG9yZGVyKTtcclxuICAgIEluc2VydFRvTGlzdChsYXllckxpc3QsIGxheWVyKTtcclxuICAgIHJldHVybiBsYXllcjtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0TGF5ZXIob3JkZXIgPSAwKXtcclxuICAgIGxldCBsYXllciA9IEdldExpc3REYXRhKGxheWVyTGlzdCwgb3JkZXIpO1xyXG4gICAgaWYoIWxheWVyKXtcclxuICAgICAgICBsYXllciA9IGFkZExheWVyKG9yZGVyKTtcclxuICAgIH1cclxuICAgIHJldHVybiBsYXllcjtcclxufVxyXG5cclxuZnVuY3Rpb24gSXRlcmF0b3JMYXllcnMoY2FsbGJhY2sgPSBudWxsKXtcclxuICAgIExpc3RJdGVyYXRvcihsYXllckxpc3QsIGxheWVyID0+IHtcclxuICAgICAgICBMaXN0SXRlcmF0b3IobGF5ZXIubGlzdCwgZGlzcGxheVR1cGxlID0+IHtcclxuICAgICAgICAgICAgY2FsbGJhY2soZGlzcGxheVR1cGxlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIEFkZFRvTGF5ZXIoZGlzcGxheVR1cGxlID0gbnVsbCl7XHJcbiAgICBsZXQgbGF5ZXIgPSBHZXRMYXllcihkaXNwbGF5VHVwbGUubGF5ZXJPcmRlcik7XHJcbiAgICBJbnNlcnRUb0xpc3QobGF5ZXIubGlzdCwgZGlzcGxheVR1cGxlLCBkaXNwbGF5VHVwbGUub3JkZXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBSZW1vdmVGcm9tTGF5ZXIoZGlzcGxheVR1cGxlID0gbnVsbCl7XHJcbiAgICBsZXQgbGF5ZXIgPSBHZXRMYXllcihkaXNwbGF5VHVwbGUub3JkZXIpO1xyXG4gICAgUmVtb3ZlRnJvbUxpc3QobGF5ZXIubGlzdCwgZGlzcGxheVR1cGxlLmlkKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIEdldExheWVyLCBJdGVyYXRvckxheWVycywgQWRkVG9MYXllciwgUmVtb3ZlRnJvbUxheWVyXHJcbn0iLCIvKipcclxuICogZGF0YeWwseaYr+WbvueJh+aWh+S7tlxyXG4gKiB3aWR0aCwgaGVpZ2h05Y+v6YCJ77yM5pyA5aW95pyJXHJcbiAqL1xyXG5jbGFzcyBCaXRtYXAge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSA9IG51bGwsIHdpZHRoID0gMCwgaGVpZ2h0ID0gMCkge1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBDcmVhdGVCaXRtYXAoYml0bWFwRGF0YSA9IG51bGwsIHdpZHRoID0gMCwgaGVpZ2h0ID0gMCl7XHJcbiAgICByZXR1cm4gbmV3IEJpdG1hcChiaXRtYXBEYXRhLCB3aWR0aCwgaGVpZ2h0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOS4gOW8oOWbvuS4reeahOS4gOS4quWMuuWfn++8jOe6ueeQhuW4p+aIlueyvueBteW4p++8jOWNleS+i++8jOWSjOW8leaTjuacieWFs1xyXG4gKiDnsr7ngbXluKfnlKjkuo7moIflh7rkuIDlvKDnurnnkIblm77nmoTmjIflrprlj5bmnZDljLrln5/vvIzku6Xlj4rnm7jlr7nnmoTmmL7npLrkvY3nva5cclxuICovXHJcbmNsYXNzIFNwcml0ZUZyYW1lIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUgPSBcIlwiLCByZWN0ID0gbnVsbCwgYml0bWFwID0gbnVsbCwgeCA9IDAsIHkgPSAwKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLnJlY3QgPSByZWN0O1xyXG4gICAgICAgIHRoaXMuYml0bWFwID0gYml0bWFwO1xyXG4gICAgICAgIHRoaXMuYml0bWFwWCA9IHg7XHJcbiAgICAgICAgdGhpcy5iaXRtYXBZID0geTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gQ3JlYXRlU3ByaXRlRnJhbWUobmFtZSA9IFwiXCIsIGJpdG1hcCA9IG51bGwsIHggPSAwLCB5ID0gMCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwKXtcclxuICAgIGxldCByZWN0ID0gTmV3UmVjdCh3aWR0aCwgaGVpZ2h0KTtcclxuICAgIGxldCBmID0gbmV3IFNwcml0ZUZyYW1lKG5hbWUsIHJlY3QsIGJpdG1hcCwgeCwgeSk7XHJcbiAgICByZXR1cm4gZjtcclxufVxyXG5cclxuLyoqXHJcbiAqIHNwcml0ZUZyYW1l5byA5aeL57uY5Yi255qE5Z2Q5qCH77yM5bem5LiK6KeS5byA5aeL77yM5LiOcG9z5peg5YWzXHJcbiAqIEBwYXJhbSB7Kn0gc3ByaXRlRnJhbWUgXHJcbiAqL1xyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZVN0YXJ0WChzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHNwcml0ZUZyYW1lLmJpdG1hcFg7XHJcbn1cclxuZnVuY3Rpb24gR2V0U3ByaXRlRnJhbWVTdGFydFkoc3ByaXRlRnJhbWUgPSBudWxsKXtcclxuICAgIHJldHVybiBzcHJpdGVGcmFtZS5iaXRtYXBZO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZVJlY3Qoc3ByaXRlRnJhbWUgPSBudWxsKXtcclxuICAgIHJldHVybiBzcHJpdGVGcmFtZS5yZWN0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZVdpZHRoKHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0UmVjdFdpZHRoKHNwcml0ZUZyYW1lLnJlY3QpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRTcHJpdGVGcmFtZUhhbGZXaWR0aChzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIEdldFJlY3RIYWxmV2lkdGgoc3ByaXRlRnJhbWUucmVjdCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lSGVpZ2h0KHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0UmVjdEhlaWdodChzcHJpdGVGcmFtZS5yZWN0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gR2V0U3ByaXRlRnJhbWVIYWxmSGVpZ2h0KHNwcml0ZUZyYW1lID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0UmVjdEhhbGZIZWlnaHQoc3ByaXRlRnJhbWUucmVjdCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldFNwcml0ZUZyYW1lQml0bWFwRGF0YShzcHJpdGVGcmFtZSA9IG51bGwpe1xyXG4gICAgcmV0dXJuIHNwcml0ZUZyYW1lLmJpdG1hcC5kYXRhO1xyXG59XHJcblxyXG5leHBvcnR7XHJcbiAgICBDcmVhdGVCaXRtYXAsIENyZWF0ZVNwcml0ZUZyYW1lLCBcclxuICAgIEdldFNwcml0ZUZyYW1lU3RhcnRYLCBHZXRTcHJpdGVGcmFtZVN0YXJ0WSwgR2V0U3ByaXRlRnJhbWVSZWN0LFxyXG4gICAgR2V0U3ByaXRlRnJhbWVXaWR0aCwgR2V0U3ByaXRlRnJhbWVIYWxmV2lkdGgsIEdldFNwcml0ZUZyYW1lSGVpZ2h0LCBHZXRTcHJpdGVGcmFtZUhhbGZIZWlnaHQsXHJcbiAgICBHZXRTcHJpdGVGcmFtZUJpdG1hcERhdGFcclxufSIsImltcG9ydCB7IEdldFJlYWxQb3MsIEdldFBvcywgR2V0T2Zmc2V0IH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vb2Zmc2V0L2Jhc2VcIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBHYW1lT2JqZWN0IH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vY29tcG9uZW50L2Vjc1wiO1xyXG5pbXBvcnQgeyBOZXdMaW5rIH0gZnJvbSBcIi4uLy4uL2xpc3QvbGlua2xpc3RcIjtcclxuaW1wb3J0IHsgQWRkVG9MaXN0LCBHZXRMaXN0RGF0YSB9IGZyb20gXCIuLi8uLi8uLi9mb3VuZGF0aW9uL2NvbnRhaW5lci9saXN0XCI7XHJcbmltcG9ydCB7IE5ld1BvcywgVXBkYXRlUG9zIH0gZnJvbSBcIi4uLy4uLy4uL2ZvdW5kYXRpb24vc3RydWN0dXJlL2dlb21ldHJpY1wiO1xyXG5pbXBvcnQgeyBOZXdSZWN0UG9zUmVsYXRpb24gfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9vZmZzZXQvcmVjdFwiO1xyXG5pbXBvcnQgeyBHZXRTcHJpdGVGcmFtZVJlY3QgfSBmcm9tIFwiLi4vLi4vLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZnJhbWVcIjtcclxuXHJcbi8qKlxyXG4gKiDmmL7npLrnu4Tku7bvvIzljIXlkKvkuIDkupvmmL7npLrlj4LmlbBcclxuICovXHJcbmNsYXNzIFJlbmRlckNvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XHJcblx0Y29uc3RydWN0b3IoZW50aXR5SWQgPSAwLCBpc29tZXRyaWNzID0gZmFsc2UsIGFuZ2xlID0gMCwgc2NhbGUgPSAxKSB7XHJcbiAgICAgICAgc3VwZXIoZW50aXR5SWQpO1xyXG4gICAgICAgIHRoaXMuaXNvbWV0cmljcyA9IGlzb21ldHJpY3M7XHJcbiAgICAgICAgdGhpcy5hbmdsZSA9IGFuZ2xlO1xyXG4gICAgICAgIHRoaXMuc2NhbGUgPSBzY2FsZTtcclxuXHR9XHJcbn1cclxuXHJcbnZhciByZW5kZXJDb21zID0gTmV3TGluaygpO1xyXG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJDb21wb25lbnQoZW50aXR5SWQgPSAwLCBvcHRpb25zID0gbnVsbCkge1xyXG4gICAgLy/pu5jorqTlgLxcclxuICAgIG9wdGlvbnMgPSBvcHRpb25zID8gb3B0aW9ucyA6IHt9O1xyXG4gICAgbGV0IGNvbSA9IG5ldyBSZW5kZXJDb21wb25lbnQoZW50aXR5SWQsIG9wdGlvbnMuaXNvbWV0cmljcywgb3B0aW9ucy5hbmdsZSwgb3B0aW9ucy5zY2FsZSk7XHJcbiAgICBBZGRUb0xpc3QocmVuZGVyQ29tcywgY29tKTtcclxuICAgIHJldHVybiBjb207XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmn6Xmib7muLLmn5PmmL7npLrnu4Tku7bvvIzmmoLml7bov5nmoLfmkJ5cclxuICogb3B0aW9ucyA6IHtcclxuICogICAgICBpc29tZXRyaWMgOiBmYWxzZSxcclxuICogICAgICBhbmdsZSA6IDE4MCxcclxuICogICAgICBzY2FsZSA6IDAuNVxyXG4gKiB9XHJcbiAqL1xyXG5mdW5jdGlvbiBHZXRSZW5kZXJDb21wb25lbnQoZW50aXR5SWQgPSAwLCBvcHRpb25zID0gbnVsbCkge1xyXG4gICAgbGV0IGNvbSA9IEdldExpc3REYXRhKHJlbmRlckNvbXMsIGVudGl0eUlkKTtcclxuICAgIHJldHVybiBjb20gPyBjb20gOiBjcmVhdGVSZW5kZXJDb21wb25lbnQoZW50aXR5SWQsIG9wdGlvbnMpO1xyXG59XHJcblxyXG4vKipcclxuICog5pi+56S65YWD5Lu2XHJcbiAqICDlkoxlbnRpdHnlhbPns7vkuI3lpKfvvIzkuIDkuKplbnRpdHnlj6/ku6Xmi6XmnInlpKfkuo7kuIDkuKpEaXNwbGF5VHVwbGVcclxuICogIOmcgOimgeiuvuiuoeacuuWItumBv+WFjea7peeUqOmXrumimFxyXG4gKi9cclxuY2xhc3MgRGlzcGxheVR1cGxlIGV4dGVuZHMgR2FtZU9iamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihzcHJpdGVGcmFtZSA9IG51bGwsIHJlbmRlckNvbSA9IG51bGwsIHJlY3RQb3NSZWwgPSBudWxsLCBvcmRlciA9IDAsIGxheWVyT3JkZXIgPSAwKXtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcclxuICAgICAgICB0aGlzLnJlbmRlckNvbSA9IHJlbmRlckNvbTtcclxuICAgICAgICB0aGlzLnJlY3RQb3NSZWwgPSByZWN0UG9zUmVsO1xyXG4gICAgICAgIHRoaXMub3JkZXIgPSBvcmRlcjtcclxuICAgICAgICB0aGlzLmxheWVyT3JkZXIgPSBsYXllck9yZGVyO1xyXG4gICAgICAgIHRoaXMuaXNvUG9zID0gTmV3UG9zKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE5ld0Rpc3BsYXllcihlbnRpdHlJZCA9IDAsIHNwcml0ZUZyYW1lID0gbnVsbCwgb2Zmc2V0ID0gbnVsbCwgb3JkZXIgPSAwLCBsYXllck9yZGVyID0gMCl7XHJcbiAgICBsZXQgcmVuZGVyQ29tID0gR2V0UmVuZGVyQ29tcG9uZW50KGVudGl0eUlkKTtcclxuICAgIGxldCBycCA9IE5ld1JlY3RQb3NSZWxhdGlvbihlbnRpdHlJZCwgb2Zmc2V0LCBHZXRTcHJpdGVGcmFtZVJlY3Qoc3ByaXRlRnJhbWUpKTtcclxuICAgIGxldCBkcyA9IG5ldyBEaXNwbGF5VHVwbGUoc3ByaXRlRnJhbWUsIHJlbmRlckNvbSwgcnAsIG9yZGVyLCBsYXllck9yZGVyKTtcclxuICAgIHJldHVybiBkcztcclxufVxyXG5cclxuZnVuY3Rpb24gSXNEaXNwbGF5SVNPbWV0cmljcyhkaXNwbGF5ZXIgPSBudWxsKXtcclxuICAgIHJldHVybiBkaXNwbGF5ZXIucmVuZGVyQ29tLmlzb21ldHJpY3M7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldERpc3BsYXlTcHJpdGVGcmFtZShkaXNwbGF5ZXIgPSBudWxsKXtcclxuICAgIHJldHVybiBkaXNwbGF5ZXIuc3ByaXRlRnJhbWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldERpc3BsYXlDZW50ZXJQb3MoZGlzcGxheWVyID0gbnVsbCl7XHJcbiAgICByZXR1cm4gR2V0UmVhbFBvcyhkaXNwbGF5ZXIucmVjdFBvc1JlbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdldERpc3BsYXlJc29Qb3MoZGlzcGxheWVyID0gbnVsbCl7XHJcbiAgICByZXR1cm4gZGlzcGxheWVyLmlzb1BvcztcclxufVxyXG5cclxuZnVuY3Rpb24gVXBkYXRlSXNvUG9zKGRpc3BsYXllciA9IG51bGwpe1xyXG4gICAgbGV0IHBvcyA9IEdldFBvcyhkaXNwbGF5VHVwbGUucmVjdFBvc1JlbCk7XHJcbiAgICBsZXQgb2Zmc2V0ID0gR2V0T2Zmc2V0KGRpc3BsYXlUdXBsZS5yZWN0UG9zUmVsKTtcclxuICAgIFVwZGF0ZVBvcyhkaXNwbGF5ZXIuaXNvUG9zLFxyXG4gICAgICAgIChwb3MueCAtIHBvcy55KSAqIDAuNSArIG9mZnNldC54LFxyXG4gICAgICAgIChwb3MueCArIHBvcy55KSAqIDAuNSArIG9mZnNldC55KTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIEdldFJlbmRlckNvbXBvbmVudCwgTmV3RGlzcGxheWVyLCBcclxuICAgIElzRGlzcGxheUlTT21ldHJpY3MsIEdldERpc3BsYXlTcHJpdGVGcmFtZSwgR2V0RGlzcGxheUNlbnRlclBvcyxcclxuICAgIEdldERpc3BsYXlJc29Qb3MsIFVwZGF0ZUlzb1Bvc1xyXG59IiwiaW1wb3J0IHsgR2V0RW5naW5lIH0gZnJvbSBcIi4uL3Jlc291cmNlXCI7XHJcbmltcG9ydCB7IExpc3RJdGVyYXRvciB9IGZyb20gXCIuLi8uLi9mb3VuZGF0aW9uL2NvbnRhaW5lci9saXN0XCI7XHJcbmltcG9ydCB7IE5ld0xpbmsgfSBmcm9tIFwiLi4vLi4vbGliL2xpc3QvbGlua2xpc3RcIjtcclxuaW1wb3J0IHsgRW5naW5lU3RhcnQgfSBmcm9tIFwiLi4vLi4vbGliL2VuZ2luZS9iYXNlXCI7XHJcbmltcG9ydCB7IEdldFJlbmRlclVwZGF0ZVN5c3RlbSB9IGZyb20gXCIuLi8uLi9saWIvdmlldy9zeXN0ZW1cIjtcclxuXHJcbi8qKlxyXG4gKiDkuLvns7vnu5/liJfooahcclxuICovXHJcbnZhciBsb2dpY1N5c3RlbXMgPSBOZXdMaW5rKCk7XHJcbnZhciByZW5kZXJTeXN0ZW0gPSBudWxsO1xyXG5mdW5jdGlvbiBpbml0U3lzdGVtcyhkZWJ1ZyA9IGZhbHNlKXtcclxuICAgIC8vSW5zZXJ0VG9MaW5rKGxvZ2ljU3lzdGVtcywgR2V0QWN0aW9uU3lzdGVtKCkpO1xyXG4gICAgLy9JbnNlcnRUb0xpbmsobG9naWNTeXN0ZW1zLCBHZXRQb3NVcGRhdGVTeXN0ZW0oKSk7XHJcbiAgICByZW5kZXJTeXN0ZW0gPSBHZXRSZW5kZXJVcGRhdGVTeXN0ZW0oKTtcclxufVxyXG5cclxudmFyIGxvZ2ljVGljayA9IDE2OyAgICAgLy82MGZwc1xyXG52YXIgcmVuZGVyVGljayA9IDQxOyAgICAvLzI0ZnBzXHJcbnZhciBfdDEgPSAwO1xyXG52YXIgX3QyID0gMDtcclxuZnVuY3Rpb24gcnVuV2l0aFNjZW5lKHNjZW5lID0gbnVsbCl7XHJcbiAgICBMaXN0SXRlcmF0b3IobG9naWNTeXN0ZW1zLCBzeXN0ZW0gPT4ge1xyXG4gICAgICAgIHN5c3RlbS5vblN0YXJ0KCk7XHJcbiAgICB9KTtcclxuICAgIHJlbmRlclN5c3RlbS5vblN0YXJ0KCk7XHJcbiAgICBzY2VuZS5vblN0YXJ0KCk7XHJcblxyXG4gICAgLy9tYWluIGxvb3BcclxuICAgIEVuZ2luZVN0YXJ0KEdldEVuZ2luZSgpLCBkdCA9PiB7XHJcbiAgICAgICAgX3QxICs9IGR0O1xyXG4gICAgICAgIGlmKF90MSA+PSBsb2dpY1RpY2spe1xyXG4gICAgICAgICAgICBfdDEgLT0gbG9naWNUaWNrO1xyXG4gICAgICAgICAgICBzY2VuZS5vblVwZGF0ZShkdCk7XHJcbiAgICAgICAgICAgIExpc3RJdGVyYXRvcihsb2dpY1N5c3RlbXMsIHN5c3RlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzeXN0ZW0ub25VcGRhdGUoZHQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF90MiArPSBkdDtcclxuICAgICAgICBpZihfdDIgPj0gcmVuZGVyVGljayl7XHJcbiAgICAgICAgICAgIF90MiAtPSByZW5kZXJUaWNrO1xyXG4gICAgICAgICAgICByZW5kZXJTeXN0ZW0ub25VcGRhdGUoZHQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRTeXN0ZW0oc3lzdGVtID0gbnVsbCl7XHJcbiAgICBpZighc3lzdGVtKXtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBJbnNlcnRUb0xpbmsobG9naWNTeXN0ZW1zLCBzeXN0ZW0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wU3lzdGVtKCl7XHJcbiAgICBMaXN0SXRlcmF0b3IobG9naWNTeXN0ZW1zLCBzeXN0ZW0gPT4ge1xyXG4gICAgICAgIHN5c3RlbS5vbkVuZCgpO1xyXG4gICAgfSk7XHJcbiAgICByZW5kZXJTeXN0ZW0ub25FbmQoKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIGluaXRTeXN0ZW1zLCBydW5XaXRoU2NlbmUsIGFkZFN5c3RlbSwgc3RvcFN5c3RlbVxyXG59IiwiaW1wb3J0IHsgaW5pdEdhbWUgfSBmcm9tIFwiLi9zZXJ2aWNlL2luaXRcIjtcclxuaW1wb3J0IHsgcnVuV2l0aFNjZW5lLCBzdG9wU3lzdGVtIH0gZnJvbSBcIi4vc2VydmljZS9zeXN0ZW1cIjtcclxuaW1wb3J0IHsgR2V0U2NlbmUsIEdldEVuZ2luZSwgU2V0U3ByaXRlRnJhbWUgfSBmcm9tIFwiLi9yZXNvdXJjZVwiO1xyXG5pbXBvcnQgeyBDcmVhdGVCaXRtYXAgfSBmcm9tIFwiLi4vZm91bmRhdGlvbi9zdHJ1Y3R1cmUvZnJhbWVcIjtcclxuXHJcbi8qKlxyXG4gKiBvcHRpb25zIHtcclxuICogICAgICB0ZXh0dXJlcyA6IOagvOW8j+ingUxvYWRSZXNvdXJjZSgp5YaFXHJcbiAqICAgICAgc2NyZWVuIDoge1xyXG4gKiAgICAgICAgICB3aWR0aCA6IDgwMCxcclxuICogICAgICAgICAgaGVpZ2h0IDogODAwXHJcbiAqICAgICAgfSxcclxuICogICAgICBmcHMgOiA2MCxcclxuICogICAgICBkZWJ1ZyA6IGZhbHNlLFxyXG4gKiAgICAgIGNhbWVyYSA6IHtcclxuICogICAgICAgICAgeCA6IDAsXHJcbiAqICAgICAgICAgIHkgOiAwXHJcbiAqICAgICAgfSxcclxuICogICAgICB0aWxlbWFwIDog5qC85byP5Y+C6ICDdGlsZW1hcOS4gOiKglxyXG4gKiAgICAgIGtleUhhbmRsZXIgOiBmdW5jdGlvbih0eXBlLCBrZXlDb2RlKSAgIHR5cGU9MSA9IGRvd24sIHR5cGU9MiA9IHVwXHJcbiAqICAgICAgY29sbGlkZSA6IHtcclxuICogICAgICAgICAgdXNlQm94IDogZmFsc2UsXHJcbiAqICAgICAgICAgIHVzZUdyb3VwIDogZmFsc2UsXHJcbiAqICAgICAgICAgIHBhaXJzIDogW1xyXG4gKiAgICAgICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgICAgIHRlYW0xIDogMSxcclxuICogICAgICAgICAgICAgICAgICB0ZWFtMiA6IDJcclxuICogICAgICAgICAgICAgIH1cclxuICogICAgICAgICAgXSxcclxuICogICAgICAgICAgaGFuZGxlciA6IGZ1bmN0aW9uKGR0LCBjb2xsaWRlcjEsIGNvbGxpZGVyMilcclxuICogICAgICB9XHJcbiAqIH1cclxuICogVE9ETyBzY2VuZeWPr+S7peaYr+S4gOS4qmFjdGlvbj9cclxuICovXHJcbmZ1bmN0aW9uIFN0YXJ0KG9wdGlvbnMgPSBudWxsLCBzY2VuZSA9IG51bGwpe1xyXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XHJcbiAgICBpZihvcHRpb25zWyd0ZXh0dXJlcyddKXtcclxuICAgICAgICBsb2FkUmVzb3VyY2Uob3B0aW9uc1sndGV4dHVyZXMnXSwgbnVsbCwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpbml0R2FtZShvcHRpb25zKTtcclxuICAgICAgICAgICAgcnVuV2l0aFNjZW5lKHNjZW5lKTtcclxuICAgICAgICB9KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGluaXRHYW1lKG9wdGlvbnMpO1xyXG4gICAgICAgIHJ1bldpdGhTY2VuZShzY2VuZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFN0b3AoKXtcclxuICAgIEdldFNjZW5lKCkub25FbmQoKTtcclxuICAgIC8vc3RvcFN5c3RlbXMoKTtcclxuICAgIHN0b3BTeXN0ZW0oKTtcclxuICAgIFN0b3BFbmdpbmUoZ2V0RW5naW5lKCkpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIOWKoOi9vei1hOa6kO+8jOWIm+W7uueyvueBteW4p1xyXG4gKiB0ZXh0dXJlcyA6IFtcclxuICogICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgaW1nIDogXCJyZXMvYS5wbmdcIixcclxuICogICAgICAgICAgICAgIGZyYW1lcyA6IFtcclxuICogICAgICAgICAgICAgICAgICB7XHJcbiAqICAgICAgICAgICAgICAgICAgICAgIG5hbWUgOiBcIndhbGsxXCJcclxuICogICAgICAgICAgICAgICAgICAgICAgdGV4dHVyZUFyZWEgOiB7XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICB4IDogMCxcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHkgOiAwLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggOiAwLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IDogMFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAqICAgICAgICAgICAgICAgICAgfVxyXG4gKiAgICAgICAgICAgICAgXVxyXG4gKiAgICAgICAgICB9XHJcbiAqICAgICAgXSxcclxuICovXHJcbmZ1bmN0aW9uIGxvYWRSZXNvdXJjZSh0ZXh0dXJlc0RhdGEgPSBudWxsLCBPbmxvYWRDYWxsYmFjayA9IG51bGwsIE9uQ29tcGxldGVDYWxsYmFjayA9IG51bGwpe1xyXG4gICAgLy/liqDovb3lm77lg4/lubbliJvlu7rmmL7npLrluKdcclxuICAgIGlmKCF0ZXh0dXJlc0RhdGEgfHwgdGV4dHVyZXNEYXRhLmxlbmd0aCA9PSAwKXtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgX2NvdW50ID0gMDtcclxuICAgIHRleHR1cmVzRGF0YS5mb3JFYWNoKHQgPT57XHJcbiAgICAgICAgRW5naW5lTG9hZFJlc291cmNlKEdldEVuZ2luZSgpLCB0LmltZywgYml0bWFwRGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBiaXRtYXAgPSBDcmVhdGVCaXRtYXAoYml0bWFwRGF0YSwgYml0bWFwRGF0YS53aWR0aCwgYml0bWFwRGF0YS5oZWlnaHQpO1xyXG4gICAgICAgICAgICB0LmZyYW1lcy5mb3JFYWNoKGZyYW1lRGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVTcHJpdGVGcmFtZVdpdGhEYXRhKGZyYW1lRGF0YS5uYW1lLCBiaXRtYXAsIGZyYW1lRGF0YS50ZXh0dXJlQXJlYSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBfY291bnQrKztcclxuICAgICAgICAgICAgaWYoT25sb2FkQ2FsbGJhY2spe1xyXG4gICAgICAgICAgICAgICAgT25sb2FkQ2FsbGJhY2soX2NvdW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0ZXh0dXJlc0RhdGEubGVuZ3RoID09IF9jb3VudCAmJiBPbkNvbXBsZXRlQ2FsbGJhY2spe1xyXG4gICAgICAgICAgICAgICAgT25Db21wbGV0ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVNwcml0ZUZyYW1lV2l0aERhdGEobmFtZSA9IFwiXCIsIGJpdG1hcCA9IG51bGwsIHRleHR1cmVBcmVhRGF0YSA9IG51bGwpe1xyXG4gICAgaWYobmFtZSA9PSBcIlwiIHx8ICFiaXRtYXAgfHwgIXRleHR1cmVBcmVhRGF0YSl7XHJcbiAgICAgICAgY29uc29sZS5lcnIoXCJlcnJvciBwYXJhbS5cIik7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBsZXQgeCA9IHRleHR1cmVBcmVhRGF0YVsneCddO1xyXG4gICAgbGV0IHkgPSB0ZXh0dXJlQXJlYURhdGFbJ3knXTtcclxuICAgIGxldCB3aWR0aCA9IHRleHR1cmVBcmVhRGF0YVsnd2lkdGgnXTtcclxuICAgIGxldCBoZWlnaHQgPSB0ZXh0dXJlQXJlYURhdGFbJ2hlaWdodCddO1xyXG4gICAgaWYoIXdpZHRoIHx8ICFoZWlnaHQpe1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgbGV0IGYgPSBDcmVhdGVTcHJpdGVGcmFtZShuYW1lLCBiaXRtYXAsIHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgU2V0U3ByaXRlRnJhbWUobmFtZSwgZik7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBTdGFydCwgU3RvcFxyXG59IiwiXHJcbiAvKipcclxuICAqIGdyaWRtYXDnmoTnvZHmoLzljZXlhYNcclxuICAqL1xyXG4gY2xhc3MgQmFzZUdyaWQge1xyXG4gICAgY29uc3RydWN0b3Iod2lkdGggPSAwLCBoZWlnaHQgPSAwLCBkYXRhID0gbnVsbCl7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7ICAgICAgIC8v5a2Y5YKo55qE5a+56LGhXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDnvZHmoLzooajmmK/kuKrln7rnoYDkuozlhYPlrrnlmajvvIzlupTlvZLnsbvkuLrlhYPmlbDmja5cclxuICogcm93cyA9IOihjOaVsFxyXG4gKiBjb2x1bW5zID0g5YiX5pWwXHJcbiAqIGdyaWRXaWR0aCwgZ3JpZEhlaWdodCA9IOavj+S4que9keagvOeahOWuvemrmOiMg+WbtO+8jOW7uuiurjE6MVxyXG4gKiBcclxuICovXHJcbmNsYXNzIEFic3RyYWN0R3JpZE1hcCB7XHJcbiAgICBnZXREYXRhKHBvcyA9IG51bGwpe31cclxuICAgIHNldERhdGEocG9zID0gbnVsbCwgZGF0YSA9IG51bGwpe31cclxuICAgIGdldEdyaWQocG9zID0gbnVsbCl7fVxyXG4gICAgZ2V0R3JpZE1hcFdpZHRoKCl7fVxyXG4gICAgZ2V0R3JpZE1hcEhlaWdodCgpe31cclxuICAgIGl0ZXJhdG9yKGNhbGxiYWNrID0gbnVsbCl7fVxyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRHcmlkRGF0YShncmlkbWFwID0gbnVsbCwgcG9zID0gbnVsbCl7XHJcbiAgICByZXR1cm4gZ3JpZG1hcC5nZXREYXRhKHBvcyk7XHJcbn1cclxuZnVuY3Rpb24gU2V0R3JpZERhdGEoZ3JpZG1hcCA9IG51bGwsIHBvcyA9IG51bGwsIGRhdGEgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkbWFwLnNldERhdGEocG9zLCBkYXRhKTtcclxufVxyXG5mdW5jdGlvbiBHZXRHcmlkKGdyaWRtYXAgPSBudWxsLCBwb3MgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkbWFwLmdldEdyaWQocG9zKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiDln7rnoYDlsZ7mgKfvvJrlrr3luqZcclxuICovXHJcbmZ1bmN0aW9uIEdldEdyaWRXaWR0aChncmlkID0gbnVsbCl7XHJcbiAgICByZXR1cm4gZ3JpZC53aWR0aDtcclxufVxyXG5mdW5jdGlvbiBHZXRIYWxmR3JpZFdpZHRoKGdyaWQgPSBudWxsKXtcclxuICAgIHJldHVybiBHZXRHcmlkV2lkdGgoZ3JpZCkgKiAwLjU7XHJcbn1cclxuZnVuY3Rpb24gR2V0R3JpZE1hcFdpZHRoKGdyaWRtYXAgPSBudWxsKXtcclxuICAgIHJldHVybiBncmlkbWFwLmdldEdyaWRNYXBXaWR0aCgpO1xyXG59XHJcbmZ1bmN0aW9uIEdldEhhbGZHcmlkTWFwV2lkdGgoZ3JpZG1hcCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIEdldEdyaWRNYXBXaWR0aChncmlkbWFwKSAqIDAuNTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOWfuuehgOWxnuaAp++8mumrmOW6plxyXG4gKi9cclxuZnVuY3Rpb24gR2V0R3JpZEhlaWdodChncmlkID0gbnVsbCl7XHJcbiAgICByZXR1cm4gZ3JpZC5oZWlnaHQ7XHJcbn1cclxuZnVuY3Rpb24gR2V0SGFsZkdyaWRIZWlnaHQoZ3JpZCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIEdldEdyaWRIZWlnaHQoZ3JpZCkgKiAwLjU7XHJcbn1cclxuZnVuY3Rpb24gR2V0R3JpZE1hcEhlaWdodChncmlkbWFwID0gbnVsbCl7XHJcbiAgICByZXR1cm4gZ3JpZG1hcC5nZXRHcmlkTWFwSGVpZ2h0KCk7XHJcbn1cclxuZnVuY3Rpb24gR2V0SGFsZkdyaWRNYXBIZWlnaHQoZ3JpZG1hcCA9IG51bGwpe1xyXG4gICAgcmV0dXJuIEdldEdyaWRNYXBIZWlnaHQoZ3JpZG1hcCkgKiAwLjU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDpgY3ljoZcclxuICogQHBhcmFtIHsqfSBncmlkbWFwIFxyXG4gKiBAcGFyYW0geyp9IGNhbGxiYWNrIFxyXG4gKi9cclxuZnVuY3Rpb24gR3JpZE1hcEl0ZXJhdG9yKGdyaWRtYXAgPSBudWxsLCBjYWxsYmFjayA9IG51bGwpe1xyXG4gICAgZ3JpZG1hcC5pdGVyYXRvcihjYWxsYmFjayk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBCYXNlR3JpZCwgQWJzdHJhY3RHcmlkTWFwLCBHZXRHcmlkRGF0YSwgU2V0R3JpZERhdGEsIEdldEdyaWQsXHJcbiAgICBHZXRHcmlkV2lkdGgsIEdldEhhbGZHcmlkV2lkdGgsIEdldEdyaWRNYXBXaWR0aCwgR2V0SGFsZkdyaWRNYXBXaWR0aCxcclxuICAgIEdldEdyaWRIZWlnaHQsIEdldEhhbGZHcmlkSGVpZ2h0LCBHZXRHcmlkTWFwSGVpZ2h0LCBHZXRIYWxmR3JpZE1hcEhlaWdodCxcclxuICAgIEdyaWRNYXBJdGVyYXRvclxyXG59IiwiaW1wb3J0IG9wdGlvbnMgZnJvbSAnLi9kYXRhJztcclxuaW1wb3J0IHsgR2V0RGF0YSB9IGZyb20gJy4vZnJhbWV3b3JrL2RpcmVjdG9yL3Jlc291cmNlJztcclxuaW1wb3J0IHsgRHJhd1JlY3QgfSBmcm9tICcuL2ZyYW1ld29yay9kaXJlY3Rvci9yZW5kZXInO1xyXG5pbXBvcnQgeyBTdGFydCB9IGZyb20gJy4vZnJhbWV3b3JrL2RpcmVjdG9yL2Jvb3QnO1xyXG5pbXBvcnQgeyBHcmlkTWFwSXRlcmF0b3IsIEdldEdyaWRXaWR0aCwgR2V0SGFsZkdyaWRXaWR0aCB9IGZyb20gJy4vZnJhbWV3b3JrL2ZvdW5kYXRpb24vY29udGFpbmVyL2dyaWRtYXAnO1xyXG5cclxuLy/osKjorrDmlbDmja7pqbHliqjvvIzliIbmuIXkuJrliqHphY3nva7lkozmoYbmnrbpgLvovpHphY3nva5cclxuLy8gdmFyIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKGRhdGEsIHtcclxuLy8gICAgIGtleURvd25IYW5kbGVyIDoga2V5RG93bkhhbmRsZXIsXHJcbi8vICAgICBrZXlVcEhhbmxlciA6IGtleVVwSGFubGVyLFxyXG4vLyAgICAgY29sbGlkZSA6IHtcclxuLy8gXHRcdHVzZUJveCA6IHRydWUsXHJcbi8vICAgICAgICAgZ3JvdXAgOiBbXHJcbi8vICAgICAgICAge1xyXG4vLyAgICAgICAgICAgICB0ZWFtMSA6IDEsXHJcbi8vICAgICAgICAgICAgIHRlYW0yIDogMlxyXG4vLyAgICAgICAgIH1dLFxyXG4vLyAgICAgICAgIGNhbGxiYWNrIDogQm94Q2FsbGJhY2tcclxuLy8gXHR9XHJcbi8vIH0pO1xyXG4vLyBvcHRpb25zLnRpbGVtYXAuaW5pdEhhbmRsZXIgPSBpbml0SGFuZGxlcjtcclxuXHJcbmNsYXNzIE15U2NlbmUge1xyXG4gICAgb25TdGFydCgpe1xyXG4gICAgICAgIGRyYXdUaWxlKCk7XHJcbiAgICB9XHJcbiAgICBvblVwZGF0ZShkdCA9IDApe1xyXG4gICAgICAgIC8vZHJhd1RpbGUoKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd1RpbGUoKXtcclxuICAgIGxldCB0aWxlbWFwID0gR2V0RGF0YShcInRpbGUxXCIpO1xyXG4gICAgR3JpZE1hcEl0ZXJhdG9yKHRpbGVtYXAsIGdyaWQgPT4ge1xyXG4gICAgICAgIGxldCBwb3MgPSBHZXRUaWxlR3JpZENlbnRlcihncmlkKTtcclxuICAgICAgICBsZXQgaGFsZldpZHRoID0gR2V0SGFsZkdyaWRXaWR0aChncmlkKTtcclxuICAgICAgICBsZXQgd2lkdGggPSBHZXRHcmlkV2lkdGgoZ3JpZCk7XHJcbiAgICAgICAgRHJhd1JlY3QocG9zLCB3aWR0aCwgd2lkdGgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbihmdW5jdGlvbiAoKXtcclxuICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpO1xyXG4gICAgU3RhcnQob3B0aW9ucywgbmV3IE15U2NlbmUoKSk7XHJcbn0pKCkiXSwic291cmNlUm9vdCI6IiJ9